<?xml version="1.0" encoding="utf-8"?> <?xml-stylesheet type="text/xml" href="/blog/feed.xslt.xml"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="fr"> <generator uri="http://jekyllrb.com" version="3.3.1">Jekyll</generator><link href="http://www.monkeypatch.io/blog/feed.xml" rel="self" type="application/atom+xml"/><link href="http://www.monkeypatch.io/" rel="alternate" type="text/html" hreflang="fr"/> <updated>2017-08-14T17:54:32+02:00</updated> <id>http://www.monkeypatch.io/</id><title>MonkeyPatch - Expertise Informatique</title> <subtitle>Soci√©t√© de conseil et d'expertise en informatique sp√©cialis√©e dans les nouvelles technologies.</subtitle> <entry xml:lang="en"><title>J On The Beach 2017 ‚Äî Review</title><link href="http://www.monkeypatch.io/2017/08/03/JOTB-malaga-2017.html" rel="alternate" type="text/html" title="J On The Beach 2017 ‚Äî Review"/> <published>2017-08-03T00:00:00+02:00</published> <updated>2017-08-03T00:00:00+02:00</updated><id>http://www.monkeypatch.io/2017/08/03/JOTB-malaga-2017</id> <content type="html" xml:base="http://www.monkeypatch.io/2017/08/03/JOTB-malaga-2017.html">&lt;p&gt;&lt;a href="https://jonthebeach.com/"&gt;J On The Beach&lt;/a&gt; (JOTB) is &lt;em&gt;‚ÄúA Big Data Conference On The Beach‚Äù&lt;/em&gt; happening in Malaga (Spain) and this year (2017) was its second edition. &lt;!--more--&gt;&lt;/p&gt;&lt;p&gt;&lt;img src="http://i-rant.arnaudbos.com/img/j-on-the-beach-malaga-2017-review/panoramic.jpg" alt="Panoramic view ‚Äî Seaside of Malaga" /&gt;&lt;/p&gt;&lt;hr /&gt; &lt;h1 id="tldr"&gt;tl;dr&lt;/h1&gt;&lt;ul&gt; &lt;li&gt; &lt;p&gt;The staff was great, the speakers awesome and the talks interesting.&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;I felt very comfortable and almost at home during the three days. The atmosphere felt like being at a local conference but with famous and renowned speakers from around the world.&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;Everyone I met - speakers/attendees/staff - was accessible and affable.&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;I will detail the lunches and dinner in the rest of the article to make pauses between talks reviews and technical explanations, but it‚Äôs fair to say that the food was &lt;strong&gt;&lt;em&gt;great&lt;/em&gt;&lt;/strong&gt; and that &lt;strong&gt;&lt;em&gt;the organizers made sure we wouldn‚Äôt forget our stay&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;I came for distributed systems topics, and I‚Äôve been served.&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;The party at the end of the event was &lt;strong&gt;&lt;em&gt;fantastic&lt;/em&gt;&lt;/strong&gt;, I‚Äôve never seen so many geeks dance&lt;/p&gt; &lt;/li&gt; &lt;/ul&gt;&lt;hr /&gt; &lt;p&gt;I‚Äôve discovered JOTB by accident in 2016, during the revelation of the &lt;a href="https://panamapapers.icij.org/"&gt;Panama Papers&lt;/a&gt; when I was searching for technical details about how the &lt;a href="https://www.icij.org/about"&gt;ICIJ&lt;/a&gt; managed to analyse this massive leak of data.&lt;br /&gt; I stumbled-upon Mar Cabra‚Äôs &lt;a href="https://www.youtube.com/watch?v=rjqHC5dYdfE"&gt;&lt;em&gt;‚ÄúThe tech behind the bigger journalism leak in history‚Äù&lt;/em&gt;&lt;/a&gt; , and after watching a few other talks I decided it was worth keeping an eye on it for the next edition.&lt;/p&gt;&lt;p&gt;Soon enough, the 2017 line-up was released, followed by the &lt;a href="https://jonthebeach.com/schedule"&gt;schedule&lt;/a&gt; and when I saw the subjects and the speakers I managed to get one of the first round of tickets.&lt;/p&gt;&lt;blockquote class="twitter-tweet" data-lang="en"&gt;&lt;p lang="en" dir="ltr"&gt;Tickets booked, I&amp;#39;ll be &lt;a href="https://twitter.com/JOTB17"&gt;@JOTB17&lt;/a&gt; in May and will attend &lt;a href="https://twitter.com/aphyr"&gt;@aphyr&lt;/a&gt;&amp;#39;s workshop on &lt;a href="https://twitter.com/hashtag/Jepsen?src=hash"&gt;#Jepsen&lt;/a&gt; üéâ Can&amp;#39;t wait!&lt;/p&gt;&amp;mdash; Arnaud Bos (@arnaud_bos) &lt;a href="https://twitter.com/arnaud_bos/status/816912096948613120"&gt;January 5, 2017&lt;/a&gt;&lt;/blockquote&gt; &lt;script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"&gt;&lt;/script&gt;&lt;p&gt;I didn‚Äôt know how to cut this article, maybe in half? or maybe an entry by talk was more appropriate?&lt;br /&gt; So I just kept everything in a single page.&lt;/p&gt;&lt;h1 id="overview"&gt;Overview&lt;/h1&gt;&lt;p&gt;I‚Äôll start by giving my experience of the conference just to try to make you feel what it was like to be there, I hope it‚Äôll give context for reading my reviews of the talks.&lt;/p&gt;&lt;p&gt;&lt;img src="http://i-rant.arnaudbos.com/img/j-on-the-beach-malaga-2017-review/venue.jpg" alt="La Termica" /&gt;&lt;/p&gt;&lt;ul&gt; &lt;li&gt; &lt;p&gt;The title of the conference &lt;em&gt;‚ÄúA Big Data Conference On The Beach‚Äù&lt;/em&gt; is not a scam: the beach is right there, 200 meters away from the conference venue &lt;a href="http://www.latermicamalaga.com/"&gt;La Termica&lt;/a&gt;.&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;The location was easy to find because it is a cultural center. It is not in the city center, more halfway between the airport and the center and can be reached in 40 minutes walk by the beach. There are hotels around and a bus stop 50m from the entrance, as well as city bikes spots.&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;The place in itself is nice, the hallways and rooms are large and bright.&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;The staff was really welcoming every days, everyone speaking English and willing to assist the speakers and attendees.&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;The registration process took forever on the first day but someone was available to guide me to my workshop room so I didn‚Äôt have to search (thank you!).&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;The necklace with printed program schedule and plan was a really great idea, but on the other hand the names of the attendees were not that legible. Also the bracelet that‚Äôs &lt;em&gt;‚Äúyour pass for the three days‚Äù&lt;/em&gt; that you can‚Äôt remove at night or to shower was annoying to me.&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;During the workshop and also during the talks, one could find several power strips along the chairs.&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;The conference WiFi was great during the two days of conference, but was really awful during the workshop and we even experienced an outage during 20 to 30 minutes (which is unfortunate when you‚Äôre &lt;code class="highlighter-rouge"&gt;SSH&lt;/code&gt;-ing onto cluster nodes to run Jepsen tests).&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;Breakfast, coffee/tea and milk was catered every morning and bottles of (cold) water were available all day long. There were also bottles of waters ready for each attendee in the workshop room which was a nice treat.&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;Speaking of treats, the swag bag was OK, but please bear in mind that &lt;em&gt;I‚Äôm not much fan of goodies&lt;/em&gt; in general:&lt;/p&gt;&lt;ul&gt; &lt;li&gt; &lt;p&gt;The t-shirt was cool, plus there were women sizes&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;The aluminum water bottle was also a good idea&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;Only one sticker?&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;A frisbee, because it‚Äôs on the beach, you know&lt;/p&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;The rest I can‚Äôt remember and didn‚Äôt bring back home‚Ä¶ ¬Ø\&lt;em&gt;(„ÉÑ)&lt;/em&gt;/¬Ø&lt;/p&gt; &lt;/li&gt; &lt;/ul&gt;&lt;h1 id="day1-jepsen-workshop"&gt;Day1: Jepsen Workshop&lt;/h1&gt;&lt;p&gt;I wrote about this workshop &lt;a href="./JOTB-Jepsen-workshop"&gt;in a separate blog entry&lt;/a&gt; to save some space and not mix topics.&lt;/p&gt;&lt;p&gt;This other entry is just scratching the surface of what Jepsen is, what it does and how to does it.&lt;/p&gt;&lt;p&gt;I‚Äôm planning to write more about it in the future and I‚Äôll make sure to put links here when it‚Äôs done.&lt;/p&gt;&lt;h1 id="day-2-talks"&gt;Day 2: Talks&lt;/h1&gt;&lt;h2 id="eric-ladizinsky---evolving-quantum-computers"&gt;Eric Ladizinsky ‚Äî Evolving Quantum Computers&lt;/h2&gt;&lt;p&gt;This is the kind of opening that really stick with me.&lt;br /&gt; If you don‚Äôt know about Quantum Computers, &lt;a href="https://www.dwavesys.com"&gt;D-Wave Systems&lt;/a&gt; or Eric Ladizinsky, don‚Äôt feel bad, I didn‚Äôt know either (if you knew, good for you!).&lt;/p&gt;&lt;p&gt;So the conference started with a man going up on stage really naturally, presenting himself not as a programmer nor computer scientist but as a physicist.&lt;/p&gt;&lt;p&gt;He started talking about how, given our current tools and all computing power, we are still unable to solve the real problems we are facing a civilization: poverty, injustice, ‚Ä¶others!&lt;br /&gt; Which, put that way, is frankly quite depressing‚Ä¶&lt;/p&gt;&lt;p&gt;He took a step back and gave us his analyze on how, through evolution, our species (&lt;a href="https://en.wikipedia.org/wiki/Homo"&gt;Homo genus&lt;/a&gt;) evolved step by step by first &lt;strong&gt;&lt;em&gt;discovering&lt;/em&gt;&lt;/strong&gt;, &lt;strong&gt;&lt;em&gt;using&lt;/em&gt;&lt;/strong&gt; and then &lt;strong&gt;&lt;em&gt;mastering&lt;/em&gt;&lt;/strong&gt; new tools (think fire, agriculture, inductry), and how &lt;em&gt;quantum physics&lt;/em&gt; might be another step forward.&lt;/p&gt;&lt;p&gt;He drew the parallel with computer science through our limited ability to find the most advanced models for a task in data science: we manage to find good results through the use of lots of training data and clever algorithms.&lt;br /&gt; But when some algorithm can be successful by throwing more computing power at them, some problem remain &lt;a href="https://en.wikipedia.org/wiki/Computational_complexity_theory#Intractability"&gt;intractable&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Quantum computers leverage the principles of quantum physics like &lt;a href="https://en.wikipedia.org/wiki/Quantum_entanglement"&gt;&lt;code class="highlighter-rouge"&gt;entanglement&lt;/code&gt;&lt;/a&gt; in order to evaluate all possible models and find the most efficient solution.&lt;/p&gt;&lt;p&gt;Eric gave us a great analogy with forgery: consider the molecules of metal forming a sword.&lt;br /&gt; The best sword ever can only be achieved by finding the best shape, the best arrangement possible of its molecules.&lt;/p&gt;&lt;p&gt;So, of all the possible combinations, which one is the best?&lt;/p&gt;&lt;p&gt;Quantum physics can help us explore all the possible solutions, and find the most efficient models whereas classical computers would require centuries of computation.&lt;/p&gt;&lt;p&gt;Considering quantum computers like that really blew my mind. Of course realizing this kind of processors is hard and expansive, but they already exist!&lt;/p&gt;&lt;p&gt;D-Wave are making quantum computers, and each new evolution is faster than the previous one at a much higher rate than our current CPUs.&lt;/p&gt;&lt;p&gt;At the moment it seems like only the NASA and Google can afford to buy some of them and try them on, but we, as programmers, &lt;a href="https://www.dwavesys.com/software"&gt;we can already program them&lt;/a&gt; with our current tools (Python, C++) thanks to cloud based environments and several layers of abstraction.&lt;/p&gt;&lt;p&gt;I‚Äôm short on words and my knowledge of quantum physics, quantum computers and the programming model to use them is limited, but if you are interested, here are some links:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;&lt;a href="https://www.cbinsights.com/blog/quantum-computing-explainer/"&gt;WTF Is Quantum Computing? A 5-minute Primer&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="http://io9.gizmodo.com/what-will-nasa-be-doing-with-its-new-quantum-computer-1468333514"&gt;What will NASA be doing with its new quantum computer?&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt;&lt;h2 id="in√©s-sombra--the-trouble-with-distribution"&gt;In√©s Sombra ‚Äî The trouble with distribution&lt;/h2&gt;&lt;p&gt;&lt;a href="https://twitter.com/randommood"&gt;In√©s Sombra&lt;/a&gt; is an engineer at &lt;a href="https://www.fastly.com"&gt;Fastly&lt;/a&gt; and in this session she talked about &lt;strong&gt;tradeoffs&lt;/strong&gt; in building a distributed system. And &lt;em&gt;OMG she speaks really fast!&lt;/em&gt;&lt;/p&gt;&lt;p&gt;If I could summarize the entire talk in a single word, it would be &lt;strong&gt;&lt;em&gt;‚Äútradeoffs‚Äù&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;&lt;p&gt;Taking as an example the implementation of Faslty‚Äôs &lt;a href="https://docs.fastly.com/api/imageopto"&gt;Image optimizer&lt;/a&gt;, In√©s presented several stages of the evolution of the Image optimizer and the pros and cons of each solution.&lt;/p&gt;&lt;p&gt;To give a little bit of context and grossly describe this service, it is and &lt;em&gt;image processing and caching&lt;/em&gt; solution.&lt;br /&gt; You give it the location of your original quality content images and a set of &lt;strong&gt;&lt;em&gt;V&lt;/em&gt;&lt;/strong&gt;&lt;em&gt;arnish&lt;/em&gt; &lt;strong&gt;&lt;em&gt;C&lt;/em&gt;&lt;/strong&gt;&lt;em&gt;onfiguration&lt;/em&gt; &lt;strong&gt;&lt;em&gt;L&lt;/em&gt;&lt;/strong&gt;&lt;em&gt;anguage&lt;/em&gt; rules, and each time one of your clients requires an image it points to this high quality image and gives query parameters about the expected size, ratio, quality, etc, of the result it needs.&lt;br /&gt; Then Fastly‚Äôs Image optimizer will search for a cached version of the image result, optimize it on the fly in case of a cache miss, and eventually return the expected result after caching it.&lt;br /&gt; Of course a lots of details are missing but this is the big picture‚Ä¶&lt;/p&gt;&lt;p&gt;Throughout the talk, In√©s weights the costs and benefits of:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;&lt;em&gt;pre-processing all the catalog then caching&lt;/em&gt; VS &lt;em&gt;on-the-fly transforming on a per-request basis then caching&lt;/em&gt;, or&lt;/li&gt; &lt;li&gt;&lt;em&gt;being centralized&lt;/em&gt; VS &lt;em&gt;being distributed&lt;/em&gt;, or&lt;/li&gt; &lt;li&gt;&lt;em&gt;being consistent&lt;/em&gt; VS &lt;em&gt;being available&lt;/em&gt; (or being &lt;em&gt;‚Äúfast enough‚Äù&lt;/em&gt;), or&lt;/li&gt; &lt;li&gt;&lt;em&gt;stripping metadata&lt;/em&gt; VS &lt;em&gt;keeping metadata&lt;/em&gt;, etc.&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;All in all, I think the talk had both too much and too little content. Let me explain:&lt;/p&gt;&lt;p&gt;It is true that In√©s speaks really fast, but she still had to rush through the last couple of slides in order to finish on time.&lt;br /&gt; On the other hand, the talk was really high level on technical details and I think that was the goal, but the tradeoffs slides with only pros and cons about the ‚Äúcurrent‚Äù version of the service, with not a lot of details about how this ‚Äúcurrent‚Äù version was designed made it difficult to really realize what/how choices were made.&lt;/p&gt;&lt;p&gt;It‚Äôs worth re-watching and take time to rewind now that the video is available:&lt;/p&gt;&lt;p&gt;&lt;a href="https://www.youtube.com/watch?v=m8CyenESI1c"&gt;You can watch the talk here&lt;/a&gt;&lt;/p&gt;&lt;h2 id="kyle-kingsbury--jepsen-talk"&gt;Kyle Kingsbury ‚Äî Jepsen Talk&lt;/h2&gt;&lt;p&gt;Once again, &lt;a href="https://aphyr.com/"&gt;aphyr&lt;/a&gt; strikes with his presentation skills and humor.&lt;/p&gt;&lt;p&gt;To paraphrase him: &lt;strong&gt;&lt;em&gt;‚Äúour databases are on fire‚Äù&lt;/em&gt;&lt;/strong&gt;, and what we do as developers is try to hide this instability to our users through nicely designed and shiny APIs.&lt;/p&gt;&lt;p&gt;But if we do our best for our users to continue riding around on unicorns all day long, we are sitting on top of systems of which we don‚Äôt really know the inner workings.&lt;/p&gt;&lt;p&gt;Since 2014, Kyle has been using &lt;a href="http://jepsen.io/"&gt;Jepsen&lt;/a&gt; to test databases, queues and other distributed systems on the basis of what he suspected was wrong or what the README and documentation of those softwares were stating.&lt;/p&gt;&lt;p&gt;He found numerous ‚Äúbugs‚Äù and ‚Äúinconsistencies‚Äù, published them in a &lt;a href="http://jepsen.io/analyses"&gt;series of blog posts&lt;/a&gt; and worked with some of the teams to help analyze problems and improve stability.&lt;/p&gt;&lt;p&gt;What he shares with us is that &lt;strong&gt;&lt;em&gt;we should test the software we use and we depend on&lt;/em&gt;&lt;/strong&gt;.&lt;br /&gt; We should &lt;em&gt;carefully read&lt;/em&gt; the claims and documentations of such systems, but not take anything for granted, because all of these systems are developed under physical and budget constraints, because &lt;em&gt;formal testing is hard&lt;/em&gt; and &lt;em&gt;simulation testing is hard too&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;Implementations of distributed systems might not be perfect, and some kinds of &lt;em&gt;errors&lt;/em&gt;, &lt;em&gt;loss&lt;/em&gt; or &lt;em&gt;inconsistencies&lt;/em&gt; might be acceptable &lt;strong&gt;from a domain point of view&lt;/strong&gt;, but that problem should not be hidden and assumptions must be validated.&lt;/p&gt;&lt;p&gt;&lt;a href="https://www.youtube.com/watch?v=tpbNTEYE9NQ"&gt;You can watch the talk here&lt;/a&gt;&lt;/p&gt;&lt;h3&gt;More on Jepsen and simulation testing:&lt;/h3&gt;&lt;p&gt;In the same series, I find this previous talk about Jepsen to be more informative for someone interested in &lt;strong&gt;&lt;em&gt;learning&lt;/em&gt;&lt;/strong&gt; about distributed systems, and it also might be the funniest talk I‚Äôve ever watched: &lt;a href="https://www.youtube.com/watch?v=QdkS6ZjeR7Q"&gt;Jepsen II: Linearizable Boogaloo&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;I‚Äôve also came across this &lt;a href="https://www.youtube.com/watch?v=4fFDFbi3toc"&gt;talk about simulation testing&lt;/a&gt; at FoundationDB. &lt;a href="https://en.wikipedia.org/wiki/FoundationDB"&gt;FoundationDB&lt;/a&gt; was a closed source &lt;em&gt;‚Äúmulti-model NoSQL database‚Äù&lt;/em&gt; that has been acquired by Apple since this talk.&lt;/p&gt;&lt;h2 id="dharma-shukla--lessons-learnt-from-building-a-globally-distributed-database-service-from-the-ground-up"&gt;Dharma Shukla ‚Äî Lessons learnt from building a globally distributed database service from the ground up&lt;/h2&gt;&lt;p&gt;For the first few seconds I was a bit bored by the tone of the presentation. Boy I was wrong!&lt;/p&gt;&lt;p&gt;During this talk, &lt;a href="https://twitter.com/dharmashukla"&gt;Dharma Shukla&lt;/a&gt; introduces us with &lt;a href="https://azure.microsoft.com/en-us/services/cosmos-db/"&gt;CosmosDB&lt;/a&gt;, formerly known as DocumentDB.&lt;/p&gt;&lt;p&gt;Honestly, I didn‚Äôt even know this was a thing, and yet it is a really interesting product developed during the last 7 years by Microsoft: a &lt;em&gt;schema-less&lt;/em&gt;, &lt;em&gt;multi-model&lt;/em&gt;, &lt;em&gt;globally distributed&lt;/em&gt; database in Azure Cloud.&lt;/p&gt;&lt;p&gt;There are articles that will better describe Cosmos DB than I could do, but what I will keep from Dharma‚Äôs talk is the amount of work the teams at Microsoft seem to have invested in ensuring strong and comprehensible SLAs for latency and availability, but also for consistency and throughput, which is another level of quality.&lt;/p&gt;&lt;p&gt;CosmosDB is fully &lt;strong&gt;&lt;em&gt;schema agnostic&lt;/em&gt;&lt;/strong&gt; and has its own way of structuring data so that you don‚Äôt have to worry about it (RDF under the hood?), and it also ‚Äúindexes all the data‚Äù.&lt;/p&gt;&lt;p&gt;CosmosDB is &lt;strong&gt;&lt;em&gt;multi-model&lt;/em&gt;&lt;/strong&gt; in the sense that it supports &lt;em&gt;document&lt;/em&gt;, &lt;em&gt;graph&lt;/em&gt; of &lt;em&gt;key-value&lt;/em&gt; data types and uses a &lt;em&gt;SQL-like&lt;/em&gt; query dialect as well as MongoDB or graph APIs.&lt;/p&gt;&lt;p&gt;Another important feature of CosmosDB is it‚Äôs &lt;strong&gt;5 different levels of consistency&lt;/strong&gt;, from &lt;em&gt;‚Äústrong consistency‚Äù&lt;/em&gt; to &lt;em&gt;‚Äúeventual consistency‚Äù&lt;/em&gt;, Microsoft has implemented three other consistency models based on academic researches.&lt;/p&gt;&lt;p&gt;CosmosDB is available as a service on &lt;em&gt;Microsoft Azure Cloud&lt;/em&gt;. There you can choose and &lt;em&gt;elastically control with API calls&lt;/em&gt; the amount of storage and &lt;em&gt;scale the throughput&lt;/em&gt; of your application and pay as you go down to a &lt;em&gt;granularity of a second&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;All those features are really impressive, they even brought &lt;a href="https://fr.wikipedia.org/wiki/Leslie_Lamport"&gt;Leslie Lamport&lt;/a&gt; (inventor of the &lt;a href="https://en.wikipedia.org/wiki/Lamport_timestamps"&gt;Lamport clock&lt;/a&gt; and the &lt;a href="https://en.wikipedia.org/wiki/Paxos_(computer_science)"&gt;Paxos consensus protocol&lt;/a&gt; among &lt;a href="https://en.wikipedia.org/wiki/LaTeX"&gt;other things&lt;/a&gt;) on board and used it‚Äôs &lt;a href="https://en.wikipedia.org/wiki/TLA%2B"&gt;TLA+&lt;/a&gt; formal language to design and verify for correctness. And they also use Jepsen‚Ä¶&lt;/p&gt;&lt;p&gt;I wasn‚Äôt expecting to be amazed by this talk but honestly if you‚Äôre not afraid of vendor lock-in or are already using Microsoft Azure, it looks amazing.&lt;/p&gt;&lt;p&gt;&lt;a href="https://www.youtube.com/watch?v=3Sq9AJzgxAg"&gt;You can watch the talk here&lt;/a&gt;&lt;/p&gt;&lt;h2 id="lunch-wrapsbeers"&gt;Lunch: Wraps+beers&lt;/h2&gt;&lt;p&gt;The first day‚Äôs lunch consisted of wraps of different flavors, chicken, ham or veggie.&lt;br /&gt; They were good enough, and open beer bar was present just like the day before so one just had to manage to eat and drink wisely in order to be fully ready for the talks of the afternoon.&lt;/p&gt;&lt;p&gt;The lunch took place in the backyard just like on Wednesday, on the grass, under a beautiful sunny sky.&lt;/p&gt;&lt;p&gt;During the meal I reconnected with some of my fellow Jepsen workshop-ers to share our experiences about the morning talks:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;&lt;a href="https://twitter.com/rocketarium"&gt;Andrei Dan&lt;/a&gt; and &lt;a href="https://twitter.com/einsmu"&gt;Sebastian Utz&lt;/a&gt; from &lt;a href="https://crate.io/"&gt;CrateDB&lt;/a&gt;;&lt;/li&gt; &lt;li&gt;&lt;a href="https://twitter.com/neunhoef"&gt;Max Neunh√∂ffer&lt;/a&gt; from &lt;a href="https://www.arangodb.com/"&gt;ArangoDB&lt;/a&gt;;&lt;/li&gt; &lt;li&gt;Sayat Satybaldiev from &lt;a href="https://jobs.zalando.com/tech/blog/"&gt;Zalando&lt;/a&gt; and&lt;/li&gt; &lt;li&gt;&lt;a href="https://twitter.com/donnchadho"&gt;Donnchadh √ì Donnabh√°in&lt;/a&gt; from &lt;a href="https://www.poppulo.com/"&gt;Poppulo&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt;&lt;h2 id="anjana-vakil--custom-query-languages-why-how"&gt;Anjana Vakil ‚Äî Custom Query Languages: Why? How?&lt;/h2&gt;&lt;p&gt;In this talk, &lt;a href="https://twitter.com/anjanavakil"&gt;Anjana Vakil&lt;/a&gt; explains what is the difference between a &lt;strong&gt;&lt;em&gt;DSL&lt;/em&gt;&lt;/strong&gt; and a &lt;strong&gt;&lt;em&gt;CQL&lt;/em&gt;&lt;/strong&gt; and gives us some insights on how to design such languages with the goal of providing powerful abstractions while keeping usability in mind.&lt;/p&gt;&lt;p&gt;&lt;a href="https://www.youtube.com/watch?v=y5wMNehHYBY"&gt;You can watch the talk here&lt;/a&gt;&lt;/p&gt;&lt;h2 id="roland-kuhn--taming-distribution-formal-protocols-for-akka-typed"&gt;Roland Kuhn ‚Äî Taming distribution: formal protocols for Akka Typed&lt;/h2&gt;&lt;p&gt;I‚Äôm interested in actors but not familiar enough with Scala, Akka and the specific implementation that is presented here to provide a good review of this talk.&lt;/p&gt;&lt;p&gt;&lt;a href="https://www.youtube.com/watch?v=kpvTd49YJpQ"&gt;You can watch the talk here&lt;/a&gt;&lt;/p&gt;&lt;h2 id="christopher-meiklejohn--just-right-consistency-closing-the-cap-gap"&gt;Christopher Meiklejohn ‚Äî Just-Right Consistency: Closing The CAP Gap&lt;/h2&gt;&lt;p&gt;&lt;a href="https://twitter.com/cmeik"&gt;Christopher Meiklejohn&lt;/a&gt; is a former software developer in industry turned researcher after having worked at &lt;a href="https://en.wikipedia.org/wiki/Riak"&gt;Riak&lt;/a&gt; at &lt;a href="http://basho.com/"&gt;Basho&lt;/a&gt;.&lt;br /&gt; In this talk he talks about ‚Äú&lt;strong&gt;&lt;em&gt;Just-Right Consistency&lt;/em&gt;&lt;/strong&gt;‚Äù or how to ‚Äú&lt;em&gt;exploit availability whenever possible and only synchronize exactly when needed to enforce application invariance&lt;/em&gt;‚Äù.&lt;/p&gt;&lt;p&gt;Topics of the talk:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;Invariants&lt;/li&gt; &lt;li&gt;&lt;strong&gt;CAP&lt;/strong&gt; theorem&lt;/li&gt; &lt;li&gt;&lt;strong&gt;AP&lt;/strong&gt; and &lt;strong&gt;CP&lt;/strong&gt; systems&lt;/li&gt; &lt;li&gt;Consensus&lt;/li&gt; &lt;li&gt;Causality&lt;/li&gt; &lt;li&gt;Relative order&lt;/li&gt; &lt;li&gt;Joint updates&lt;/li&gt; &lt;li&gt;&lt;strong&gt;CRDT&lt;/strong&gt;&lt;/li&gt; &lt;li&gt;‚Ä¶&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;And this is me watching the talk:&lt;/p&gt;&lt;p&gt;&lt;img src="http://i-rant.arnaudbos.com/img/j-on-the-beach-malaga-2017-review/wat.jpg" alt="I don't even" /&gt;&lt;/p&gt;&lt;p&gt;This one gave me headaches, seriously. I‚Äôm not going to be able to summarize it in a short paragraph so I‚Äôll go for the long one.&lt;/p&gt;&lt;p&gt;The state of cloud databases that has been for many years is that we traditionally put out data in databases in datacenter(s). We have clients from all over the world accessing a &lt;em&gt;primary&lt;/em&gt; copy and we &lt;em&gt;geo-replicate&lt;/em&gt; in order to ensure &lt;em&gt;fault-tolerance&lt;/em&gt; and provide &lt;em&gt;high-availability&lt;/em&gt; and &lt;em&gt;low latency&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;And in the event that one or more of the copy of the database cannot communicate with one another we have to make a choice, once and for all:&lt;/p&gt;&lt;p&gt;We either choose a &lt;em&gt;Consistent-under-Partition&lt;/em&gt; (&lt;strong&gt;CP&lt;/strong&gt;) or an &lt;em&gt;Available-under-Partition&lt;/em&gt; (&lt;strong&gt;AP&lt;/strong&gt;) approach.&lt;/p&gt;&lt;p&gt;Characteristics of a &lt;strong&gt;CP system&lt;/strong&gt;:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;All the operations are &lt;em&gt;synchronized&lt;/em&gt; (write or read) on order to ‚Äú&lt;em&gt;treat all the copies as one logical unit&lt;/em&gt;‚Äù. A &lt;em&gt;consensus&lt;/em&gt; protocol must be used in order to ensure a single system image across replicas.&lt;/li&gt; &lt;li&gt;This is &lt;a href="https://en.wikipedia.org/wiki/Serializability"&gt;&lt;strong&gt;&lt;em&gt;serializability&lt;/em&gt;&lt;/strong&gt;&lt;/a&gt; (e.g., Google Cloud Spanner): provide &lt;em&gt;strong consistency&lt;/em&gt; an minimize the amount of time you have to wait, but &lt;em&gt;still slower than an AP system&lt;/em&gt;.&lt;/li&gt; &lt;li&gt;Often &lt;em&gt;over-conservative&lt;/em&gt; but very popular because easier to program! On the programmer side, &lt;em&gt;the application is written without thinking about distribution&lt;/em&gt;: if I write something then I will read this something, this is a guarantee of &lt;a href="https://en.wikipedia.org/wiki/Linearizability"&gt;&lt;strong&gt;&lt;em&gt;linearizability&lt;/em&gt;&lt;/strong&gt;&lt;/a&gt;.&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;Characteristics of an &lt;strong&gt;AP system&lt;/strong&gt;:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;Operations are &lt;em&gt;executed against local copies&lt;/em&gt; and then the result of those operations are then &lt;em&gt;propagated asynchronously&lt;/em&gt; which may take time&lt;/li&gt; &lt;li&gt;Reads and writes happen &lt;em&gt;extremely fast&lt;/em&gt;, so we may have &lt;strong&gt;&lt;em&gt;stale reads&lt;/em&gt;&lt;/strong&gt; and &lt;strong&gt;&lt;em&gt;write conflicts&lt;/em&gt;&lt;/strong&gt; between two updates on two different copies of the database since they haven‚Äôt &lt;em&gt;synchronized&lt;/em&gt;: they need to reconcile.&lt;/li&gt; &lt;li&gt;The system can keep operating in the even of failure: &lt;em&gt;Available but difficult to program&lt;/em&gt;.&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;Acknowledging the fact that there is no such thing as a &lt;em&gt;‚Äúone-size-fits-all‚Äù&lt;/em&gt; consistency model for applications, Christopher presents us a better approach:&lt;/p&gt;&lt;p&gt;Express our application invariants (properties of the system that must always hold true), and provide a way for the system to automatically infer from the application and tailor the consistency choices (a.k.a. feature by feature) based on those invariants to guarantee that no violation occur, this is &lt;strong&gt;&lt;em&gt;Just-Right Consistency&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;&lt;p&gt;Characteristics of &lt;strong&gt;Just-Right Consistency&lt;/strong&gt;:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;Write &lt;em&gt;sequential programs&lt;/em&gt; that enforce &lt;em&gt;application level invariants&lt;/em&gt; and preserve this application behavior &lt;em&gt;when deployed under&lt;/em&gt; &lt;strong&gt;&lt;em&gt;concurrency&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;and&lt;/em&gt; &lt;strong&gt;&lt;em&gt;distribution&lt;/em&gt;&lt;/strong&gt;.&lt;/li&gt; &lt;li&gt;We will have &lt;strong&gt;AP&lt;/strong&gt; compatible invariants: under an &lt;strong&gt;AP&lt;/strong&gt; system we can guarantee these invariants without synchronization.&lt;/li&gt; &lt;li&gt;And &lt;strong&gt;CAP&lt;/strong&gt;-sensitive invariants: &lt;em&gt;one way&lt;/em&gt; VS &lt;em&gt;two ways&lt;/em&gt; communication invariants: &lt;ul&gt; &lt;li&gt;One way: an operation that may or may not happen &lt;em&gt;atomically&lt;/em&gt; or in a particular order, but we &lt;em&gt;don‚Äôt need a response&lt;/em&gt; so it works without synchronization&lt;/li&gt; &lt;li&gt;Two way: two operations that are &lt;em&gt;related&lt;/em&gt; or &lt;em&gt;dependent&lt;/em&gt; will require &lt;em&gt;coordination&lt;/em&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt;Provides tools for &lt;em&gt;analysis and verification&lt;/em&gt; (e.g., at the IDE level): tell whether or not the application &lt;em&gt;will be safe when it‚Äôs deployed&lt;/em&gt;, bringing the application code and the database closer together.&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;In the talk we follow the case study of a lifecycle management tool for prescriptions and drug delivery to demonstrate how some application invariants may be &lt;strong&gt;AP&lt;/strong&gt; compatible while other being &lt;strong&gt;CAP&lt;/strong&gt;-sensitive.&lt;/p&gt;&lt;p&gt;Our invariants will be:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;&lt;strong&gt;&lt;em&gt;Relative order&lt;/em&gt;&lt;/strong&gt; (&lt;em&gt;referential integrity&lt;/em&gt;): Create a prescription record and reference it by a patient&lt;/li&gt; &lt;li&gt;&lt;strong&gt;&lt;em&gt;Joint updates&lt;/em&gt;&lt;/strong&gt; (&lt;em&gt;atomicity&lt;/em&gt;): Create prescription, then update doctor, then patient, then pharmacy&lt;/li&gt; &lt;li&gt;&lt;strong&gt;&lt;em&gt;Precondition check&lt;/em&gt;&lt;/strong&gt;: Deliver medication only the intended number of times&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;The first two invariants are &lt;strong&gt;AP&lt;/strong&gt; compatible, and the third one is &lt;strong&gt;CAP&lt;/strong&gt;-sensitive as we shall see.&lt;/p&gt;&lt;p&gt;Characteristics of an &lt;strong&gt;AP&lt;/strong&gt; compatible invariant:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;No synchronization: can operate locally without blocking. Its updates are applied locally and asynchronously propagated.&lt;/li&gt; &lt;li&gt;Updates are fast and exploit &lt;em&gt;concurrency&lt;/em&gt;.&lt;/li&gt; &lt;li&gt;Updates must &lt;em&gt;commute&lt;/em&gt;: &lt;em&gt;non-commutative&lt;/em&gt; updates require &lt;strong&gt;CP&lt;/strong&gt;.&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;What &lt;a href="https://en.wikipedia.org/wiki/Commutative_property"&gt;&lt;strong&gt;&lt;em&gt;commutativity&lt;/em&gt;&lt;/strong&gt;&lt;/a&gt; is:&lt;/p&gt;&lt;p&gt;Imagine we have two replicas of a register that are in agreement.&lt;/p&gt;&lt;p&gt;If two concurrent operations set different values (e.g., 2 and 3) for a specific key on the two replicas and we don‚Äôt synchronize, we will have a divergence.&lt;br /&gt; Replication without coordination will not produce a single outcome, the system cannot by itself decide which value should win unless being told so.&lt;/p&gt;&lt;p&gt;These two operations are said to be &lt;em&gt;non-commutative&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;Can we make non-commutative updates commutative? Yes:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;Using deterministic conflict resolution: pick a value that wins.&lt;br /&gt; Use a timestamp-based algorithm (Cassandra‚Äôs &lt;strong&gt;&lt;em&gt;L&lt;/em&gt;&lt;/strong&gt;&lt;em&gt;ast&lt;/em&gt; &lt;strong&gt;&lt;em&gt;W&lt;/em&gt;&lt;/strong&gt;&lt;em&gt;rite&lt;/em&gt; &lt;strong&gt;&lt;em&gt;W&lt;/em&gt;&lt;/strong&gt;&lt;em&gt;ins&lt;/em&gt;), or an application level merge/resolution (CouchDB, OrientDB, Aerospike, Riak).&lt;/li&gt; &lt;li&gt;using &lt;a href="https://en.wikipedia.org/wiki/Conflict-free_replicated_data_type"&gt;&lt;strong&gt;&lt;em&gt;CRDT&lt;/em&gt;&lt;/strong&gt;&lt;/a&gt;s: &lt;strong&gt;CRDT&lt;/strong&gt;s are extended sequential data types that encapsulate (built-in) deterministic merge functions. I‚Äôm not very familiar so I will try to get into more details in future blog posts, but there are many different designs of CRTDs for different uses.&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;So what happens when we assume that the system we‚Äôre building has this property?&lt;br /&gt; All operations will commute.&lt;/p&gt;&lt;p&gt;Let‚Äôs examine &lt;em&gt;relative order&lt;/em&gt; and &lt;em&gt;joint updates&lt;/em&gt; first.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Relative order&lt;/strong&gt; invariant:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;We do something, then other actions, and ensure that the updates are seen in the proper order, this is relative order.&lt;/li&gt; &lt;li&gt;If an operation P implies Q than the program makes sure that Q is written before P. As long as it‚Äôs in order on the target replica and that changes are replicated in the proper order, the invariant is never violated.&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;So we need a system that ensures &lt;a href="https://en.wikipedia.org/wiki/Causal_consistency"&gt;&lt;strong&gt;&lt;em&gt;causal consitency&lt;/em&gt;&lt;/strong&gt;&lt;/a&gt;:&lt;/p&gt;&lt;blockquote&gt; &lt;p&gt;Updates that are causaly related to other updates (that influence other updates) that happen in an order should be delivered in the exact same order&lt;/p&gt; &lt;/blockquote&gt;&lt;p&gt;&lt;strong&gt;Joint updates&lt;/strong&gt; invariant:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;Given &lt;em&gt;relative order&lt;/em&gt;, two replicas with updates are causally consistent, so far so good&lt;/li&gt; &lt;li&gt;But still, inconsistent state of the database can be read by clients/replicas &lt;em&gt;between&lt;/em&gt; updates&lt;/li&gt; &lt;li&gt;&lt;em&gt;Joint updates&lt;/em&gt; relate to &lt;a href="https://en.wikipedia.org/wiki/Atomicity_(database_systems)"&gt;&lt;strong&gt;&lt;em&gt;atomicity&lt;/em&gt;&lt;/strong&gt;&lt;/a&gt;: all-or-nothing&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;This is solved by grouping updates atomically in batches, taking snapshots along the way so clients (or other replicas) read consistent snapshots.&lt;/p&gt;&lt;p&gt;By ensuring these invariants on the database side based on the sequential program on the client side, at this point we are designing a system that has &lt;em&gt;relative order&lt;/em&gt; plus &lt;em&gt;joint updates&lt;/em&gt;, that is:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;em&gt;Transactional Causal Consistency&lt;/em&gt;&lt;/strong&gt;: the strongest &lt;strong&gt;AP&lt;/strong&gt; compatible consistency model.&lt;/p&gt;&lt;p&gt;Now for our last invariant: &lt;strong&gt;Preconditions check&lt;/strong&gt;:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;Preventing getting the same prescription twice&lt;/li&gt; &lt;li&gt;This is basically a counter with addition and subtraction operation&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;What happens when these operations happen concurently?&lt;/p&gt;&lt;p&gt;Addition for instance: Take a counter and apply an addition on a replica and another addition on a second replica. We assumed earlier that operations on our system will commute, so for instance adding 2 and then 3 is the same thing as adding 3 and then 2.&lt;/p&gt;&lt;p&gt;Addition is then stable under concurrency and we don‚Äôt have to synchronize.&lt;/p&gt;&lt;p&gt;Subtraction on the other hand is not stable under concurrency. If we decrement our counter on a replica and do the same thing on another replicat without synchronizing, we could break the invariant that the counter must always be greater than zero.&lt;/p&gt;&lt;p&gt;This is &lt;strong&gt;CAP&lt;/strong&gt;-sensitive.&lt;/p&gt;&lt;p&gt;We have two solutions do deal with this issue:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;First: &lt;strong&gt;¬Ø\&lt;em&gt;(„ÉÑ)&lt;/em&gt;/¬Ø&lt;/strong&gt; We can be fine with this tradeoff and acknowledge that our invariant &lt;em&gt;wasn‚Äôt really an invariant&lt;/em&gt;, e.g.: ensure that a pacient gets its prediction rather than being too conservative.&lt;/li&gt; &lt;li&gt;Second: Forbid concurrency, a.k.a &lt;em&gt;synchronization&lt;/em&gt;.&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;Wow, that was a long read!&lt;/p&gt;&lt;p&gt;This model is interesting because we can choose &lt;em&gt;for each operation&lt;/em&gt; what consistency model suits best. And when I say ‚Äúwe‚Äù, I say the &lt;em&gt;system&lt;/em&gt;. Because it‚Äôs hard to reason about these problems and we need &lt;em&gt;new tools&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;Need tools to analyse and allow or not operations to proceed by analysing &lt;em&gt;where invariants could be violated&lt;/em&gt; and tell us where we‚Äôre fine and where we need &lt;em&gt;synchronization&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;This is a research topic with lots of movement.&lt;br /&gt; Cristopher presents one model: the &lt;a href="https://syncfree.lip6.fr/index.php/2-uncategorised/51-cise"&gt;CISE Analysis&lt;/a&gt; (&lt;a href="http://software.imdea.org/~gotsman/papers/cise-tool.pdf"&gt;paper&lt;/a&gt;), but I‚Äôm not going to go into &lt;a href="https://github.com/SyncFree/CISE"&gt;details&lt;/a&gt; at this point.&lt;/p&gt;&lt;p&gt;So we have &lt;a href="http://syncfree.github.io/antidote/"&gt;AntidoteDB&lt;/a&gt;: &lt;a href="https://github.com/SyncFree/antidote"&gt;Open-source&lt;/a&gt;, implemented in Erlang, built on top of Riak core, providing &lt;strong&gt;&lt;em&gt;Transactional Causal Consistency&lt;/em&gt;&lt;/strong&gt; and is in alpha release.&lt;/p&gt;&lt;p&gt;Antidote respects &lt;strong&gt;&lt;em&gt;causality&lt;/em&gt;&lt;/strong&gt; by program order through clients and provide an &lt;em&gt;operations API&lt;/em&gt; as well as a &lt;em&gt;transaction API&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;A company is materializing around it and is in the process of raising money. The goal is to prodive the database open-source and for free and support and tools commercially.&lt;/p&gt;&lt;p&gt;Really interesting topic and talk, and lots of content!&lt;/p&gt;&lt;p&gt;&lt;a href="https://www.youtube.com/watch?v=Vd2I9v3pYpA"&gt;You can watch the talk here&lt;/a&gt;&lt;/p&gt;&lt;h2 id="santiago-ortiz--dynamic-data-visualization"&gt;Santiago Ortiz ‚Äî Dynamic data visualization&lt;/h2&gt;&lt;p&gt;&lt;a href="https://twitter.com/moebio"&gt;Santiago Ortiz&lt;/a&gt; has a really interesting way of looking at things and explaining how he thinks data visualization is meant to become a more democratized way at analyzing data and not just something reserved to data scientists.&lt;/p&gt;&lt;p&gt;Referring to the &lt;a href="https://en.wikipedia.org/wiki/Method_of_loci"&gt;memory palace&lt;/a&gt; technique for remembering complex numbers, he draw the following parallel:&lt;/p&gt;&lt;blockquote&gt; &lt;p&gt;Machines use numbers for encoding of information including stories.&lt;/p&gt;&lt;p&gt;And we need stories to store numbers.&lt;/p&gt; &lt;/blockquote&gt;&lt;p&gt;The rest of the talk was a portfolio of data visualizations which was nice to see but not really informative unless it is your thing.&lt;/p&gt;&lt;p&gt;On the plus side, one of the examples Santiago gave was about a book : [Rayuela](https://en.wikipedia.org/wiki/Hopscotch_(Cort%C3%A1zar_novel) by Julio Cort√°zar.&lt;br /&gt; This book, he explained, has been written in such a was that it can be read linearly or in an &lt;em&gt;unordered&lt;/em&gt; way following a pattern suggested by the author to jump from chapter to chapter.&lt;br /&gt; The visualization consisted in circles that allowed the viewer to screen and read from a chapter to another.&lt;/p&gt;&lt;p&gt;&lt;a href="https://www.youtube.com/watch?v=7t0ob7nGjN8"&gt;You can watch the talk here&lt;/a&gt;&lt;/p&gt;&lt;h2 id="dinner"&gt;Dinner&lt;/h2&gt;&lt;p&gt;The dinner was served in the backyard once again. We had fresh our of the oven pizzas and beer as well as soft drinks.&lt;/p&gt;&lt;p&gt;I ate with other attendees and left shortly after so I missed the meetups that had been organized specially for the event.&lt;/p&gt;&lt;h1 id="day-3-talks"&gt;Day 3: Talks&lt;/h1&gt; &lt;h2 id="duarte-nunes--scylladb-nosql-at-ludicrous-speed"&gt;Duarte Nunes ‚Äî ScyllaDB: NoSQL at Ludicrous Speed&lt;/h2&gt;&lt;p&gt;I was interested in this talk because of its summary highlighting the work done on performance on &lt;a href="http://www.scylladb.com/"&gt;ScyllaDB&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;ScyllaDB is a distributed databased based on the same model as &lt;a href="http://cassandra.apache.org/"&gt;Cassandra&lt;/a&gt;: dynamo-based. Its characteristics are &lt;strong&gt;high write availability&lt;/strong&gt;, &lt;strong&gt;eventual consistency&lt;/strong&gt; and inability to do &lt;em&gt;join&lt;/em&gt; queries.&lt;/p&gt;&lt;p&gt;ScyllaDB is &lt;em&gt;fully compatible&lt;/em&gt; with Cassandra‚Äôs API and file format so you can drop replace it without a single code line change.&lt;/p&gt;&lt;p&gt;Where ScyllaDB delivers is on the performance aspects. According to the benchmarks (we all love a good benchmark don‚Äôt we), &lt;strong&gt;&lt;em&gt;a 3 nodes ScyllaDB cluster is able to sustain the same load as a 30 nodes Cassandra cluster&lt;/em&gt;&lt;/strong&gt;.&lt;br /&gt; This is basically Cassandra on steroids&lt;/p&gt;&lt;p&gt;So how did the team manage to do that?&lt;/p&gt;&lt;p&gt;The answer is lots of time and efforts applying &lt;strong&gt;&lt;em&gt;good algorithms&lt;/em&gt;&lt;/strong&gt; and &lt;strong&gt;&lt;em&gt;mechanical sympathy&lt;/em&gt;&lt;/strong&gt; principles in order to squeeze every bit from CPUs and memory.&lt;/p&gt;&lt;p&gt;ScyllaDB uses a &lt;strong&gt;&lt;em&gt;thread-per-core&lt;/em&gt;&lt;/strong&gt; model to avoid &lt;em&gt;context-switching&lt;/em&gt; between threads and allocates each core a &lt;strong&gt;private memory pool&lt;/strong&gt;. So blocking calls are forbidden and ScyllaDB adopts an &lt;em&gt;asynchronous&lt;/em&gt; programming style with &lt;em&gt;futures and promises&lt;/em&gt; for networking and file I/O and use message passing between CPUs to hide latency from accessing memory.&lt;/p&gt;&lt;p&gt;On the memory side, ScyllaDB is very cautious about its memory space allocation and manages to &lt;strong&gt;&lt;em&gt;compact&lt;/em&gt;&lt;/strong&gt; memory to avoid fragmentation.&lt;/p&gt;&lt;p&gt;ScyllaDB also features an interesting and tunable &lt;em&gt;self-monitoring&lt;/em&gt; tool (benchmarking itself) able to analyze the stress under which the database is and make decisions on which process to prioritize (queuing requests) and how to deal with background tasks such as &lt;em&gt;compaction&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;If you have a use case for Cassandra and are critical about your resources usage, I think it‚Äôs really worth taking a look at ScyllaDB which is also open source by the way.&lt;/p&gt;&lt;p&gt;&lt;a href="https://www.youtube.com/watch?v=Qsj6KkbjMGI"&gt;You can watch the talk here&lt;/a&gt;&lt;/p&gt;&lt;h2 id="danielle-ashley--uniting-church-and-state-fp-and-oo-together"&gt;Danielle Ashley ‚Äî Uniting Church and State: FP and OO Together&lt;/h2&gt;&lt;p&gt;When preparing my schedule, I selected this talk because it ‚Äú&lt;em&gt;talked about FP and OO together&lt;/em&gt;‚Äù and I really like the idea that a lot of OO problems could be solved by using more FP concepts and good practices. Or use OO techniques in order to gain performance in our FP code, for instance.&lt;/p&gt;&lt;p&gt;So I just &lt;em&gt;completely ignored&lt;/em&gt; the first part of the talk and didn‚Äôt understand the ‚ÄúChurch and State‚Äù pun until later, so yeah, I‚Äôm stupid.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;After&lt;/strong&gt; the conference I did my homework and looked at this church encoding thing and I realized it is really interesting as an exercise. At first, I didn‚Äôt see where it‚Äôd be useful unless you‚Äôre trying to implement a new language. But Danielle talked about the performance side of things, and it started to click.&lt;/p&gt;&lt;p&gt;Church encoding is a way of representing data and operators using &lt;em&gt;nothing more than recursion and anonymous functions&lt;/em&gt;. In this talk, Danielle is not showing us how to implement &lt;a href="https://en.wikipedia.org/wiki/Church_encoding#Church_numerals"&gt;Church Numerals&lt;/a&gt; but how, by thoroughly designing out programs, we can eventually make it simpler to &lt;strong&gt;&lt;em&gt;reason about&lt;/em&gt;&lt;/strong&gt; (keep state in isolation), &lt;strong&gt;&lt;em&gt;invert the flow of control&lt;/em&gt;&lt;/strong&gt; (push-pull &lt;em&gt;FRP style&lt;/em&gt; instead of downstream method calls) and &lt;strong&gt;&lt;em&gt;improve performance&lt;/em&gt;&lt;/strong&gt; (less object instantiation, and avoiding &lt;code class="highlighter-rouge"&gt;Optional&lt;/code&gt; overhead in this example).&lt;/p&gt;&lt;p&gt;This will deserve another blog post in the future to explore this topic.&lt;/p&gt;&lt;p&gt;&lt;a href="https://www.youtube.com/watch?v=Nn0eb9Tl1Bo"&gt;You can watch the talk here&lt;/a&gt;&lt;/p&gt;&lt;h2 id="justo-ruiz-ferrer--adressing-the-elephant-in-the-room-what-a-post-hadoop-era-looks-like"&gt;Justo Ruiz Ferrer ‚Äî Adressing the elephant in the room: what a post-Hadoop era looks like&lt;/h2&gt;&lt;p&gt;The title mislead to expect a talk giving insight about &lt;em&gt;where&lt;/em&gt; the big data processing techniques could go, but in the end for me it didn‚Äôt deliver.&lt;br /&gt; The talk was mainly just an explanation of the &lt;em&gt;‚Äúmy big data is bigger than your big data‚Äù&lt;/em&gt; saying and a quick demo of &lt;a href="https://valo.io/"&gt;Valo&lt;/a&gt;‚Äôs streaming platform.&lt;/p&gt;&lt;p&gt;The speaker (and CTO of the company hosting the event) is clearly comfortable talking to an audience and fills the room with his speaking, and I expected some insights or takeaway thoughts about the direction in which our industry is going.&lt;br /&gt; But I ended up with sort of a statement about our architectures moving from &lt;strong&gt;&lt;em&gt;batch processing&lt;/em&gt;&lt;/strong&gt; to &lt;strong&gt;&lt;em&gt;streaming processing&lt;/em&gt;&lt;/strong&gt;, with the &lt;strong&gt;&lt;em&gt;lambda architecture&lt;/em&gt;&lt;/strong&gt;, &lt;strong&gt;&lt;em&gt;micro-batch&lt;/em&gt;&lt;/strong&gt; processing and the &lt;strong&gt;&lt;em&gt;dataflow model&lt;/em&gt;&lt;/strong&gt; which he didn‚Äôt mention.&lt;/p&gt;&lt;p&gt;No video available for this one.&lt;/p&gt;&lt;h2 id="lunch-paella"&gt;Lunch: Paella!!!&lt;/h2&gt;&lt;p&gt;The last day‚Äôs meal was an authentic &lt;a href="https://en.wikipedia.org/wiki/Paella"&gt;Valencian Paella&lt;/a&gt;, and I can tell you they nailed it. It was fantastic.&lt;/p&gt;&lt;p&gt;&lt;img src="http://i-rant.arnaudbos.com/img/j-on-the-beach-malaga-2017-review/paella2.jpg" alt="Paella" /&gt;&lt;/p&gt;&lt;p&gt;Once again in the backyard under a sunny sky.&lt;br /&gt; I‚Äôve had the occasion to share with other conference attendees about the previous talks and speak about programming languages and other geeky stuff.&lt;br /&gt; Fun time.&lt;/p&gt;&lt;h2 id="caitie-mccaffrey--distributed-sagas-a-protocol-for-coordinating-microservices"&gt;Caitie McCaffrey ‚Äî Distributed Sagas: A Protocol for Coordinating Microservices&lt;/h2&gt;&lt;p&gt;Super interesting talk by &lt;a href="https://twitter.com/caitie"&gt;Caitie McCaffrey&lt;/a&gt; about how to orchestrate multiple &lt;em&gt;microservices&lt;/em&gt; in order to achieve &lt;em&gt;consistency&lt;/em&gt; of a single business action.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Distributed Sagas&lt;/strong&gt; is a protocol with no standard or open source implementation (yet) designed to create a layer of &lt;em&gt;coordination&lt;/em&gt; on top of several (micro)services without having to write &lt;em&gt;yet another service&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;The example given in this talk is really simple and powerful: you have a &lt;em&gt;flight booking&lt;/em&gt; service to which was added a &lt;em&gt;hotel booking&lt;/em&gt; service as well as a &lt;em&gt;car rental&lt;/em&gt; service, and you want to offer your customers the ability to &lt;em&gt;book an entire trip&lt;/em&gt; including those three services.&lt;br /&gt; How do you ensure &lt;em&gt;business/domain level&lt;/em&gt; &lt;strong&gt;&lt;em&gt;consistency&lt;/em&gt;&lt;/strong&gt; without creating a new service?&lt;/p&gt;&lt;p&gt;This is not just an exercise: with the rise of microservices, we have moved away from the consistency &lt;em&gt;guarantees&lt;/em&gt; offered by our databases and must maintain &lt;em&gt;application-level consistency&lt;/em&gt;, or &lt;strong&gt;&lt;em&gt;feral consistency&lt;/em&gt;&lt;/strong&gt;.&lt;br /&gt; And for each new service that is deployed and available we could develop $n$ new combinations of &lt;em&gt;coordination&lt;/em&gt; services in order to deliver new value to customers‚Ä¶&lt;/p&gt;&lt;p&gt;Distributed Sagas introduces the concept of a &lt;strong&gt;SEC&lt;/strong&gt; (&lt;strong&gt;&lt;em&gt;S&lt;/em&gt;&lt;/strong&gt;&lt;em&gt;aga&lt;/em&gt; &lt;strong&gt;&lt;em&gt;E&lt;/em&gt;&lt;/strong&gt;&lt;em&gt;xecution&lt;/em&gt; &lt;strong&gt;&lt;em&gt;C&lt;/em&gt;&lt;/strong&gt;&lt;em&gt;oordinator&lt;/em&gt;) along with &lt;strong&gt;&lt;em&gt;action requests&lt;/em&gt;&lt;/strong&gt; and &lt;strong&gt;&lt;em&gt;compensating requests&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;&lt;p&gt;Based on a persistent &lt;em&gt;log&lt;/em&gt;, the stateless &lt;strong&gt;SEC&lt;/strong&gt; will come and write the actions of other services and operations results to the log &lt;strong&gt;&lt;em&gt;after acknowledgement&lt;/em&gt;&lt;/strong&gt; of the success of the action.&lt;br /&gt; The &lt;strong&gt;SEC&lt;/strong&gt; is then responsible to manage the consistency of the operations from a domain perspective and &lt;em&gt;replay&lt;/em&gt; or &lt;em&gt;rollback&lt;/em&gt; operations in case of failure.&lt;/p&gt;&lt;p&gt;The log in this case is like a &lt;em&gt;stack&lt;/em&gt;, where each operation performed by a service is &lt;em&gt;idempotent&lt;/em&gt; (in order to be replayed in case of delay or timeout for instance) and has a corresponding &lt;em&gt;backward idempotent action&lt;/em&gt; (&lt;em&gt;compensating requests&lt;/em&gt;) that can be performed: a semantic &lt;em&gt;undo&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;Now this is interesting: because an &lt;strong&gt;&lt;em&gt;action request&lt;/em&gt;&lt;/strong&gt; from a service may be delayed or just fail without returning (and we can‚Äôt make a difference), it is important that it be &lt;strong&gt;&lt;em&gt;idempotent&lt;/em&gt;&lt;/strong&gt; in order to be &lt;em&gt;replayed&lt;/em&gt;.&lt;br /&gt; This way, we avoid the complexity of having to send a &lt;strong&gt;&lt;em&gt;compensating request&lt;/em&gt;&lt;/strong&gt; to undo an &lt;em&gt;action request&lt;/em&gt; that may or may not have succeeded.&lt;br /&gt; &lt;strong&gt;&lt;em&gt;By replaying, we make sure that we get a result and then we ‚Äúcancel‚Äù if need be.&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;For this protocol to be applicable, the business/domain model must be compatible with &lt;em&gt;eventual consistency&lt;/em&gt; because each service being exposed individually &lt;em&gt;exposes its state&lt;/em&gt;, and the whole saga cannot be made &lt;strong&gt;&lt;em&gt;isolated&lt;/em&gt;&lt;/strong&gt; nor &lt;strong&gt;&lt;em&gt;atomic&lt;/em&gt;&lt;/strong&gt; under such constraints without introducing a lot of &lt;em&gt;latency&lt;/em&gt; and &lt;em&gt;single point of failures&lt;/em&gt; (see the part of the talk about &lt;em&gt;two phase commit&lt;/em&gt;).&lt;br /&gt; Indeed, the &lt;strong&gt;&lt;em&gt;SEC&lt;/em&gt;&lt;/strong&gt; itself might look like a SPOF, but it is actually stateless so just spawning a new instance of it and replay the log is sufficient to &lt;em&gt;continue the saga&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;From what I understood both Uber and Twitter are currently experimenting this technique, so we will have to wait and see what comes out.&lt;/p&gt;&lt;p&gt;&lt;a href="https://www.youtube.com/watch?v=0UTOLRTwOX0"&gt;You can watch the talk here&lt;/a&gt;&lt;/p&gt;&lt;h2 id="martin-thompson--high-performance-managed-languages"&gt;Martin Thompson ‚Äî High Performance Managed Languages&lt;/h2&gt;&lt;p&gt;Famous for his work on high performance coding, &lt;a href="https://twitter.com/mjpt777"&gt;Martin Thompson&lt;/a&gt; is a renowned expert and speaker.&lt;/p&gt;&lt;p&gt;At JOTB17, he gave us a talk about managed languages: languages that run on a virtual machine which provides garbage-collected memory management (Java, C#, etc.).&lt;/p&gt;&lt;p&gt;I‚Äôve already listened to Martin in various &lt;a href="http://www.se-radio.net/2014/02/episode-201-martin-thompson-on-mechanical-sympathy/"&gt;podcasts&lt;/a&gt; and one thing that he mentions quite often is that:&lt;/p&gt;&lt;blockquote&gt; &lt;p&gt;Our CPUs Arent‚Äôt Getting Any Faster.&lt;/p&gt; &lt;/blockquote&gt;&lt;p&gt;But most of our applications aren‚Äôt really &lt;em&gt;CPU intensive&lt;/em&gt;, they are intensive in their &lt;em&gt;memory access&lt;/em&gt;.&lt;br /&gt; Hardware constructors are adding cores in order to increase speed, and they are doing wonders, but our little understanding of how CPUs and memory access work prevents us from gaining all of the benefits.&lt;/p&gt;&lt;p&gt;Just like there was a debate between &lt;em&gt;Assembler&lt;/em&gt; VS &lt;em&gt;Compiled Languages&lt;/em&gt;, there‚Äôs an argument between &lt;em&gt;managed languages&lt;/em&gt; VS &lt;em&gt;native languages&lt;/em&gt; and this talk is just about that.&lt;/p&gt;&lt;p&gt;Managed languages benefit from &lt;strong&gt;&lt;em&gt;JIT optimizations&lt;/em&gt;&lt;/strong&gt; that a sole static compiler cannot provide.&lt;br /&gt; These are &lt;strong&gt;&lt;em&gt;predictions&lt;/em&gt;&lt;/strong&gt; made on &lt;em&gt;real, measured data&lt;/em&gt;, and if it happens that the bets are wrong, &lt;strong&gt;&lt;em&gt;the JIT can correct itself&lt;/em&gt;&lt;/strong&gt;, &lt;em&gt;revoke&lt;/em&gt; some decisions and &lt;em&gt;make new optimizations&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Code branching&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;If a static compiler armed with a good programmer branch prediction hint/information can be a solid optimization, a managed language is &lt;em&gt;able to use real data instead of static decisions and adjust over time&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Methods inlining&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Methods/Functions &lt;em&gt;can be inlined in case of hotness&lt;/em&gt; in order to avoid &lt;em&gt;function call overhead&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Loop unrolling&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;The optimizer can also &lt;em&gt;measure which loops are hotspots&lt;/em&gt; and which are not, and decide to &lt;em&gt;unroll&lt;/em&gt; some rather than check and iterate.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Intrinsics&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;The runtime can also &lt;em&gt;replace programmer instructions by architecture specific instructions&lt;/em&gt; (&lt;strong&gt;&lt;em&gt;intrinsics&lt;/em&gt;&lt;/strong&gt;) in order to benefit from a the particular implementation.&lt;br /&gt; Something impossible for static compiler unless &lt;em&gt;compiling for a specific architecture&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Polymorphism&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Managed runtimes can &lt;em&gt;avoid virtual dispatch&lt;/em&gt; or going through jump tables by directly calling the ‚Äò&lt;em&gt;right&lt;/em&gt;‚Äô method of an object or &lt;em&gt;inlining&lt;/em&gt; it.&lt;br /&gt; By checking the number of subtypes we can &lt;em&gt;decide&lt;/em&gt; whether or not it‚Äôs worth to just &lt;em&gt;calling the method directly&lt;/em&gt;, using a simple &lt;code class="highlighter-rouge"&gt;if&lt;/code&gt; statement, go &lt;em&gt;polymorphic&lt;/em&gt; or &lt;em&gt;cache the code for a particular type&lt;/em&gt; if it is hotter than the others.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Garbage Collector&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;The performance of a &lt;strong&gt;&lt;em&gt;Garbage Collector&lt;/em&gt;&lt;/strong&gt; depends upon its implementation, but also on how we, as programmers, deal with our objects.&lt;/p&gt;&lt;p&gt;Martin outlines the fact that &lt;strong&gt;&lt;em&gt;it is not allocation that is costly, but reclamation&lt;/em&gt;&lt;/strong&gt;‚Ä¶&lt;br /&gt; &lt;em&gt;The longer and object lives, the more operations the GC needs to do.&lt;/em&gt;&lt;/p&gt;&lt;p&gt;In the end, &lt;strong&gt;&lt;em&gt;THE&lt;/em&gt;&lt;/strong&gt; most important thing to performance is &lt;strong&gt;TIME&lt;/strong&gt;:&lt;/p&gt;&lt;p&gt;&lt;em&gt;How much time and effort are we willing to put into implementing&lt;/em&gt; &lt;strong&gt;&lt;em&gt;good algorithms&lt;/em&gt;&lt;/strong&gt; &lt;em&gt;and doing right choices‚Ñ¢&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;Some takeaways:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;Avoiding cache misses&lt;/li&gt; &lt;li&gt;Amortising expensive operations&lt;/li&gt; &lt;li&gt;Mechanical sympathy&lt;/li&gt; &lt;li&gt;Algo &amp;amp; Data-structures&lt;/li&gt; &lt;/ul&gt;&lt;h3&gt;Fun facts:&lt;/h3&gt;&lt;p&gt;Martin is the author of &lt;a href="https://github.com/real-logic/aeron"&gt;Aeron&lt;/a&gt;, a &lt;em&gt;high throughput&lt;/em&gt;, &lt;em&gt;low latency&lt;/em&gt; messaging system (it is used by &lt;a href="http://www.onyxplatform.org/"&gt;Onyx&lt;/a&gt;, BTW).&lt;/p&gt;&lt;p&gt;The &lt;strong&gt;Java implementation of Aeron is faster than native implementation of other fast messaging systems&lt;/strong&gt;: because of the &lt;strong&gt;&lt;em&gt;time&lt;/em&gt;&lt;/strong&gt; and &lt;strong&gt;&lt;em&gt;efforts&lt;/em&gt;&lt;/strong&gt; put into implementing &lt;strong&gt;&lt;em&gt;good algorithms&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;&lt;p&gt;Aeron has been ported to C++, then Go, then C#: and in the end &lt;strong&gt;&lt;em&gt;the fastest implementation is in C#&lt;/em&gt;&lt;/strong&gt;.&lt;br /&gt; C++ could be but would take much, much more time‚Ä¶&lt;/p&gt;&lt;p&gt;&lt;a href="https://www.youtube.com/watch?v=Pz-4co8IaI8"&gt;You can watch the talk here&lt;/a&gt;&lt;/p&gt;&lt;h2 id="dinner--party"&gt;Dinner + Party&lt;/h2&gt;&lt;p&gt;After dinner (Camperos + beers), the organizers invited a flamenco dancer, singer and guitarist.&lt;/p&gt;&lt;p&gt;And after the local culture and art, the party started with a rock band doing cover songs as well as a group called &lt;a href="https://g.co/kgs/zVDQ3a"&gt;Los Vinagres&lt;/a&gt; coming from the Canary Islands.&lt;/p&gt;&lt;p&gt;&lt;img src="http://i-rant.arnaudbos.com/img/j-on-the-beach-malaga-2017-review/flamenco.jpg" alt="Flamenco" /&gt;&lt;/p&gt;&lt;p&gt;I left with a few other attendees around midnight, going on a quest to find &lt;a href="https://en.wikipedia.org/wiki/Tapas"&gt;Tapas&lt;/a&gt;.&lt;/p&gt;&lt;h1 id="conclusion"&gt;Conclusion&lt;/h1&gt;&lt;p&gt;I think I‚Äôve said it in the first part of the article but the conference &lt;em&gt;felt very comfortable&lt;/em&gt; and &lt;strong&gt;&lt;em&gt;almost like a local conference&lt;/em&gt;&lt;/strong&gt;, despite the number of people from abroad and the &lt;em&gt;awesome speakers&lt;/em&gt;.&lt;br /&gt; It was then really easy to speak to people.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Thanks a lot to the organizers, speakers and other attendees for the great event.&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;And thanks a lot to &lt;a href="http://www.monkeypatch.io/"&gt;MonkeyPatch&lt;/a&gt;&lt;/strong&gt; (the company I work for) &lt;strong&gt;for paying and allowing me to attend a conference in Malaga!&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;On a side note, I‚Äôd like to apologize for the length of this article.&lt;br /&gt; It took me &lt;strong&gt;&lt;em&gt;way too long&lt;/em&gt;&lt;/strong&gt; to write this review and if you made it thus far, you‚Äôre a hero.&lt;/p&gt;&lt;p&gt;I really wanted to highlight the content of each talk and it took me researches and learning to give it back.&lt;br /&gt; I hope you enjoyed nonetheless. I don‚Äôt know if or how I will split my next conference review because I‚Äôm still new in this field, but there will be more content on most of the topics covered here in future blog posts.&lt;/p&gt;&lt;p&gt;Thanks for reading, see you!&lt;/p&gt;&lt;p&gt;&lt;img src="http://i-rant.arnaudbos.com/img/j-on-the-beach-malaga-2017-review/venue2.jpg" alt="Leaving" /&gt;&lt;/p&gt;&lt;h2 id="bonus-track-the-computer-science-behind-a-modern-distributed-data-store"&gt;Bonus track: The Computer Science behind a modern distributed data store&lt;/h2&gt;&lt;p&gt;By &lt;a href="https://twitter.com/neunhoef"&gt;Max Neunh√∂ffer&lt;/a&gt; from &lt;a href="https://www.arangodb.com/"&gt;ArangoDB&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;I‚Äôve talked &lt;em&gt;multiple times&lt;/em&gt; with Max during the three days of the conference and &lt;em&gt;didn‚Äôt even know he was a speaker until the last day&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;I‚Äôve watched his talk later on Youtube and I‚Äôve found it really interesting to get a sense of some &lt;em&gt;major problems&lt;/em&gt; one can experience while learning about or working on &lt;em&gt;distributed systems&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;It goes fast so if you are not familiar with distributed systems problems such as &lt;a href="https://en.wikipedia.org/wiki/Consensus_(computer_science)"&gt;&lt;em&gt;consensus&lt;/em&gt;&lt;/a&gt;, &lt;a href="https://en.wikipedia.org/wiki/Log-structured_merge-tree"&gt;&lt;em&gt;log structured merge trees&lt;/em&gt;&lt;/a&gt;, &lt;a href="https://en.wikipedia.org/wiki/Clock_synchronization"&gt;&lt;em&gt;clocks&lt;/em&gt;&lt;/a&gt; and &lt;a href="https://en.wikipedia.org/wiki/Distributed_transaction"&gt;&lt;em&gt;distributed ACID transactions&lt;/em&gt;&lt;/a&gt; you will find a &lt;strong&gt;lot&lt;/strong&gt; of useful information in order to learn more about these topics.&lt;/p&gt;&lt;p&gt;&lt;a href="https://www.youtube.com/watch?v=m9xYejDUdus"&gt;You can watch the talk here&lt;/a&gt;&lt;/p&gt;</content> <author> <name>Arnaud bos</name> <email>arnaud@monkeypatch.io</email> </author> <category term="JOTB"/> <category term="Distributed Systems"/> <category term="Databases"/> <summary>J On The Beach (JOTB) is ‚ÄúA Big Data Conference On The Beach‚Äù happening in Malaga (Spain) and this year (2017) was its second edition.</summary> </entry> <entry xml:lang="en"><title>J On The Beach 2017 ‚Äî Jepsen Workshop</title><link href="http://www.monkeypatch.io/2017/08/03/JOTB-Jepsen-workshop.html" rel="alternate" type="text/html" title="J On The Beach 2017 ‚Äî Jepsen Workshop"/> <published>2017-08-03T00:00:00+02:00</published> <updated>2017-08-03T00:00:00+02:00</updated><id>http://www.monkeypatch.io/2017/08/03/JOTB-Jepsen-workshop</id> <content type="html" xml:base="http://www.monkeypatch.io/2017/08/03/JOTB-Jepsen-workshop.html">&lt;p&gt;The first book I‚Äôve read about distributed systems was &lt;a href="https://www.amazon.fr/Distributed-Systems-Principles-Andrew-Tanenbaum/dp/0132392275"&gt;Distributed Systems: Principles and Paradigms&lt;/a&gt; by Andrew S. Tanenbaum and Maarten van Steen.&lt;br /&gt; I was reading at the library on my last year of study and I remember being confused very often, and to be honest I didn‚Äôt even finish it‚Ä¶ &lt;!--more--&gt;&lt;/p&gt;&lt;p&gt;By the end of 2013 or beginning of 2014, I progressively started to regain interest in distributed systems after having been distracted by programming on mobile devices for a while.&lt;/p&gt;&lt;p&gt;At that time, something appeared on my radar, it was named &lt;a href="http://jepsen.io/"&gt;Jepsen&lt;/a&gt;, and this year I‚Äôve had the chance to finally give it a try by myself by attending &lt;a href="../j-on-the-beach-malaga-2017-review"&gt;J On The Beach&lt;/a&gt; and its Jepsen workshop animated by no one else than the author: &lt;a href="https://aphyr.com/"&gt;Kyle Kingsbury&lt;/a&gt;.&lt;/p&gt;&lt;h1 id="j-on-the-beach-day-1-jepsen-workshop"&gt;J On The Beach Day 1: Jepsen Workshop&lt;/h1&gt;&lt;p&gt;After a warm welcome and a handshake, &lt;a href="https://aphyr.com/"&gt;Kyle Kingsbury&lt;/a&gt; started introducing &lt;a href="https://clojure.org/"&gt;Clojure&lt;/a&gt; for a brief moment: the syntax, data structures literals and the immutability part, just enough to be able to follow the hands-on part of the workshop.&lt;/p&gt;&lt;blockquote class="twitter-tweet" data-lang="en"&gt;&lt;p lang="en" dir="ltr"&gt;Let&amp;#39;s get &lt;a href="https://twitter.com/JOTB17"&gt;@JOTB17&lt;/a&gt; started! &lt;a href="https://twitter.com/aphyr"&gt;@aphyr&lt;/a&gt; introducing &lt;a href="https://twitter.com/hashtag/Clojure?src=hash"&gt;#Clojure&lt;/a&gt; for the &lt;a href="https://twitter.com/hashtag/Jepsen?src=hash"&gt;#Jepsen&lt;/a&gt; workshop! &lt;a href="https://t.co/c4M7SXhCR3"&gt;pic.twitter.com/c4M7SXhCR3&lt;/a&gt;&lt;/p&gt;&amp;mdash; Arnaud Bos (@arnaud_bos) &lt;a href="https://twitter.com/arnaud_bos/status/864748353489428481"&gt;May 17, 2017&lt;/a&gt;&lt;/blockquote&gt; &lt;script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"&gt;&lt;/script&gt;&lt;p&gt;It‚Äôs true that Clojure might be disturbing at first glance, like any new programming language‚Äôs syntax.&lt;br /&gt; If you‚Äôre interested in learning Clojure (you should), Kyle‚Äôs blogpost series &lt;a href="https://aphyr.com/tags/Clojure-from-the-ground-up"&gt;Clojure from the ground up&lt;/a&gt; and Daniel Higginbotham‚Äôs &lt;a href="http://www.braveclojure.com/clojure-for-the-brave-and-true/"&gt;Clojure for the Brave and True&lt;/a&gt; are really great resources before you go into more in-depths topics with &lt;a href="http://www.joyofclojure.com/"&gt;The Joy of Clojure&lt;/a&gt; for instance.&lt;/p&gt;&lt;p&gt;After this quick &lt;em&gt;aperitivo&lt;/em&gt;, Kyle gave us an overview of &lt;a href="https://github.com/jepsen-io/jepsen#design-overview"&gt;Jepsen‚Äôs design and core concepts&lt;/a&gt;, namely: Operations, Generators, Clients, Nemesis, History and Checkers (and Models) which, combined together and executed, form a Jepsen Test. So what is &lt;a href="http://jepsen.io/"&gt;Jepsen&lt;/a&gt;?&lt;/p&gt;&lt;p&gt;I think Kyle started from an observation that lots of people agree about: Testing distributed systems is hard. So after an argument about a consistency issue, he went and implemented a tool to introduce failure in systems and check the outcome.&lt;/p&gt;&lt;p&gt;Starting from READMEs and gut feelings, he begun to create a battery of tests for some of the best know distributed databases and key-value stores ‚Äúwe‚Äù use, and found &lt;a href="https://aphyr.com/tags/jepsen"&gt;disturbances in the force&lt;/a&gt;:&lt;/p&gt;&lt;blockquote&gt; &lt;p&gt;He found complex errors lying into the heart of some of the softwares we use.&lt;/p&gt; &lt;/blockquote&gt;&lt;p&gt;If you talk with Kyle, he makes it really clear that he‚Äôs not blaming vendors for introducing bugs and is not implying that they are intentionally hiding faults in their systems, but they can omit details or make assumptions or simply not test every corner case.&lt;/p&gt;&lt;p&gt;Jepsen is meant to do &lt;strong&gt;&lt;em&gt;simulation testing&lt;/em&gt;&lt;/strong&gt; (see other &lt;a href="http://queue.acm.org/detail.cfm?id=2889274"&gt;system testing methods&lt;/a&gt;) on distributed systems such as databases, distributed caches, etc., finding real/production errors, not theoretical ones.&lt;/p&gt;&lt;p&gt;Starting to think about &lt;a href="https://github.com/Netflix/SimianArmy"&gt;Netflix‚Äôs Chaos Monkey/Simian Army&lt;/a&gt;?&lt;br /&gt; Close enough.&lt;br /&gt; The &lt;a href="https://github.com/Netflix/SimianArmy"&gt;Simian Army&lt;/a&gt; is a suite of &lt;strong&gt;&lt;em&gt;fault-injection&lt;/em&gt;&lt;/strong&gt; tools meant to introduce &lt;em&gt;catastrophic errors&lt;/em&gt; by terminating nodes/regions or introducing &lt;em&gt;network instability&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;While Jepsen can also inject this kind of faults, it is more concerned about &lt;strong&gt;&lt;em&gt;correctness&lt;/em&gt;&lt;/strong&gt; than &lt;strong&gt;&lt;em&gt;availability&lt;/em&gt;&lt;/strong&gt; or &lt;strong&gt;&lt;em&gt;latency&lt;/em&gt;&lt;/strong&gt;.&lt;/p&gt;&lt;h1 id="how-does-it-work"&gt;How does it work?&lt;/h1&gt;&lt;p&gt;&lt;a href="https://github.com/jepsen-io/jepsen"&gt;Jepsen&lt;/a&gt; is designed to run as a &lt;strong&gt;cluster&lt;/strong&gt;: the number of nodes is parametrizable but it seems 3 to 5 nodes are usually enough to reproduce and/or detect &lt;em&gt;catastrophic errors&lt;/em&gt; (&lt;a href="https://www.usenix.org/conference/osdi14/technical-sessions/presentation/yuan"&gt;source&lt;/a&gt;).&lt;/p&gt;&lt;p&gt;One of the nodes is the &lt;strong&gt;control node&lt;/strong&gt;, which is responsible for logging into the other nodes via &lt;code class="highlighter-rouge"&gt;SSH&lt;/code&gt; and &lt;em&gt;execute&lt;/em&gt; the tests.&lt;br /&gt; The other nodes will ship the software at test and execute the operations.&lt;/p&gt;&lt;p&gt;As said in the github‚Äôs page:&lt;/p&gt;&lt;blockquote&gt; &lt;p&gt;Once the system is running, the control node spins up a set of logically single-threaded processes, each with its own client for the distributed system. A generator generates new operations for each process to perform. Processes then apply those operations to the system using their clients. The start and end of each operation is recorded in a history. While performing operations, a special nemesis process introduces faults into the system‚Äìalso scheduled by the generator.&lt;/p&gt; &lt;/blockquote&gt;&lt;p&gt;The point of having single-threaded processes is to avoid unnecessary complexity on the testing side, in order to make the work of the &lt;em&gt;checker&lt;/em&gt;, which will analyze the &lt;em&gt;history&lt;/em&gt;, more manageable.&lt;/p&gt;&lt;h2 id="operation"&gt;Operation&lt;/h2&gt;&lt;p&gt;An operation is an abstract representation, a common language (a data structure) to express a function invocation onto the system at test.&lt;/p&gt;&lt;p&gt;Stripping the details of the &lt;code class="highlighter-rouge"&gt;clojure&lt;/code&gt; implementation, here are examples of operations (think JSON documents, JavaScript Objects, Java HashMaps, Python Dictionaries, whatever seems familiar to you):&lt;/p&gt;&lt;div class="language-clojure highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="c1"&gt;;; a read: we don't know what value we'll read from the system yes so value is 'nil &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="no"&gt;:type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;:invoke,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;:f&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;:read,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;:value&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;nil&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;;; a write of an integer that will be performed on the system &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="no"&gt;:type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;:invoke,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;:f&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;:write,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;:value&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;rand-int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)}&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;&lt;span class="c1"&gt;;; a compare-and-set of an old integer and a new integer value &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="no"&gt;:type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;:invoke,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;:f&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;:cas,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;:value&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="nb"&gt;rand-int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;rand-int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)]}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;These operations are &lt;em&gt;&lt;code class="highlighter-rouge"&gt;invocation operations&lt;/code&gt;&lt;/em&gt;, they just describe a bunch of types of operations for the &lt;em&gt;clients&lt;/em&gt; to perform.&lt;/p&gt;&lt;p&gt;It is the &lt;em&gt;generator&lt;/em&gt;‚Äôs job to actually generate a few operations and then let the &lt;em&gt;clients&lt;/em&gt; performs the operations and return &lt;em&gt;&lt;code class="highlighter-rouge"&gt;completion operations&lt;/code&gt;&lt;/em&gt; (with the read value specified for instance).&lt;/p&gt;&lt;h2 id="client"&gt;Client&lt;/h2&gt;&lt;p&gt;A client is an implementation of the types of function invocations you want to perform onto the system.&lt;/p&gt;&lt;p&gt;Given the three &lt;em&gt;operations&lt;/em&gt; above, one must implement a &lt;code class="highlighter-rouge"&gt;clojure protocol&lt;/code&gt; (think Java interface, but better) in order to actually perform the operation, for instance implementing a write of an integer to the database you are willing to test, using your SDK/library of choice.&lt;/p&gt;&lt;h2 id="generator"&gt;Generator&lt;/h2&gt;&lt;p&gt;Generators are more sophisticated beast from my little understanding. While an &lt;em&gt;invocation operation&lt;/em&gt; is a kind of template of an operation to be performed, a generator is responsible for creating more of them. Without giving you all the options available, I can tell that a generator can be configured to construct new &lt;em&gt;&lt;code class="highlighter-rouge"&gt;invocation operations&lt;/code&gt;&lt;/em&gt; for a certain type (read for instance) or a mix (a mix of read and writes, or a mix of read, writes and compare-and-set).&lt;br /&gt; Other parameters include the ability to stagger operations by a certain amount of time, impose a time limit for performing operations, etc.&lt;/p&gt;&lt;h2 id="nemesis"&gt;Nemesis&lt;/h2&gt;&lt;p&gt;A nemesis is our chaos monkey: it will introduce failures, such as network partitions, and heal them back.&lt;/p&gt;&lt;p&gt;Nemesis operations are also constructed by the generator, to which we can specify an order of execution, such as a cycling: sleep operation, start operation (introduce a failure), sleep operation (hoping some client operation will fail) and then stop operation (end the failure).&lt;/p&gt;&lt;h2 id="pizza--beers--chit-chat"&gt;Pizza + beers + chit-chat&lt;/h2&gt;&lt;p&gt;That was the content of the workshop for the morning, and it went &lt;em&gt;fast&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;For lunch, the organizers at JOTB had planned on-demand pizzas and beer. It was also the occasion to discover the backyard of the venue under a bright sky.&lt;/p&gt;&lt;p&gt;I sat at a table with Kyle and other trainees and chitchatted about &lt;a href="http://jepsen.io/analyses"&gt;Jepsen analyses&lt;/a&gt; and systems that other attendees were interested in testing.&lt;br /&gt; We also talked about Clojure and languages but mostly the discussion focused on Kyle‚Äôs work/studies, how he funded his researches and how he approached (or was being approached by) databases or other softwares vendors in order to improve their product/communicate about its robustness/bugfixes.&lt;/p&gt;&lt;p&gt;And then back to work.&lt;/p&gt;&lt;h2 id="history"&gt;History&lt;/h2&gt;&lt;blockquote&gt; &lt;p&gt;With our generator and clients performing operations, we‚Äôve got a history to analyze for correctness. &lt;a href="https://github.com/jepsen-io/jepsen/blob/master/doc/checker.md"&gt;Jepsen etcdemo - checker&lt;/a&gt;&lt;/p&gt; &lt;/blockquote&gt;&lt;p&gt;The history is not directly exposed to you as a test designer, but it is necessary to verify the results of the operations.&lt;br /&gt; Under the hood I suppose (I haven‚Äôt checked yet) that Jepsen stores the history in some way as a collection of every &lt;em&gt;completed operations&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;This history is then used by the &lt;em&gt;checker&lt;/em&gt; in order to verify correctness between what the systems said it did and what it actually did.&lt;/p&gt;&lt;p&gt;Jepsen also uses the history to generate a set of graphs.&lt;/p&gt;&lt;h2 id="checker"&gt;Checker&lt;/h2&gt;&lt;p&gt;Now, this history is not going to analyze itself. This is the role of the checker, whose job it is to reorder the calls/results from all the clients and confront the history to a model.&lt;/p&gt;&lt;p&gt;When a client writes a value and gets back an acknowledgement of the write, the system‚Äôs log is checked to see if the database actually performed the write.&lt;/p&gt;&lt;h2 id="model"&gt;Model&lt;/h2&gt;&lt;p&gt;A model is an abstraction on top of the &lt;a href="https://en.wikipedia.org/wiki/Linearizability"&gt;linearizability&lt;/a&gt; concept.&lt;br /&gt; It‚Äôs not easy to defined linearizability, I‚Äôve had to read and watch so many resources to try to understand that I can‚Äôt count them, and in the end I‚Äôm not sure I understand it well.&lt;/p&gt;&lt;p&gt;Linearizability is a type of consistency among others (eventual consistency, causality linearizability, strong linearizability, etc).&lt;/p&gt;&lt;p&gt;In short, and probably not fully exact: when a new value for a certain key has been written (successfully), no previous value for this key should be read ever, and every subsequent read should return the same value unless another successful write is performed.&lt;/p&gt;&lt;p&gt;Now, Jepsen uses &lt;a href="https://github.com/jepsen-io/knossos"&gt;Knossos&lt;/a&gt; under the hood to build a singlethreaded model that is holding the history of operations and results, and by reducing (I guess, but it‚Äôs an implementation detail) over the operations, analyses the state to find illegal state transitions.&lt;/p&gt;&lt;h2 id="qa"&gt;Q/A&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;How do you find a bug?&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;As Kyle explained, he generally started by reading the READMEs and documentations of the systems he wanted to evaluate.&lt;/p&gt;&lt;p&gt;Then it‚Äôs a mix of gut feeling and experience that leads him toward testing a feature or another, and apply different types of failures to the system.&lt;/p&gt;&lt;p&gt;In the end what is important is that Jepsen is a tool that enables anyone to test the softwares it uses and make informed choices.&lt;/p&gt;&lt;p&gt;&lt;strong&gt;How long does it take?&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;I honestly can‚Äôt remember the answer to this question and I did not write it in my notes. So maybe someone (a fellow trainee, a reviewer) can fill-in this gap?&lt;/p&gt;&lt;h1 id="wrap-up"&gt;Wrap-up&lt;/h1&gt;&lt;p&gt;This workshop is usually done in two days so keeping up with the fast coding pace and trying to fit all the concepts and information in my head in a single day was hard.&lt;br /&gt; And by ‚Äúhard‚Äù I don‚Äôt mean &lt;em&gt;painful&lt;/em&gt;, but &lt;em&gt;exhausting&lt;/em&gt;. It was actually pleasant, and Kyle is a &lt;strong&gt;&lt;em&gt;fantastic&lt;/em&gt;&lt;/strong&gt; teacher: he is funny and he really cares. Nonetheless, I‚Äôm pretty sure I wasn‚Äôt the only one in the room feeling really tired at the end of the day, so I took a long walk (by the beach :P) in order to clear my mind.&lt;/p&gt;&lt;p&gt;If you want to know more about Jepsen, and learn more about distributed systems in general (which is my case), you can follow the etcdemo guide by yourself at home, but if you have the possibility to attend one of Kyle‚Äôs workshop, don‚Äôt hesitate, he really &lt;em&gt;knows his stuff&lt;/em&gt; and he is a &lt;em&gt;fantastic person&lt;/em&gt;.&lt;/p&gt;</content> <author> <name>Arnaud bos</name> <email>arnaud@monkeypatch.io</email> </author> <category term="JOTB"/> <category term="Distributed Systems"/> <category term="Databases"/> <category term="Jepsen"/> <category term="Testing"/> <summary>The first book I‚Äôve read about distributed systems was Distributed Systems: Principles and Paradigms by Andrew S. Tanenbaum and Maarten van Steen. I was reading at the library on my last year of study and I remember being confused very often, and to be honest I didn‚Äôt even finish it‚Ä¶</summary> </entry> <entry xml:lang="fr"><title>Making Of ‚ÄòCSS is Awesome !‚Äô</title><link href="http://www.monkeypatch.io/2017/05/02/MakingOf_CSS_is_Awesome.html" rel="alternate" type="text/html" title="Making Of 'CSS is Awesome !'"/> <published>2017-05-02T00:00:00+02:00</published> <updated>2017-05-02T00:00:00+02:00</updated><id>http://www.monkeypatch.io/2017/05/02/MakingOf_CSS_is_Awesome</id> <content type="html" xml:base="http://www.monkeypatch.io/2017/05/02/MakingOf_CSS_is_Awesome.html">&lt;h2 id="introduction"&gt;Introduction&lt;/h2&gt;&lt;p&gt;Depuis quelque temps, j‚Äôavais l‚Äôid√©e de faire une pr√©sentation sur le CSS, mon objectif √©tait de redorer le blason de cette technologie souvent crainte et sous-estim√©e par de trop nombreux d√©veloppeurs. J‚Äôai profit√© du CFP de DevoxxFR pour me jeter √† l‚Äôeau. En plus de mon app√©tance pour la transmission, j‚Äôaime bien faire des talks car √ßa me pousse √† aller plus loin sur le sujet que je pr√©sente. Pour celle-ci, je me suis donn√© comme d√©fi de faire la pr√©sentation en HTML/CSS sans JavaScript dans les slides. Cet article pr√©sente donc le r√©sultat de ce d√©fi.&lt;/p&gt;&lt;!--more--&gt;&lt;blockquote&gt; &lt;p&gt;J‚Äôai fait cette pr√©sentation √† &lt;a href="https://www.youtube.com/watch?v=H8lICKucWL4"&gt;DevoxxFR (30 min.)&lt;/a&gt;, et une version plus longue √† &lt;a href="https://vimeo.com/215621504"&gt;MiXiT (50 min.)&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Bien s√ªr, faire des pr√©sentations en HTML/CSS/JS n‚Äôest pas nouveau, certains sont tr√©s bien faits comme :&lt;/p&gt; &lt;/blockquote&gt;&lt;ul&gt; &lt;li&gt;&lt;a href="http://lab.hakim.se/reveal-js/#/"&gt;reveal.js&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="http://markdalgleish.com/projects/bespoke.js/"&gt;bespoke.js&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="https://shwr.me/"&gt;Showr&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="https://leaverou.github.io/csss/#intro"&gt;CSSS&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;J‚Äôavais d√©j√†, dans le cadre d‚Äôune autre pr√©sentation, √©crit mon propre framework en utilisant du CoffeeScript: &lt;a href="https://github.com/ilaborie/prez"&gt;Prez&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Pourquoi en √©crire un nouveau, qui sera moins bien que ceux qui sont port√©s depuis plusieurs ann√©es ? La raison principale est que cela me permet de sortir de ma ‚Äòzone de confort‚Äô, ce qui est toujours tr√®s enrichissant. En plus de cet aspect, cela me permet de creuser des sujets que je n‚Äôai pas encore eu l‚Äôoccasion d‚Äô√©tudier comme les ‚ÄòCustom Properties de CSS 4‚Äô (aka les variables), et puis c‚Äôest fun.&lt;/p&gt;&lt;blockquote&gt; &lt;p&gt;Attention lors d‚Äôune pr√©sentation on peut (du moins on esp√®re) contr√¥ler l‚Äôenvironnement: navigateur, r√©solution, ‚Ä¶ Quand j‚Äôai r√©alis√© cette application je suis parti sur &lt;a href="https://www.google.fr/chrome/browser/canary.html"&gt;Chrome Canary&lt;/a&gt;, et j‚Äôai constat√© qu‚Äôil y avait des ralentissements sur les autres navigateurs quand j‚Äôutilisais les &lt;a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_variables"&gt;Custom Properties&lt;/a&gt; :‚Äô( A suivre‚Ä¶&lt;/p&gt; &lt;/blockquote&gt;&lt;p&gt;&lt;em&gt;Le code que je d√©cris ici est disponible dans &lt;a href="https://github.com/ilaborie/css-awesome"&gt;Github&lt;/a&gt;. √Ä ce jour, il n‚Äôest pas destin√© √† devenir un nouveau framework. Il faudrait faire pas mal de m√©nage avant de pouvoir en faire quelque chose d‚Äôint√©ressant.&lt;/em&gt;&lt;/p&gt;&lt;h2 id="comment-afficher-et-animer-les-slides-"&gt;Comment afficher et animer les slides ?&lt;/h2&gt;&lt;h3 id="structure-de-base"&gt;Structure de base&lt;/h3&gt;&lt;p&gt;En gros voici la base de code HTML pour les slides :&lt;/p&gt;&lt;div class="language-html highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="nt"&gt;&amp;lt;html&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;head&amp;gt;&lt;/span&gt;&lt;span class="c"&gt;&amp;lt;!-- ... --&amp;gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/head&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;body&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;main&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;section&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;"cover"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;&lt;span class="c"&gt;&amp;lt;!-- ... --&amp;gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/section&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;section&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;"slide1"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;&lt;span class="c"&gt;&amp;lt;!-- ... --&amp;gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/section&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;section&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;"slide2"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;&lt;span class="c"&gt;&amp;lt;!-- ... --&amp;gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/section&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;section&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;"slide3"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;&lt;span class="c"&gt;&amp;lt;!-- ... --&amp;gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/section&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;section&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;"end"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;&lt;span class="c"&gt;&amp;lt;!-- ... --&amp;gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/section&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;/main&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;/body&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;/html&amp;gt;&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Chaque slide correspond √† une &lt;code class="highlighter-rouge"&gt;&amp;lt;section&amp;gt;&lt;/code&gt;, pour faire simple on va donner la taille voulu pour chaque slide :&lt;/p&gt;&lt;div class="language-css highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="nt"&gt;section&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nl"&gt;width&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="m"&gt;100vw&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c"&gt;/* largeur maximun sans scroll */&lt;/span&gt; &lt;span class="nl"&gt;height&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="m"&gt;100vh&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c"&gt;/* hauteur maximun sans scroll */&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;blockquote&gt; &lt;p&gt;on peut utiliser l‚Äôunit√© &lt;code class="highlighter-rouge"&gt;vmin&lt;/code&gt; pour forcer un slide en 4/3 ou en 16/10 en mettant la largeur √† &lt;code class="highlighter-rouge"&gt;100vmin&lt;/code&gt;, et la hauteur √† &lt;code class="highlighter-rouge"&gt;75vmin&lt;/code&gt; pour le 4/3 ou &lt;code class="highlighter-rouge"&gt;62.5vmin&lt;/code&gt; pour le 16/10. On utilisera bien sur &lt;code class="highlighter-rouge"&gt;flexbox&lt;/code&gt; pour le centrage dans cette situation.&lt;/p&gt; &lt;/blockquote&gt;&lt;h3 id="comment-animer-les-slides-"&gt;Comment animer les slides ?&lt;/h3&gt;&lt;p&gt;Le principe de navigation est le suivant :&lt;/p&gt;&lt;ul&gt; &lt;li&gt;les slides sont d√©cal√©s sur la gauche avec &lt;code class="highlighter-rouge"&gt;transform: translateX(-100vmax);&lt;/code&gt; par d√©faut,&lt;/li&gt; &lt;li&gt;le slide courant est remis dans l‚Äôaxe avec &lt;code class="highlighter-rouge"&gt;transform: translateX(0);&lt;/code&gt;,&lt;/li&gt; &lt;li&gt;les slides suivants sont d√©cal√©s √† droites dans l‚Äôaxe avec &lt;code class="highlighter-rouge"&gt;transform: translateX(100vmax);&lt;/code&gt;&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;Une solution tr√®s simple pour identifier le slide courant c‚Äôest d‚Äôutiliser la pseudo classe &lt;code class="highlighter-rouge"&gt;:target&lt;/code&gt;. Le slide avec l‚Äôid &lt;code class="highlighter-rouge"&gt;XXX&lt;/code&gt; sera cibl√© lorsque l‚ÄôURL de notre navigateur sera du type &lt;code class="highlighter-rouge"&gt;http://&amp;lt;maprez&amp;gt;/&amp;lt;mapage&amp;gt;.html#XXX&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Ce qui ce traduit par le CSS suivant :&lt;/p&gt;&lt;div class="language-css highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="nt"&gt;section&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nl"&gt;transform&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;translateX&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;-100vmax&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nt"&gt;section&lt;/span&gt;&lt;span class="nd"&gt;:target&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="err"&gt;//&lt;/span&gt; &lt;span class="err"&gt;pseudo&lt;/span&gt; &lt;span class="py"&gt;classe&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt; &lt;span class="n"&gt;transform&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;translateX&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nt"&gt;section&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt; &lt;span class="nt"&gt;section&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="err"&gt;//&lt;/span&gt; &lt;span class="err"&gt;selecteur&lt;/span&gt; &lt;span class="err"&gt;~&lt;/span&gt; &lt;span class="nl"&gt;transform&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;translateX&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;-100vmax&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Et bien s√ªr, on ajoute une petite transition comme &lt;code class="highlighter-rouge"&gt;transition: transform .8s ease-in-out;&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Pour ceux qui on encore du mal avec les selecteurs CSS, le &lt;code class="highlighter-rouge"&gt;~&lt;/code&gt; c‚Äôest le selecteur des &lt;em&gt;siblings&lt;/em&gt;. Voir &lt;a href="https://developer.mozilla.org/en-US/docs/Learn/CSS/Introduction_to_CSS/Simple_selectors#Combinators"&gt;Simple selectors - Combinators&lt;/a&gt;&lt;/p&gt;&lt;h3 id="comment-changer-de-slides-"&gt;Comment changer de slides ?&lt;/h3&gt;&lt;p&gt;Pour cela il suffit d‚Äôun lien qui va sur le slide avec l‚Äôid qui correspond au slide souhait√©.&lt;/p&gt;&lt;div class="language-html highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="nt"&gt;&amp;lt;main&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;section&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;"cover"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt; &lt;span class="c"&gt;&amp;lt;!-- ... --&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;"next"&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;"#slide1"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/a&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;/section&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;section&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;"slide1"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;"previous"&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;"#cover"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/a&amp;gt;&lt;/span&gt; &lt;span class="c"&gt;&amp;lt;!-- ... --&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;"next"&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;"#slide2"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/a&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;/section&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;section&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;"slide2"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;"previous"&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;"#slide1"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/a&amp;gt;&lt;/span&gt; &lt;span class="c"&gt;&amp;lt;!-- ... --&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;"next"&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;"#slide3"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/a&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;/section&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;section&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;"slide3"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;"previous"&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;"#slide2"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/a&amp;gt;&lt;/span&gt; &lt;span class="c"&gt;&amp;lt;!-- ... --&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;"next"&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;"#end"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/a&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;/section&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;section&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;"end"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;"previous"&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;"#slide3"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/a&amp;gt;&lt;/span&gt; &lt;span class="c"&gt;&amp;lt;!-- ... --&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;/section&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;/main&amp;gt;&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Ensuite on peut passer au CSS pour rendre √ßa sympa :&lt;/p&gt;&lt;div class="language-css highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="nt"&gt;section&lt;/span&gt; &lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="nc"&gt;.previous&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;section&lt;/span&gt; &lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="nc"&gt;.next&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nl"&gt;position&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;fixed&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nl"&gt;top&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nl"&gt;width&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="m"&gt;5vw&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nl"&gt;height&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="m"&gt;100vh&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nl"&gt;font-size&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="m"&gt;25vh&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nl"&gt;color&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="m"&gt;#000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nl"&gt;display&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;flex&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nl"&gt;align-items&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;center&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nl"&gt;text-decoration&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;none&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nt"&gt;section&lt;/span&gt; &lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="nc"&gt;.previous&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nl"&gt;left&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nt"&gt;section&lt;/span&gt; &lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="nc"&gt;.previous&lt;/span&gt;&lt;span class="nd"&gt;::before&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nl"&gt;content&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;'&amp;lt;'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nt"&gt;section&lt;/span&gt; &lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="nc"&gt;.next&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nl"&gt;left&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="m"&gt;95vw&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nt"&gt;section&lt;/span&gt; &lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="nc"&gt;.next&lt;/span&gt;&lt;span class="nd"&gt;::before&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nl"&gt;content&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;'&amp;gt;'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p data-height="342" data-theme-id="0" data-slug-hash="wJbogy" data-default-tab="result" data-user="ilaborie" data-embed-version="2" data-pen-title="slides-css" class="codepen"&gt;See the Pen &lt;a href="https://codepen.io/ilaborie/pen/wJbogy/"&gt;slides-css&lt;/a&gt; by igor (&lt;a href="http://codepen.io/ilaborie"&gt;@ilaborie&lt;/a&gt;) on &lt;a href="http://codepen.io"&gt;CodePen&lt;/a&gt;.&lt;/p&gt;&lt;blockquote&gt; &lt;p&gt;Il y a d‚Äôautres solutions alternatives pour faire un syst√®me de slides, comme un m√©canisme avec des ‚Äúradio boutons‚Äù et le &lt;code class="highlighter-rouge"&gt;:checked&lt;/code&gt; pour remplacer le &lt;code class="highlighter-rouge"&gt;:target&lt;/code&gt;, ou bien laisser le scroll horizontal, et ne pas faire de translation.&lt;/p&gt; &lt;/blockquote&gt;&lt;h3 id="bonus--num√©ro-du-slide"&gt;Bonus : Num√©ro du slide&lt;/h3&gt;&lt;p&gt;Pour ajouter une num√©roration sur chaque slide, on peut utiliser un pseudo-√©l√©ment sur les &lt;code class="highlighter-rouge"&gt;&amp;lt;section&amp;gt;&lt;/code&gt;, avec un positionnement relatif. C‚Äôest l‚Äôoccasion d‚Äôutiliser les &lt;a href="https://developer.mozilla.org/fr/docs/Web/CSS/Compteurs_CSS"&gt;compteurs CSS&lt;/a&gt; :&lt;/p&gt;&lt;div class="language-css highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="nt"&gt;section&lt;/span&gt;&lt;span class="nd"&gt;::after&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nl"&gt;counter-increment&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;section&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nl"&gt;content&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;'# '&lt;/span&gt; &lt;span class="n"&gt;counter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;section&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Il nous reste ensuite le &lt;code class="highlighter-rouge"&gt;::before&lt;/code&gt; pour afficher une barre avec les logos, les hashtags, ‚Ä¶&lt;/p&gt;&lt;h3 id="bonus--navigation-rapide"&gt;Bonus : navigation rapide&lt;/h3&gt;&lt;p&gt;Pour naviguer rapidement entre les slides, on peut simplement cr√©er une barre de navigation que l‚Äôon peut fixer en bas ou en haut.&lt;/p&gt;&lt;div class="language-html highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="nt"&gt;&amp;lt;nav&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;"#cover"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/a&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;"#slide1"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/a&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;"#slide2"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/a&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;"#slide3"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/a&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;a&lt;/span&gt; &lt;span class="na"&gt;href=&lt;/span&gt;&lt;span class="s"&gt;"#end"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/a&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;/nav&amp;gt;&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p data-height="265" data-theme-id="0" data-slug-hash="ZeNKWw" data-default-tab="result" data-user="ilaborie" data-embed-version="2" data-pen-title="slides-css extra nav" class="codepen"&gt;See the Pen &lt;a href="https://codepen.io/ilaborie/pen/ZeNKWw/"&gt;slides-css extra nav&lt;/a&gt; by igor (&lt;a href="http://codepen.io/ilaborie"&gt;@ilaborie&lt;/a&gt;) on &lt;a href="http://codepen.io"&gt;CodePen&lt;/a&gt;.&lt;/p&gt;&lt;h2 id="comment-faire-du-live-edit-de-css-"&gt;Comment faire du live edit de CSS ?&lt;/h2&gt;&lt;p&gt;C‚Äôest la partie la plus ‚ÄòHack‚Äô du syst√®me, surtout ne pas utiliser ce principe dans du code qui peut aller en production.&lt;/p&gt;&lt;p&gt;Pour cela, on utilise la balise &lt;code class="highlighter-rouge"&gt;&amp;lt;style&amp;gt;&lt;/code&gt; avec l‚Äôattribut &lt;code class="highlighter-rouge"&gt;contenteditable&lt;/code&gt;, et ensuite il faut bricoler le style pour rendre √ßa visible.&lt;/p&gt;&lt;p data-height="265" data-theme-id="0" data-slug-hash="BWgBeV" data-default-tab="result" data-user="ilaborie" data-embed-version="2" data-pen-title="pur CSS Live Edit" class="codepen"&gt;See the Pen &lt;a href="https://codepen.io/ilaborie/pen/BWgBeV/"&gt;pur CSS Live Edit&lt;/a&gt; by igor (&lt;a href="http://codepen.io/ilaborie"&gt;@ilaborie&lt;/a&gt;) on &lt;a href="http://codepen.io"&gt;CodePen&lt;/a&gt;.&lt;/p&gt;&lt;blockquote&gt; &lt;p&gt;Notez qu‚Äôil est pr√©f√©rable de faire du &lt;a href="https://developer.mozilla.org/fr/docs/Web/API/Document/designMode"&gt;designMode&lt;/a&gt; plut√¥t que du &lt;code class="highlighter-rouge"&gt;contenteditable&lt;/code&gt;. Mais cela n√©cessitait d‚Äôavoir du JavaScript, et mon objectif √©tait de ne pas en faire.&lt;/p&gt; &lt;/blockquote&gt;&lt;h2 id="produire-du-pdf"&gt;Produire du PDF&lt;/h2&gt;&lt;p&gt;Les slides en HTML c‚Äôest bien, mais on est parfois obliger de produire un PDF correspondant. Pour cela, j‚Äôai cr√©√© une pr√©sentation sp√©cialis√©e avec un CSS pour le &lt;code class="highlighter-rouge"&gt;media print&lt;/code&gt;. Ensuite on peut passer par la boite de l‚Äôimpression pour g√©n√©rer un PDF correspondant. Attention si vous ne pr√©voyez pas cette fonctionnalit√© assez t√¥t vous risquez de passer beaucoup de temps pour mettre au point un look raisonnable. Chrome. La prochaine fois je ferai plus attention‚Ä¶&lt;/p&gt;&lt;p&gt;Enfin le souci qu‚Äôil reste c‚Äôest que le live-edit √ßa rends pas terrible sur du PDF‚Ä¶&lt;/p&gt;&lt;h2 id="build-system"&gt;Build system&lt;/h2&gt;&lt;p&gt;Ce m√©canisme de slide a un gros d√©faut, il faut syst√©matiquement ajouter les liens before/next sur chaque slide, et penser √† maintenir les identifiants. Cela peut devenir vraiement lourd lorsqu‚Äôon ajoute/supprime/d√©place un slide.&lt;/p&gt;&lt;p&gt;Et puis il faut quand m√™me trouver un endroit pour faire du TypeScript et du NodeJS‚Ä¶ Donc, l‚Äôid√©e est de construire automatiquement le fichier HTML en aggr√©geant des fichiers qui correspondent √† chaque slide.&lt;/p&gt;&lt;h3 id="nodejs-et-tooling"&gt;NodeJS et Tooling&lt;/h3&gt;&lt;p&gt;Pour le m√©canisme de construction, on va devoir faire des op√©rations sur les fichiers et r√©pertoires, pour cela j‚Äôutilise &lt;code class="highlighter-rouge"&gt;mkdirp&lt;/code&gt; pour faire l‚Äô√©quivalent du &lt;code class="highlighter-rouge"&gt;mkdir -p&lt;/code&gt; et &lt;code class="highlighter-rouge"&gt;rimraf&lt;/code&gt; pour &lt;code class="highlighter-rouge"&gt;rm -rf&lt;/code&gt; tout en √©tant compatible avec les plateformes qui ne supportent pas (encore) ces commandes.&lt;/p&gt;&lt;p&gt;Pour le reste des op√©rations, on va utiliser les modules &lt;code class="highlighter-rouge"&gt;fs&lt;/code&gt; et &lt;code class="highlighter-rouge"&gt;path&lt;/code&gt; de NodeJS pour les autres op√©rations sur le file system. J‚Äôai choisi de ‚Äòpromisifier‚Äô ces API, mais on aurait aussi pu utiliser &lt;a href="http://bluebirdjs.com/docs/getting-started.html"&gt;bluebird&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Voici un exemple avec &lt;code class="highlighter-rouge"&gt;readFile&lt;/code&gt;&lt;/p&gt;&lt;div class="language-typescript highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="k"&gt;export&lt;/span&gt; &lt;span class="kd"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;readFile&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;encoding&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'utf8'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;Promise&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kr"&gt;string&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nb"&gt;Promise&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="nx"&gt;resolve&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;reject&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;fs&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;readFile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;encoding&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;err&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;err&lt;/span&gt; &lt;span class="p"&gt;?&lt;/span&gt; &lt;span class="nx"&gt;reject&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;err&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;resolve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)));&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Pour le templating, il existe d√©j√† plein de solutions en JavaScript, dans ce cas j‚Äôai utilis√© la solution basique : le templating de ES6. Par exemple, pour construire ma page, j‚Äôutilise le code suivant :&lt;/p&gt;&lt;div class="language-typescript highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="k"&gt;export&lt;/span&gt; &lt;span class="kd"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;html&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;body&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;slides&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;title&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'A Title'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;key&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'index'&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt; &lt;span class="kr"&gt;string&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="kd"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;nav&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;slides&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;map&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="nx"&gt;slide&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;index&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;a&lt;/span&gt; &lt;span class="nx"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"#${slide.id}"&lt;/span&gt; &lt;span class="nx"&gt;title&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"${slide.id}"&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;index&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="sr"&gt;/a&amp;gt;`&lt;/span&gt;&lt;span class="se"&gt;)&lt;/span&gt;&lt;span class="err"&gt;; &lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;!&lt;/span&gt;&lt;span class="nx"&gt;doctype&lt;/span&gt; &lt;span class="nx"&gt;html&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;html&lt;/span&gt; &lt;span class="nx"&gt;lang&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"en"&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;head&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;meta&lt;/span&gt; &lt;span class="nx"&gt;charset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"UTF-8"&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;meta&lt;/span&gt; &lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"viewport"&lt;/span&gt; &lt;span class="nx"&gt;content&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;meta&lt;/span&gt; &lt;span class="nx"&gt;http&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;equiv&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"X-UA-Compatible"&lt;/span&gt; &lt;span class="nx"&gt;content&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"ie=edge"&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;title&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;title&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="sr"&gt;/title&lt;/span&gt;&lt;span class="err"&gt;&amp;gt; &lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;link&lt;/span&gt; &lt;span class="nx"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"https://fonts.googleapis.com/icon?family=Material+Icons"&lt;/span&gt; &lt;span class="nx"&gt;rel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"stylesheet"&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;link&lt;/span&gt; &lt;span class="nx"&gt;rel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"stylesheet"&lt;/span&gt; &lt;span class="nx"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"index.css"&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="sr"&gt;/head&lt;/span&gt;&lt;span class="err"&gt;&amp;gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;body&lt;/span&gt; &lt;span class="kr"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"${key}"&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt; &lt;span class="kr"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"slides-nav"&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;nav&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;nav&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'\n'&lt;/span&gt;&lt;span class="p"&gt;)}&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="sr"&gt;/nav&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;main&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;body&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="sr"&gt;/main&lt;/span&gt;&lt;span class="err"&gt;&amp;gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="sr"&gt;/body&lt;/span&gt;&lt;span class="err"&gt;&amp;gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="sr"&gt;/html&amp;gt;&lt;/span&gt;&lt;span class="err"&gt;` &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Enfin, on peut tout brancher pour obtenir un code comme celui ci :&lt;/p&gt;&lt;div class="language-typescript highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;buildHtml&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;slidesDir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;title&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;output&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nb"&gt;Promise&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;resolve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'- Building HTML ...'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(()&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;slides&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;slidesDir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="c1"&gt;// r√©cu√®re la liste des slides&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="nx"&gt;slides&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;Slide&lt;/span&gt;&lt;span class="p"&gt;[])&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;slides&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="na"&gt;contents&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;slides&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;slide&lt;/span&gt;&lt;span class="p"&gt;)}))&lt;/span&gt; &lt;span class="c1"&gt;// construction du contenu&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(({&lt;/span&gt;&lt;span class="nx"&gt;slides&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;contents&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;slides&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="na"&gt;body&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;contents&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;sep&lt;/span&gt;&lt;span class="p"&gt;)}))&lt;/span&gt; &lt;span class="c1"&gt;// aggreation&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(({&lt;/span&gt;&lt;span class="nx"&gt;slides&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;body&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;html&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;body&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;slides&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;title&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;}))&lt;/span&gt; &lt;span class="c1"&gt;// construction du HTML&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;writeFile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;output&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="c1"&gt;// on √©crit&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(()&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;`‚úÖ&lt;/span&gt; &lt;span class="nx"&gt;Write&lt;/span&gt; &lt;span class="nx"&gt;HTML&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;output&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="c1"&gt;// Emoji rocks&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;catch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;err&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;`Ô∏è&lt;/span&gt;&lt;span class="nx"&gt;FAIL&lt;/span&gt; &lt;span class="nx"&gt;building&lt;/span&gt; &lt;span class="nx"&gt;HTML&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;err&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt; &lt;span class="c1"&gt;// Oops&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;√Ä noter que depuis ES6 (ES2015), on peut utiliser la d√©construction, ce qui permet de faire des trucs sympas comme :&lt;/p&gt;&lt;div class="language-javascript highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;slides&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;contents&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;slides&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="na"&gt;body&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;contents&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;sep&lt;/span&gt;&lt;span class="p"&gt;)})&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;qui est √©quivalent au code suivant :&lt;/p&gt;&lt;div class="language-javascript highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;object&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;slides&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;slides&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;contents&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;contents&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="na"&gt;slides&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;slides&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="na"&gt;body&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;contents&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;sep&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;};&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;h3 id="les-slides"&gt;Les Slides&lt;/h3&gt;&lt;h4 id="extraction"&gt;Extraction&lt;/h4&gt;&lt;p&gt;On peut utiliser simplement les API du module &lt;code class="highlighter-rouge"&gt;fs&lt;/code&gt; de NodeJS pour lire le contenu d‚Äôun r√©pertoire, le trier, ‚Ä¶&lt;/p&gt;&lt;div class="language-typescript highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="k"&gt;export&lt;/span&gt; &lt;span class="kd"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;slides&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;Promise&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Slide&lt;/span&gt;&lt;span class="p"&gt;[]&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;readDir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;dir&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;// tous les fichiers du r√©pertoire&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;files&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;files&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="c1"&gt;// on trie (les slides sont pr√©fix√©s par un num√©ro)&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;files&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;files&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;onlySlide&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="c1"&gt;// on passe une regex pour extraire l'id&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;matchesList&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;matchesList&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;matches&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;matches&lt;/span&gt; &lt;span class="o"&gt;!==&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="c1"&gt;// on retire ce qui n'est pas un slide&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;matchesList&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;matchesList&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;matches&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;buildSlide&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;matches&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt; &lt;span class="c1"&gt;// construction du contenu&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;slidePromises&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nb"&gt;Promise&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;slidePromises&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="c1"&gt;// Promise&amp;lt;[]&amp;gt; =&amp;gt; Promise[]&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;slides&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;slides&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;slide&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;filterSlide&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;slide&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt; &lt;span class="c1"&gt;// on filtre ceux qui correspondent √† ma clef&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;slides&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;slides&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;buildSlideNav&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="c1"&gt;// on calcule les previous/next&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;catch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;err&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;`Ô∏è&lt;/span&gt;&lt;span class="nx"&gt;FAIL&lt;/span&gt; &lt;span class="nx"&gt;to&lt;/span&gt; &lt;span class="nx"&gt;read&lt;/span&gt; &lt;span class="nx"&gt;dir&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;dir&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;err&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt; &lt;span class="c1"&gt;// Oops&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Comme je g√©n√®re plusieurs pr√©sentations, et que certaines contiennent des slides diff√©rents, j‚Äôutilise des m√©tadonn√©es pour faire un filtre avant de construire les r√©f√©rences sur les slides pr√©c√©dents et suivants.&lt;/p&gt;&lt;h4 id="contenu-dun-slide"&gt;Contenu d‚Äôun slide&lt;/h4&gt;&lt;p&gt;Apr√®s lecture du contenu du fichier, on extrait les √©ventuelles meta-donn√©es, ici rien de tr√®s important. Le point int√©ressant dans cette partie, c‚Äôest que je veux pouvoir utiliser soit du markdown pour les slides simples, soit directement du HTML. Il n‚Äôy a pas de besoins particuliers pour du HTML, par contre pour le markdown on va utiliser la biblioth√®que &lt;a href="https://github.com/chjj/marked"&gt;marked&lt;/a&gt;. L‚Äôutilisation est tr√®s simple, et on peut facilement ajouter de quoi styliser les blocs de codes avec la colorisation syntaxique avec &lt;a href="https://github.com/isagalaev/highlight.js"&gt;highlight.js&lt;/a&gt;&lt;/p&gt;&lt;div class="language-typescript highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nx"&gt;marked&lt;/span&gt; &lt;span class="k"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;'marked'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;highlightAuto&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;'highlight.js'&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="kd"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;highlight&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;code&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;highlightAuto&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;code&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="kd"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;htmlContent&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;marked&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;markdownContent&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;highlight&lt;/span&gt;&lt;span class="p"&gt;});&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Il suffira ensuite d‚Äôajouter le style souhait√©, par exemple j‚Äôai utilis√© &lt;code class="highlighter-rouge"&gt;@import 'node_modules/highlight.js/styles/darcula';&lt;/code&gt;&lt;/p&gt;&lt;h3 id="styles"&gt;Styles&lt;/h3&gt;&lt;p&gt;Pour g√©n√©rer le style j‚Äôai fait du SCSS avec &lt;a href="https://www.npmjs.com/package/node-sass"&gt;node-sass&lt;/a&gt;, l‚Äôint√©gration est tr√®s facile aujourd‚Äôhui puisque on peut utiliser cette lib plut√¥t que du ruby. J‚Äôutilise donc le nesting et les mixins, et il reste encore quelques variables. Mais j‚Äôai privil√©gi√© les nouveaut√©s de CSS comme les &lt;a href="https://developer.mozilla.org/fr/docs/Web/CSS/--*"&gt;Custom properties&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Pour assurer la portabilit√© du style, j‚Äôutilise le postprocesseur &lt;a href="https://github.com/postcss/postcss"&gt;PostCSS&lt;/a&gt; avec les plugins &lt;a href="https://github.com/postcss/autoprefixer"&gt;autoprefixer&lt;/a&gt;, &lt;a href="https://github.com/postcss/postcss-custom-properties"&gt;postcss-custom-properties&lt;/a&gt; pour transpiler les customs properties, &lt;a href="http://cssnano.co/"&gt;cssnano&lt;/a&gt; pour minifier le code, et enfin &lt;a href="https://github.com/borodean/postcss-assets"&gt;postcss-assets&lt;/a&gt; qui nous permet d‚Äôautomatiquement inliner les images en &lt;a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs"&gt;data-uri&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Le code resemble donc √† √ßa :&lt;/p&gt;&lt;div class="language-typescript highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;scss&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;file&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;Promise&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;sass&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nb"&gt;Promise&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="nx"&gt;resolve&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;reject&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;sass&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;render&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;file&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;err&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;err&lt;/span&gt; &lt;span class="p"&gt;?&lt;/span&gt; &lt;span class="nx"&gt;reject&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;err&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;resolve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;});&lt;/span&gt;&lt;span class="k"&gt;export&lt;/span&gt; &lt;span class="kd"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;css&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;minify&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;Promise&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kr"&gt;string&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="kd"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;file&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'index.scss'&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="kd"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;plugins&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="nx"&gt;customProperties&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="na"&gt;preserve&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;}),&lt;/span&gt; &lt;span class="nx"&gt;autoprefixer&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="nx"&gt;assets&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="na"&gt;basePath&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;dir&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="p"&gt;];&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;minify&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;plugins&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;cssnano&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;scss&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;file&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;postcss&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;plugins&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;process&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;result&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;css&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;result&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'content'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;catch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;err&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;`Ô∏è&lt;/span&gt;&lt;span class="nx"&gt;FAIL&lt;/span&gt; &lt;span class="nx"&gt;to&lt;/span&gt; &lt;span class="nx"&gt;create&lt;/span&gt; &lt;span class="nx"&gt;CSS&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;dir&lt;/span&gt;&lt;span class="p"&gt;}:&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;err&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt; &lt;span class="p"&gt;};&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;h3 id="serveur-et-serveur-de-d√©veloppement"&gt;Serveur et serveur de d√©veloppement&lt;/h3&gt;&lt;p&gt;Techniquement, on peut ouvrir la pr√©sentation avec le protocle &lt;code class="highlighter-rouge"&gt;file://&lt;/code&gt;, mais comme j‚Äôai quelques liens externes, il faut utiliser le protocole &lt;code class="highlighter-rouge"&gt;http://&lt;/code&gt;. La solution la plus simple qui existe est d‚Äôutiliser python avec &lt;code class="highlighter-rouge"&gt;python -m SimpleHTTPServer&lt;/code&gt;. Cependant, cette solution n‚Äôest pas tr√®s pratique pour du d√©veloppement, une fois qu‚Äôon a pris go√ªt au LiveReload c‚Äôest difficile de s‚Äôen passer. Je pr√©f√®re utiliser &lt;a href="https://github.com/johnpapa/lite-server"&gt;lite-server&lt;/a&gt;, c‚Äôest super simple d‚Äôusage, et √ßa utilise &lt;a href="https://www.browsersync.io/"&gt;BrowserSync&lt;/a&gt; pour le LiveReload.&lt;/p&gt;&lt;p&gt;Les fichiers TypeScript peuvent √™tre compil√© en mode ‚Äòwatch‚Äô avec la commande &lt;code class="highlighter-rouge"&gt;tsc -w&lt;/code&gt;. Pour reconstruire automatiquement les slides lors d‚Äôune modification, j‚Äôutilise &lt;a href="https://nodemon.io/"&gt;nodemon&lt;/a&gt;.&lt;/p&gt;&lt;div class="language-json highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="s2"&gt;"scripts"&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"clean"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"rimraf js/ dist/"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"start"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"lite-server"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"build:dev"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"tsc &amp;amp;&amp;amp; node js/index.js"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"build"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"npm run clean &amp;amp;&amp;amp; tsc &amp;amp;&amp;amp; node js/index.js --minify"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"serve"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"npm run start &amp;amp; tsc -w &amp;amp; nodemon js/index.js"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Je pr√©f√®re utiliser les fichiers de configuration pour nodemon :&lt;/p&gt;&lt;div class="language-json highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"verbose"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"delay"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"watch"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"src/"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"js/"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"ext"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"scss png js svg html md"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;et pour BrowserSync :&lt;/p&gt;&lt;div class="language-json highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"server"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"baseDir"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"dist"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"directory"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"notify"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"open"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;h3 id="comment-publier-dans-les-github-pages-"&gt;Comment publier dans les Github Pages ?&lt;/h3&gt;&lt;p&gt;Dans ce dernier point concernant les outils, je voulais utiliser les &lt;a href="https://pages.github.com/"&gt;pages github&lt;/a&gt; pour publier les slides. Rien de plus simple avec &lt;a href="https://github.com/tschaub/gh-pages"&gt;gh-pages&lt;/a&gt; il suffit de lancer la commande &lt;code class="highlighter-rouge"&gt;gh-pages --dist dist/&lt;/code&gt;.&lt;/p&gt;&lt;h2 id="conclusion"&gt;Conclusion&lt;/h2&gt;&lt;p&gt;Si vous voulez voir jusqu‚Äôo√π on peut aller en HTML/CSS, y compris dans les emails, je vous recommande la pr√©sentation suivante: &lt;a href="https://vimeo.com/181481382"&gt;Modern and interactive email&lt;/a&gt;. Pour am√©liorer vos connaissances en CSS, je vous recommande chaudement le livre (et les pr√©sentations) &lt;a href="https://www.amazon.fr/CSS-Secrets-Lea-Verou/dp/1449372635"&gt;CSS Secret&lt;/a&gt; de &lt;a href="http://lea.verou.me/"&gt;Lea Verou&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Au del√† du CSS qui est si vaste que l‚Äôon peut y passer des ann√©es pour approfondir, je me suis beaucoup amus√© √† construire ces slides. L‚Äô√©cosyst√®me NodeJS est immense, parfois in√©gal mais on y trouve √† peu pr√®s tout ce que l‚Äôon veut. L‚ÄôES2015 (et plus) et TypeScript sont v√©ritablement sympas, c‚Äôest aussi plus accessible maintenant pour les d√©veloppeurs Java, attention toutefois le JavaScript peut √™tre pi√©geux quand il est mal ma√Ætris√©.&lt;/p&gt;&lt;p&gt;Pour apprendre, il faut sortir de sa zone de confort, les sides-projects sont id√©aux pour cela. J‚Äôai eu l‚Äôoccasion d‚Äô√©changer avec &lt;a href="https://twitter.com/pixelastic"&gt;Tim Carry&lt;/a&gt; √† MiXiT, il est l‚Äôauteur de &lt;a href="https://pixelastic.github.io/css-flags/"&gt;CSS Flags&lt;/a&gt; dont le principe est de faire les drapeaux avec un seul &lt;code class="highlighter-rouge"&gt;&amp;lt;div&amp;gt;&lt;/code&gt; et du CSS, on retrouve le m√™me principe dans ce (p√©rilleux) exercice (Voir &lt;a href="http://talks.pixelastic.com/slides/css-flags-mixit/#/"&gt;http://talks.pixelastic.com/slides/css-flags-mixit/#/&lt;/a&gt;).&lt;/p&gt;&lt;p&gt;Have fun &amp;amp; Hack !&lt;/p&gt;</content> <author> <name>Igor Laborie</name> <email>igor@monkeypatch.io</email> </author> <category term="CSS"/> <category term="Devoxx"/> <category term="MiXiT"/> <category term="NodeJS"/> <category term="TypeScript"/> <summary>IntroductionDepuis quelque temps, j‚Äôavais l‚Äôid√©e de faire une pr√©sentation sur le CSS, mon objectif √©tait de redorer le blason de cette technologie souvent crainte et sous-estim√©e par de trop nombreux d√©veloppeurs. J‚Äôai profit√© du CFP de DevoxxFR pour me jeter √† l‚Äôeau. En plus de mon app√©tance pour la transmission, j‚Äôaime bien faire des talks car √ßa me pousse √† aller plus loin sur le sujet que je pr√©sente. Pour celle-ci, je me suis donn√© comme d√©fi de faire la pr√©sentation en HTML/CSS sans JavaScript dans les slides. Cet article pr√©sente donc le r√©sultat de ce d√©fi.</summary> </entry> <entry xml:lang="fr"><title>AndroidMakers 2017</title><link href="http://www.monkeypatch.io/2017/04/12/androidMakers.html" rel="alternate" type="text/html" title="AndroidMakers 2017"/> <published>2017-04-12T00:00:00+02:00</published> <updated>2017-04-12T00:00:00+02:00</updated><id>http://www.monkeypatch.io/2017/04/12/androidMakers</id> <content type="html" xml:base="http://www.monkeypatch.io/2017/04/12/androidMakers.html">&lt;h1 id="retour-sur-landroid-makers-2017"&gt;Retour sur l‚ÄôAndroid Makers 2017&lt;/h1&gt;&lt;h2 id="introduction"&gt;Introduction&lt;/h2&gt;&lt;p&gt;Un peu comme apr√®s le 1er de l‚Äôan, quand je reviens d‚Äôune conf√©rence, j‚Äôai g√©n√©ralement plein de bonnes r√©solutions en t√™te, j‚Äôai envie d‚Äôappliquer toutes les bonnes m√©thodes, de tester les diff√©rentes techniques et libs qui ont √©t√© pr√©sent√©es. Mais cette fois, je vais commencer par faire mon retour sur ce blog pour ne rien oublier des deux jours que j‚Äôai pass√© √† l‚Äô&lt;a href="http://androidmakers.fr/"&gt;Android Makers&lt;/a&gt;.&lt;/p&gt;&lt;!--more--&gt;&lt;h2 id="un-peu-dhistoire"&gt;Un peu d‚Äôhistoire.&lt;/h2&gt;&lt;p&gt;Toujours organis√© par le PAUG et BeMyApp, Android Makers c‚Äôest le remake de la DroidCon Paris qui s‚Äô√©tait arr√©t√©e en 2015 avec la troisi√®me √©dition.&lt;/p&gt;&lt;p&gt;Android Makers, promet :&lt;/p&gt;&lt;blockquote&gt; &lt;p&gt;‚ÄúCe nouveau format nous donne la possibilit√© de garder tout ce que vous avez toujours aim√© dans nos pr√©c√©dentes conf√©rences : aller chercher les meilleurs speakers, s√©lectionner les talks les plus int√©ressants et innovants, avoir un programme coh√©rent, tout en s‚Äôappropriant davantage le format notamment avec de nouvelles animations.‚Äù&lt;/p&gt; &lt;/blockquote&gt;&lt;p&gt;&lt;img src="https://lh3.googleusercontent.com/eNvBo52suTg9D5euneCqQxcLg7MXzR7lkccL8w4t8sAwIW7v8EBQBTtiM8rtpa6lCND7J96ksUmrNUzTlZKnfIyxk3RXJ8mfSd67urHdYmVObELi5GkoE8IqWQHy8szAdQ2L3P0" alt="Image of Yaktocat" /&gt;&lt;/p&gt;&lt;p&gt;Et pour le coup, ils ne nous ont pas menti, il y avait pas mal de t√™tes connues dans le monde Android qui sont venus pour animer des conf√©rences. Pour ne citer qu‚Äôeux :&lt;/p&gt;&lt;ul&gt; &lt;li&gt; &lt;p&gt;&lt;a href="https://twitter.com/chethaase"&gt;Chet Haase&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;&lt;a href="https://twitter.com/romainguy"&gt;Romain Guy&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;&lt;a href="https://twitter.com/lisawrayz"&gt;Lisa Wray&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;&lt;a href="https://twitter.com/cyrilmottier"&gt;Cyril Mottier&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;&lt;a href="https://twitter.com/tsmith"&gt;Ty Smith&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;&lt;a href="https://twitter.com/Eyal_Lezmy"&gt;Eyal Lezmy&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt;&lt;a href="https://twitter.com/taylorling"&gt;Taylor Ling&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; &lt;/ul&gt;&lt;p&gt;Et oui, la majorit√© ne sont pas Francais, donc si vous voulez venir √† une prochaine session d‚ÄôAndroid makers, il est recommand√© de comprendre l‚Äôanglais.&lt;/p&gt;&lt;p&gt;Pour nous aider √† faire notre choix dans les conf√©rences √† suivre, les organisateurs avaient pr√©vu une application Android qui nous permettait de faire notre planning parmis 3 tracks. 2 salles avec des pr√©sentations de 45 minutes, et une petite salle de workshops assez longs ou mini sc√©ances de 20 minutes.&lt;/p&gt;&lt;p&gt;Pour les chiffres, √ßa se d√©roulait sur 2 jours, il y avait 560 participants et 66 speakers.&lt;/p&gt;&lt;h2 id="jour-1"&gt;Jour 1.&lt;/h2&gt;&lt;p&gt;Le rendez vous √©tait donn√© √† 8H aux salons de l‚ÄôAveyron dans le 12√®me arrondissement de Paris. √Ä mon arriv√©e, je suis all√© r√©cup√©rer le tee shirt que Taylor Ling avait design√© pour Android Makers, puis all√© directement en salle collation pour prendre un caf√©, et ensuite direction la Keynote.&lt;/p&gt;&lt;p&gt;&lt;img src="https://lh3.googleusercontent.com/xl8eNSRacpd686n_io1bXi4zP1e280uwb5e-KxLKmv8qXJRG46WXB3PrQa4I2w6FtnsiDTKMghFapTLzciFFHbvrNvyzQBZNVDP5oJ_7KxAkqsCnegtK83ddbFF4V5RBh-EuMpA" alt="Design du tee shirt" /&gt;&lt;/p&gt;&lt;h3 id="keynote"&gt;Keynote&lt;/h3&gt;&lt;p&gt;La Keynote √©tait je pense l‚Äôune des conf√©rences que les spectateurs ne voulaient pas rater. En effet, elle √©tait pr√©sent√©e par le duo Chet Haase et Romain Guy, deux personnalit√©s qui ont l‚Äôhabitude de faire des pr√©sentations ensemble. Le sujet du jour √©tait une r√©trospective des √©volutions d‚ÄôAndroid. Du premier SDK √† Android O, ils ont pu revenir sur des annecdotes sur le d√©veloppement, comme par exemple le fait de changer compl√®tement la fa√ßon dont est g√©r√©e l‚Äôaffichage, seulement 2 semaines avant la release d‚ÄôAndroid Honeycomb.&lt;/p&gt;&lt;p&gt;&lt;a href="https://www.youtube.com/watch?v=xOccHEgIvwY"&gt;Pour la revoir&lt;/a&gt;&lt;/p&gt;&lt;h3 id="les-confs-de-la-journ√©e"&gt;les confs de la journ√©e.&lt;/h3&gt;&lt;p&gt;J‚Äôai assist√© dans un premier temps √† une conf√©rence de Ty Smith sur le ‚ÄúDeep Android integrations‚Äù qui nous a pr√©sent√© un ensemble de bonnes pratiques qu‚Äôil a accumul√© pour faire en sorte que les applications qu‚Äôil d√©veloppe s‚Äôint√®grent bien avec les autres applications.&lt;/p&gt;&lt;p&gt;&lt;a href="https://speakerdeck.com/tysmith/deep-android-integrations"&gt;Les slides&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Ensuite j‚Äôai assist√© √† la conf√©rence de Cyril Mottier sur la bonne fa√ßon d‚Äôimpl√©menter un ‚ÄòLaunch Screen‚Äô sur Android. Cyril nous a, dans cette pr√©sentation, montr√© que c‚Äôest dans les petits d√©tails comme celui-ci qu‚Äôon voit si les d√©veloppeurs d‚Äôapplications sont consciencieux.&lt;/p&gt;&lt;p&gt;&lt;a href="https://speakerdeck.com/cyrilmottier/launch-screens-from-a-tap-to-your-app"&gt;Les slides&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Pour finir la matin√©e, je suis all√© voir une conf√©rence sur RxJava 2 de David Wursteisen. J‚Äôavais d√©j√† assist√© √† pas mal de confs sur RxJava en g√©n√©ral, et bien que celle l√† ne soit pas celle que j‚Äôai le plus appr√©ci√©e, elle pr√©sentait bien les concepts de base de la programmation r√©active.&lt;/p&gt;&lt;p&gt;&lt;a href="https://speakerdeck.com/dwursteisen/rxjava-est-mort-vive-rxjava-2"&gt;Les slides&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Apr√®s cette matin√©e bien remplie, il est temps d‚Äôaller se prendre un petit repas. Mais vraiment petit parce qu‚Äôil n‚Äôy avait pas de temps de pause de pr√©vu. J‚Äôai donc mang√© un sandwich en assistant √† une pr√©sentation de la programmation bas niveau par Guillaume Gigaud.&lt;/p&gt;&lt;p&gt;L‚Äôapr√®s midi s‚Äôest r√©v√©l√©e tout autant charg√©e. J‚Äôai commenc√© par une pr√©sentation de ‚ÄòClean Code‚Äô sur Android par Gabriel Adged et Damien Locque. Assez convaincu par l‚Äôutilit√©, je pense que j‚Äôappliquerai quelques principes lors de mes prochains d√©veloppements Android. Je n‚Äôai pas trouv√© les slides mais voici un tweet qui r√©sumerait l‚Äôarchitecture qu‚Äôils ont appliqu√©.&lt;/p&gt;&lt;blockquote class="twitter-tweet" data-lang="en"&gt;&lt;p lang="en" dir="ltr"&gt;Clean Architecture example by &lt;a href="https://twitter.com/OCTOTechnology"&gt;@OCTOTechnology&lt;/a&gt; &lt;a href="https://twitter.com/hashtag/AndroidMakers?src=hash"&gt;#AndroidMakers&lt;/a&gt; &lt;a href="https://t.co/3dWI851ysl"&gt;pic.twitter.com/3dWI851ysl&lt;/a&gt;&lt;/p&gt;&amp;mdash; Hugo Gresse (@HugoGresse) &lt;a href="https://twitter.com/HugoGresse/status/851445776546922497"&gt;April 10, 2017&lt;/a&gt;&lt;/blockquote&gt; &lt;script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"&gt;&lt;/script&gt;&lt;p&gt;Pour rester dans les concepts d‚Äôarchitecture et de bonnes pratiques, j‚Äôai ensuite assist√© √† la pr√©sentation ‚ÄúTaking care of your UI tests‚Äù par Florian Mierzejewski. Idem que la pr√©c√©dente, tr√®s bonne conf et pas mal d‚Äôid√©e √† reprendre. &lt;a href="https://speakerdeck.com/florianmski/taking-care-of-your-ui-tests"&gt;Les Slides&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Avant d‚Äôaller √† la ‚ÄúParty‚Äù, j‚Äôai suivi la derni√®re conf√©rence de la journ√©e pr√©sent√©e par Taylor Ling, qui nous a fait une r√©trospective des choses qui ont march√© ou pas lors de la conception de l‚Äôapplication Fabulous. Je ne connaissais pas cette application qui pourtant a connu un certain succ√©s, puisqu‚Äôelle totalise plusieurs millions de t√©l√©chargement. L‚Äôapplication vous sert de coach qui doit vous permettre, en respectant des conseils, de vous sentir mieux dans votre vie de tous les jours.&lt;/p&gt;&lt;p&gt;Vous pouvez y jeter un oeil &lt;a href="https://play.google.com/store/apps/details?id=co.thefabulous.app"&gt;sur le play store&lt;/a&gt;&lt;/p&gt;&lt;h2 id="jour-2"&gt;Jour 2&lt;/h2&gt;&lt;h3 id="keynote-1"&gt;Keynote&lt;/h3&gt;&lt;p&gt;Cette journ√©e commence par une Keynote de Lisa Wray que j‚Äôai particuli√®rement appr√©ci√©e, qui nous a d√©montr√© pourquoi il est maintenant important dans les nouveaux projets de penser ‚ÄúAndroid First‚Äù. C‚Äôest √† dire arr√™ter de penser qu‚Äôil faut d‚Äôabord faire une application iOS et ensuite, si il y a succ√®s faire son √©quivalent Android. Les choses se sont invers√©e, le march√© a √©volu√©, il faut aussi que les visions de cr√©ateurs d‚Äôapps √©voluent.&lt;/p&gt;&lt;p&gt;&lt;img src="https://lh3.googleusercontent.com/DERtQkLeRCuX1HK63YGxYDuTz7Q3mk5V7mShB_qpeIPZC6deVLeh2oCCt7SfgFJQ8gdlXQHu2ZsjDCZBzvKUU1ohh2vG8L9bBGJrzl0zxwOgoKgmbF00mu7fqM1lwI13F3Sq83s" alt="Android First" /&gt;&lt;/p&gt;&lt;h3 id="jour-2---les-conf√©rences"&gt;Jour 2 - Les conf√©rences&lt;/h3&gt;&lt;p&gt;Pour cette journ√©e, j‚Äôai assist√© principalement aux conf√©rences dans la salle principale. En commencant par ‚ÄúL‚Äô√©volution des notifications‚Äù que nous a pr√©sent√©e J√©r√©mie Martinez. Tr√®s bonne conf√©rence qui nous a donn√© des astuces pour bien g√©rer les notifications dans nos applications comme par exemple de ne pas h√©siter √† utiliser les spannables dans les notifications plut√¥t que des customs views.&lt;/p&gt;&lt;p&gt;&lt;a href="https://speakerdeck.com/jeremiemartinez/the-evolution-of-android-notification"&gt;Les slides&lt;/a&gt;&lt;/p&gt;&lt;p&gt;La matin√©e continue avec une conf√©rence sur les nouvelles fonctionnalit√©s du design tool pr√©sent√©e par l‚Äôun de ses cr√©ateurs : Nicolas Roard. J‚Äôai aussi beaucoup appr√©ci√© cette conf√©rence, parce qu‚Äôelle nous montre √† quel point Google souhaite avoir un √©cosyst√®me fait pour simplifier le travail du d√©veloppeur. Le tool de design va vraiment dans ce sens et les prochaines versions qui vont arriver nous promettent de bonnes √©volutions comme par exemple les blocks qui sont une sorte de guideline infranchissable pour le ConstraintLayout.&lt;/p&gt;&lt;p&gt;Ensuite, j‚Äôai assist√© √† une conf dont le titre est ‚ÄúIvre, il commercialisa des apps Android tout seul‚Äù. Pierre Benayou nous a pr√©sent√© ses √©checs et espoirs dans le but de faire une application qui lui rapportera de l‚Äôargent. Cette pr√©sentation bien qu‚Äôun peu vulgaire parfois&lt;/p&gt;&lt;blockquote&gt; &lt;p&gt;‚ÄúL‚Äôutilisateur est un connard‚Äù √† voir &lt;a href="https://docs.google.com/presentation/d/1afPtkSb_BUtD6t61wV2eaVLVzbnYQ9D6quaFCG9D4LI/edit#slide=id.g202d152fcf_0_61"&gt;ici&lt;/a&gt;&lt;/p&gt; &lt;/blockquote&gt;&lt;p&gt;nous a donn√© un bon ensemble de probl√®mes qu‚Äôun d√©veloppeur qui a une id√©e d‚Äôapplication peut rencontrer dans le but d‚Äôavoir une application qui a du succ√©s.&lt;/p&gt;&lt;p&gt;Ensuite est venue ma premi√®re grosse d√©ception de ces deux jours, une conf√©rence sur le paiement mobile. Sujet sur lequel je suis un peu sensibilis√©, ayant travaill√© plus de deux ans pour &lt;a href="https://www.ingenico.com/fr"&gt;Ingenico&lt;/a&gt;. Elle nous a √©t√© pr√©sent√©e par Mathieu Calba. Cette conf√©rence √©tait trop d√©butant pour m‚Äôinteresser, mais √ßa n‚Äôest que mon avis.&lt;/p&gt;&lt;p&gt;&lt;a href="https://speakerdeck.com/mathieu_calba/streamlining-payments-on-mobile"&gt;Les slides&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Pour finir, dans les conf√©rences classiques, j‚Äôai suivi ‚ÄúHow to ditch Activities and Fragments‚Äù par Fabien Devos, un sujet qui revient depuis pas mal de temps et qui interesse forc√©ment les d√©veloppeurs Android, tant le cycle de vie des Fragments combin√©s aux Activit√©s est compliqu√© √† g√©rer. J‚Äôai vraiment appr√©ci√© cette conf√©rence et je pense tester la solution OpenSource qu‚Äôil nous a propos√© : &lt;a href="https://github.com/wealthfront/magellan"&gt;Magellan&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Et enfin, pour conclure ces deux jours de conf√©rences, l‚ÄôOVNI Chet Haase nous a fait un show dont lui seul a le secret sur ‚ÄúBusiness &amp;amp; Technology‚Äù. Je ne peux que vous conseiller d‚Äôaller voir le replay tellement sa d√©monstration de pourquoi le business est li√© √† la technologie et inversement est ind√©niable.&lt;/p&gt;&lt;p&gt;&lt;a href="https://www.youtube.com/channel/UCkatLlah5weIpN23LqMgdTg/videos"&gt;lien √† venir&lt;/a&gt;&lt;/p&gt;&lt;h1 id="conclusion"&gt;Conclusion&lt;/h1&gt;&lt;p&gt;J‚Äôai vraiment pass√© deux joun√©es assez int√©ressantes, et en terme de conf√©rences sp√©cifiquement Android, Android Makers est un must go. Vous pouvez voir les vid√©os des conf√©rences sur le youtube d‚ÄôAndroid Makers. Normalement toutes les conf√©rences ont √©t√©s film√©es.&lt;/p&gt;&lt;h3 id="ce-que-jai-aim√©"&gt;Ce que j‚Äôai aim√©&lt;/h3&gt;&lt;ul&gt; &lt;li&gt;Tr√©s bonne organisation (un merci aux organisateurs et sponsors)&lt;/li&gt; &lt;li&gt;De super confs, par de super speakers&lt;/li&gt; &lt;li&gt;Un super tee shirt design√© par Taylor Ling&lt;/li&gt; &lt;li&gt;Retrouver les organisateurs des diff√©rents GDG de France&lt;/li&gt; &lt;li&gt;Voir autant de Toulousains pr√©sents et s‚Äôint√©ressant aux √©volutions d‚ÄôAndroid&lt;/li&gt; &lt;/ul&gt;&lt;h3 id="ce-que-jai-un-peu-moins-aim√©"&gt;Ce que j‚Äôai un peu moins aim√©&lt;/h3&gt;&lt;p&gt;Bon c‚Äôest vraiment pour chercher la petite b√™te, donc messieurs les orgas, ne le prenez pas mal :D&lt;/p&gt;&lt;ul&gt; &lt;li&gt;Ne pas avoir de temps pour souffler ou m√™me manger entre les sessions.&lt;/li&gt; &lt;li&gt;Pas de nourriture de pr√©vue dans le billet. √âtant organisateur du Devfest Toulouse, je sais qu‚Äôil faut parfois faire des choix. J‚Äôavais qu‚Äô√† lire les mails des organisateurs pour ne pas zapper le petit d√©j‚Äô le premier jour.&lt;/li&gt; &lt;li&gt;La petite salle de workshop/conf√©rence dont l‚Äôacoustique n‚Äô√©tait pas assez bonne pour bien entendre le speaker.&lt;/li&gt; &lt;/ul&gt;&lt;h1 id="√†-refaire-"&gt;√Ä refaire ?&lt;/h1&gt;&lt;p&gt;Bien s√ªr! Les organisateurs nous ont d√©j√† promis une suite pour l‚Äôann√©e prochaine, donc si vous n‚Äôavez pas pu √™tre pr√©sent √† cette session et que vous gravitez autour du monde Android, je vous recommande chaudement de ne pas manquer la mouture 2018 de l‚ÄôAndroid Makers.&lt;/p&gt;</content> <author> <name>Emmanuel Vinas</name> <email>emmanuel@monkeypatch.io</email> </author> <category term="Android"/> <category term="AndroidMakers"/> <summary>Retour sur l‚ÄôAndroid Makers 2017IntroductionUn peu comme apr√®s le 1er de l‚Äôan, quand je reviens d‚Äôune conf√©rence, j‚Äôai g√©n√©ralement plein de bonnes r√©solutions en t√™te, j‚Äôai envie d‚Äôappliquer toutes les bonnes m√©thodes, de tester les diff√©rentes techniques et libs qui ont √©t√© pr√©sent√©es. Mais cette fois, je vais commencer par faire mon retour sur ce blog pour ne rien oublier des deux jours que j‚Äôai pass√© √† l‚ÄôAndroid Makers.</summary> <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://androidmakers.fr/img/sprites/logo_androidmakers.gif"/> </entry> <entry xml:lang="fr"><title>ngVikings 2017</title><link href="http://www.monkeypatch.io/2017/03/07/ngVikings.html" rel="alternate" type="text/html" title="ngVikings 2017"/> <published>2017-03-07T00:00:00+01:00</published> <updated>2017-03-07T00:00:00+01:00</updated><id>http://www.monkeypatch.io/2017/03/07/ngVikings</id> <content type="html" xml:base="http://www.monkeypatch.io/2017/03/07/ngVikings.html">&lt;h2 id="introduction"&gt;Introduction&lt;/h2&gt;&lt;p&gt;√Ä peine remis du &lt;a href="https://www.meetup.com/fr-FR/Monkey-Tech-Days/events/232103376/"&gt;MonkeyTechDay #3: Reactive Streams&lt;/a&gt; coach√© par &lt;a href="https://twitter.com/sdeleuze"&gt;@sdeleuze&lt;/a&gt;, je prends l‚Äôavion direction Copenhague pour assister √† la premi√®re √©dition de &lt;a href="https://ngvikings.org/"&gt;ngVikings&lt;/a&gt;.&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;Pour un retour sur le MKTD, voir le retour de &lt;a href="https://medium.com/@Maxime_/monkey-tech-days-3-reactive-streams-c94f74e710d#.xzvbilpsi"&gt;Maxime&lt;/a&gt;&lt;/p&gt; &lt;/blockquote&gt;&lt;p&gt;#Stereotype, Au Danemark il fait plus froid qu‚Äô√† Toulouse, il y a des Lego, des Carlseberg, et une sir√®ne.&lt;/p&gt;&lt;p&gt;J‚Äôai plut√¥t l‚Äôhabitude de participer √† des conf√©rences assez g√©n√©ralistes, mais l√†, je vais faire deux jours int√©gralement sur du Angular (comprendre Angular 2+ pour ceux qui ne font pas encore la diff√©rence entre AngularJs et ‚ÄòJust Angular‚Äô).&lt;/p&gt;&lt;p&gt;C‚Äôest pour moi l‚Äôoccasion d‚Äôapprofondir le sujet, de voir l‚Äô√©cosyst√®me, et de rencontrer des d√©veloppeurs passionn√©s par ce sujet.&lt;/p&gt;&lt;p&gt;Je constate que certains ‚Äògrands comptes‚Äô Toulousains font un premier pas vers Angular sur leurs nouveaux projets, c‚Äôest donc le moment id√©al pour moi d‚Äôaller plus loin sur le sujet. &lt;!--more--&gt;&lt;/p&gt;&lt;h2 id="jour-1---conference-day"&gt;Jour 1 - Conference day&lt;/h2&gt;&lt;p&gt;La conf√©rence se d√©roule √† &lt;a href="https://en.itu.dk/"&gt;l‚Äôuniversit√© IT de Copenhague&lt;/a&gt;, les pr√©sentations durent 30 minutes, le rythme est soutenu : pas le temps de s‚Äôendormir. Les pauses de 5 minutes entre les conf√©rences sont un peu trop courtes pour vraiment souffler, mais le hall de l‚Äôuniversit√© est suffisament grand pour √©viter les embouteillages.&lt;/p&gt;&lt;p&gt;√Ä noter que l‚Äôapr√®s-midi, une salle sp√©ciale est r√©serv√©e pour discuter avec tous les speakers en parall√®le des deux salles avec des pr√©sentations, c‚Äôest particuli√®rement int√©ressant, car le format n‚Äôautorise pas vraiment la possibilit√© de poser des questions pendant les pr√©sentations.&lt;/p&gt;&lt;p&gt;Le cadre est tr√®s bien, cette universit√© est classe. Quand on arrive on est accueilli par de la musique ‚ÄòVikings‚Äô comme par exemple &lt;a href="https://www.youtube.com/watch?v=7fPoRacRhKE&amp;amp;feature=youtu.be"&gt;Wardruna - Bjarkan&lt;/a&gt;. (ne m‚Äôen demandez pas plus sur le sujet, j‚Äôy connais rien).&lt;/p&gt;&lt;h3 id="intro--keynote"&gt;Intro &amp;amp; keynote&lt;/h3&gt;&lt;p&gt;Cette conf√©rence est organis√©e par des communaut√©s des pays scandinaves (au sens large): AngularJS Copenhagen, GDG Copenhagen, AngularJS Oslo, AngularJS Gothenburg, ngAarhus, ngStockholm, Angular Finland. Pendant l‚Äôintroduction, les organisateurs sont accompagn√©s de Vikings en costume, √ßa met tout de suite dans l‚Äôambiance.&lt;/p&gt;&lt;p&gt;Apr√®s une rapide introduction, ils laissent la place √† &lt;a href="auchenberg"&gt;Kenneth Auchenberg&lt;/a&gt; de Microsoft pour la keynote. Derri√®re le titre un peu provoquant: &lt;a href="https://speakerdeck.com/auchenberg/a-future-without-browsers-february-2017"&gt;A Future without Browsers&lt;/a&gt; il nous expose une vision possible du futur du web que je trouve assez plausible.&lt;/p&gt;&lt;p&gt;Il a commenc√© par nous faire un rappel du d√©but des navigateurs internet, pour nous montrer le changement avec ce qu‚Äôils sont devenus aujourd‚Äôhui : des moteurs d‚Äôapplications. Aujoud‚Äôhui, on constate que beaucoup d‚Äôutilisateurs ne savent m√™me plus que lorsqu‚Äôils sont sur des r√©seaux sociaux, ils utilisent internet !&lt;/p&gt;&lt;p&gt;Les usages ont aussi beaucoup chang√© avec l‚Äôarriv√©e des smartphones qui ont mis quelques ann√©es pour devenir la plateforme majoritaire sur internet. Il faut aussi remarquer que la comp√©tition entre ces navigateurs a tir√© tout ce monde vers le haut. Demain, les PWA (Progressive Web App) pourraient bien remplacer les applications natives. Enfin de plus en plus d‚Äôapplications desktop se basent sur des navigateurs comme par exemple celles qui sont bas√©es sur &lt;a href="http://electron.atom.io/"&gt;Electron&lt;/a&gt;. Qui aurait cru il y a quelques ann√©es que le monde des IDE allait √™tre concurenc√© par des applications qui tournent dans un navigateur ?&lt;/p&gt;&lt;p&gt;Les applications natives embarquent aussi fr√©quemment un navigateur. Les nouvelles interfaces de recherche (Siri, Cortana), et les nouveaux assistants domestiques (Google Home, Echo, Alexa, ‚Ä¶) sont nos nouveaux moteurs de recherche, et de nouveaux √©cosyst√®mes pour les applications.&lt;/p&gt;&lt;p&gt;&lt;img src="/public/images/ngVikings17/keynote-webflux.png" alt="Web Flux" /&gt;&lt;/p&gt;&lt;p&gt;Pour r√©sumer, le monde des browsers tel que l‚Äôon a connu est r√©volu, aujourd‚Äôhui le navigateur au coeur des changements num√©riques. Ceci promet un bel avenir aux d√©veloppeurs Web (du coup, la notion de Front-End n‚Äôest pas tout √† fait exacte).&lt;/p&gt;&lt;h3 id="angular-outside-the-browser-angular-for-the-headless-web"&gt;Angular outside the Browser (Angular for the Headless web)&lt;/h3&gt;&lt;p&gt;Ensuite, je regarde la pr√©sentation de &lt;a href="https://twitter.com/manekinekko"&gt;Wassim Chegham&lt;/a&gt; un GDE fran√ßais qui nous parle d‚Äô&lt;a href="https://github.com/angular/universal"&gt;angular universal&lt;/a&gt;. Voici ses slides : &lt;a href="http://slides.com/wassimchegham/angular2-universal#/"&gt;http://slides.com/wassimchegham/angular2-universal#/&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;L‚Äôobjectif est le rendu cot√© serveur des applications angular. En effet, certains cas d‚Äôutilisation vont n√©cessiter ce rendu en dehors du navigateur : IoT, SEO (Search Engine Optimisation), Preview (social link), acc√©l√©ration du rendu de la premi√®re page. Angular s‚Äôinspire des autres frameworks qui ont d√©j√† r√©pondus √† ce besoin.&lt;/p&gt;&lt;p&gt;Le syst√®me de rendu d‚ÄôAngular peut donc faire avec le navigateur, avec les webworkers dans le navigateur ou bien dans un serveur comme NodeJS ou avec du .Net, et bient√¥t d‚Äôautres langages (on l‚Äôesp√®re).&lt;/p&gt;&lt;p&gt;Dans le cas d‚Äôun rendu serveur pour acc√©l√©rer le premier chargement, ensuite le navigateur reprend la main pour contiuner normalement. Cependant le probl√®me qu‚Äôil faut r√©soudre, c‚Äôest que l‚Äô√©tat conserv√© sur le serveur devra √™tre transf√©r√© dans le navigateur. Pour cela, il y a &lt;a href="https://github.com/angular/preboot"&gt;preboot&lt;/a&gt; qui va enregistrer les √©v√©nements pour les rejouer ensuite. Attention, il faut utiliser le moteur de rendu d‚ÄôAngular et pas le DOM, sinon on va perdre la capacit√© offerte par Angular Universal.&lt;/p&gt;&lt;p&gt;Bonne nouvelle Angular Universal rejoint Angular Core, √ßa nous promet de la qualit√© et une tr√®s bonne int√©gration.&lt;/p&gt;&lt;p&gt;Concr√®tement, un bon point de d√©part est &lt;a href="https://medium.com/google-developer-experts/angular-universal-for-the-rest-of-us-922ca8bac84#.db8v2ofj2"&gt;Angular Universal For The Rest Of Us&lt;/a&gt;. Le seul point faible de la pr√©sentation, c‚Äôest que j‚Äôaurais aim√© voir un exemple en live.&lt;/p&gt;&lt;h3 id="angular-continuous-integration"&gt;Angular Continuous integration&lt;/h3&gt;&lt;p&gt;Je continue par la pr√©sentation de &lt;a href="https://twitter.com/elecash"&gt;Ra√∫l Jim√©nez&lt;/a&gt;. Voici ses slides &lt;a href="http://slides.com/elecash/angular-continuous-integration#/"&gt;http://slides.com/elecash/angular-continuous-integration#/&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Il introduit le syndrome iwoml: ‚Äòit works on my latop‚Äô. Pour √©viter de succomber √† ce syndrome, il nous propose de faire de l‚Äôint√©gration continue. Notez que le m√©canisme de d√©claration des d√©pendances sous npm rends ceci plus important que dans un environnement ou les versions des libraries sont plus strictement contr√¥l√©s.&lt;/p&gt;&lt;p&gt;1- create a github repo&lt;/p&gt;&lt;p&gt;2- log in to Travis with your Github user&lt;/p&gt;&lt;p&gt;3- enable a repo on your Travis profile&lt;/p&gt;&lt;p&gt;4- install the Travis CLI and run ‚Äútravis init‚Äù&lt;/p&gt;&lt;p&gt;5- modify the .travis.yml file&lt;/p&gt;&lt;div class="language-yaml highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="s"&gt;sudo&lt;/span&gt;&lt;span class="pi"&gt;:&lt;/span&gt; &lt;span class="s"&gt;false&lt;/span&gt; &lt;span class="s"&gt;language&lt;/span&gt;&lt;span class="pi"&gt;:&lt;/span&gt; &lt;span class="s"&gt;node_js&lt;/span&gt; &lt;span class="s"&gt;cache&lt;/span&gt;&lt;span class="pi"&gt;:&lt;/span&gt; &lt;span class="s"&gt;directories&lt;/span&gt;&lt;span class="pi"&gt;:&lt;/span&gt; &lt;span class="pi"&gt;-&lt;/span&gt; &lt;span class="s"&gt;node_modules&lt;/span&gt; &lt;span class="s"&gt;notifications&lt;/span&gt;&lt;span class="pi"&gt;:&lt;/span&gt; &lt;span class="s"&gt;email&lt;/span&gt;&lt;span class="pi"&gt;:&lt;/span&gt; &lt;span class="s"&gt;false&lt;/span&gt; &lt;span class="s"&gt;node_js&lt;/span&gt;&lt;span class="pi"&gt;:&lt;/span&gt; &lt;span class="pi"&gt;-&lt;/span&gt; &lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="s"&gt;4'&lt;/span&gt; &lt;span class="s"&gt;before_install&lt;/span&gt;&lt;span class="pi"&gt;:&lt;/span&gt; &lt;span class="pi"&gt;-&lt;/span&gt; &lt;span class="s"&gt;export CHROME_BIN=chromium-browser&lt;/span&gt; &lt;span class="pi"&gt;-&lt;/span&gt; &lt;span class="s"&gt;export DISPLAY=:99.0&lt;/span&gt; &lt;span class="pi"&gt;-&lt;/span&gt; &lt;span class="s"&gt;sh -e /etc/init.d/xvfb start&lt;/span&gt; &lt;span class="pi"&gt;-&lt;/span&gt; &lt;span class="s"&gt;npm i -g npm@^3.0.0&lt;/span&gt; &lt;span class="s"&gt;before_script&lt;/span&gt;&lt;span class="pi"&gt;:&lt;/span&gt; &lt;span class="pi"&gt;-&lt;/span&gt; &lt;span class="s"&gt;npm prune&lt;/span&gt; &lt;span class="s"&gt;script&lt;/span&gt;&lt;span class="pi"&gt;:&lt;/span&gt; &lt;span class="pi"&gt;-&lt;/span&gt; &lt;span class="s"&gt;npm run build&lt;/span&gt; &lt;span class="s"&gt;branches&lt;/span&gt;&lt;span class="pi"&gt;:&lt;/span&gt; &lt;span class="s"&gt;except&lt;/span&gt;&lt;span class="pi"&gt;:&lt;/span&gt; &lt;span class="pi"&gt;-&lt;/span&gt; &lt;span class="s"&gt;/^v\d+\.\d+\.\d+$/&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;6- add your scripts on package.json&lt;/p&gt;&lt;div class="language-json highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="s2"&gt;"prebuild"&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"npm test -- --single-run"&lt;/span&gt;&lt;span class="err"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"build"&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"ng build --prod --aot"&lt;/span&gt;&lt;span class="err"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;7- modify the karma.conf.js&lt;/p&gt;&lt;div class="language-javascript highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;process&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;env&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;TRAVIS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;configuration&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;browsers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'Chrome_travis_ci'&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;config&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;configuration&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;8- create a branch and send a pull request&lt;/p&gt;&lt;p&gt;Et il nous fait du live-coding sur une version am√©lior√© en rajoutant &lt;a href="https://greenkeeper.io/"&gt;GreenKeeper&lt;/a&gt; et du versionnage s√©mantique. GreenKeeper permet de d√©clancher automatiquement des Pull Request sur le frontend lorsque le backend change.&lt;/p&gt;&lt;p&gt;Voir les d√©p√¥ts git pour le &lt;a href="https://github.com/elecash/ng2-ci-app"&gt;frontend&lt;/a&gt; et le &lt;a href="https://github.com/elecash/ng2-ci-api"&gt;backend&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;La d√©mo est vraiment convaincante, il faut de toute urgence que j‚Äôadapte ces scripts aux environnements que j‚Äôutilise traditionnellement (Jenkins, backend Java).&lt;/p&gt;&lt;p&gt;En gros voici les scripts npm de la partie client (bas√© sur angular-cli):&lt;/p&gt;&lt;div class="language-json highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="s2"&gt;"scripts"&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"precommit"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"npm test -- --single-run"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"commit"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"git-cz"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"ng"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"ng"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"serve:build"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"http-server ./dist -s -p 4200"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"start"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"ng serve"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"start:aot"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"ng serve --prod --aot"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"prebuild"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"npm test -- --single-run"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"build"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"ng build --prod --aot --bh /ng2-ci-app/"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"build:travis"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"ng build --prod --aot"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"lint"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"tslint \"src/**/*.ts\""&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"test"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"ng test"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"pree2e"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"webdriver-manager update --standalone false --gecko false"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"e2e"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"concurrently \"npm run serve:build\" \"protractor\" --kill-others --success first"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"stop"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"kill $(cat .pid)"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="err"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;et sur la partie backend (NodeJS):&lt;/p&gt;&lt;div class="language-json highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="s2"&gt;"scripts"&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"build"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"rimraf dist &amp;amp;&amp;amp; node build.js"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"commit"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"git-cz"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"semantic-release"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"semantic-release pre &amp;amp;&amp;amp; npm publish &amp;amp;&amp;amp; semantic-release post"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;"postpublish"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;"greenkeeper-postpublish"&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="err"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Pour voir les compl√©ments voir directement dans les d√©p√¥ts Github. J‚Äôai eu l‚Äôoccasion par la suite de discuter avec Ra√πl, j‚Äôesp√®re qu‚Äôon aura la chance de le voir passer par Toulouse dans le cadre du Devfest (ou du GDG Toulouse).&lt;/p&gt;&lt;h3 id="angular-forms"&gt;Angular Forms&lt;/h3&gt;&lt;p&gt;Ensuite, je vais voir la pr√©sentation d‚Äô&lt;a href="https://twitter.com/lakatos88"&gt;Alex Lakatos&lt;/a&gt; sur les formulaires. Il fait le tour des solutions pour faire des formulaires dans Angular:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;bas√©s sur des templates HTML (old fashion) en gros ce qu‚Äôon faisait en AngularJS&lt;/li&gt; &lt;li&gt;les r√©actives forms qui sont plus dynamique et avec moins de code HTML (mais du TypeScript). Le suivi des changements est facilit√©s si on utilise les √©v√®nements g√©n√©r√©s sous forme d‚Äô&lt;code class="highlighter-rouge"&gt;Observable&lt;/code&gt;, et l‚Äôajout de validateur (√©ventuellement custom et asynchrone) est plus facile.&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;Les deux types ont leurs avantages et leurs d√©fauts, il faut choisir en fonction de la situation. Disons que sur un formulaire simple, on peut se contenter de la version template, mais qu‚Äôassez rapidement, on arrive √† des situations ou les formulaire dynamiques apportent plus.&lt;/p&gt;&lt;h3 id="angular-material"&gt;Angular Material&lt;/h3&gt;&lt;p&gt;Derni√®re pr√©sentation avant la pause repas, √ßa devient dur de tenir. Mais &lt;a href="https://twitter.com/ladyleet"&gt;Tracy Lee&lt;/a&gt; nous fait une pr√©sentation sur &lt;a href="https://material.angular.io/"&gt;Angular Material&lt;/a&gt; qui est surtout du live-coding. Encore une GDE.&lt;/p&gt;&lt;p&gt;Pas √©vident de transcrire du live-coding, beaucoup de composants y passent: toolbar, sidenav, icon, grid list, chips, tooltip, dialog, button, card, list, tabs, snackbar. Le plus simple, c‚Äôest de suivre les slides: &lt;a href="http://www.slideshare.net/ladyleet/angular-material-2-ngvikingsconf"&gt;http://www.slideshare.net/ladyleet/angular-material-2-ngvikingsconf&lt;/a&gt;, et les sources: &lt;a href="https://github.com/ladyleet/ng-vikings-one"&gt;https://github.com/ladyleet/ng-vikings-one&lt;/a&gt;, enfin, un lien partique pour le th√®me mat√©rial: &lt;a href="https://www.materialpalette.com/"&gt;https://www.materialpalette.com/&lt;/a&gt;&lt;/p&gt;&lt;h3 id="lunch"&gt;Lunch&lt;/h3&gt;&lt;p&gt;Comme tout bon fran√ßais, je porte une attention toute particuli√®re sur la qualit√© des repas (surtout quand je suis √† l‚Äô√©tranger), le buffet froid servi √©tait correct et vari√©. Les p√¢tisseries danoises ne sont pas mauvaises, mais pas terrible en terme de di√©t√©tique. La pose repas c‚Äôest aussi l‚Äôoccasion de faire une photo de groupe et de participer au quiz. Les questions √©taient tellement simples, que le premier lot a √©t√© gagn√© par le premier venu :P&lt;/p&gt;&lt;p&gt;&lt;a href="/public/images/ngVikings17/lucky.png"&gt;Lucky Guy&lt;/a&gt;&lt;/p&gt;&lt;h3 id="authentication"&gt;Authentication&lt;/h3&gt;&lt;p&gt;Pour commencer doucement l‚Äôapr√®s-midi, j‚Äôassiste √† une pr√©sentation de &lt;a href="https://twitter.com/simona_cotin"&gt;Simona Cotin&lt;/a&gt; parlant des aspects authentification: une comparaison entre les m√©canismes √† base de Cookie et JWT. Je connaissais d√©j√† le sujet, mais sur ce genre de th√©matique, une bonne r√©vision ne fait jamais de mal.&lt;/p&gt;&lt;p&gt;Les authentifications classiques sont bas√©es sur un identifiant de session qui est construit cot√© serveur, il faut donc conserver cette session en vie (en m√©moire, ou dans une base de donn√©es), on fonctionne donc en mode ‚Äòstatefull‚Äô. Cet √©tat est donc g√©r√© cot√© serveur, et cela se complexifie vite si on est sur un architecture distribu√©e. Cot√© client, on stocke g√©n√©ralement cet identifiant dans un Cookie.&lt;/p&gt;&lt;p&gt;&lt;a href="https://jwt.io/"&gt;JWT (JSON Web Token)&lt;/a&gt; fournit une alternative int√©ressante √† cette architecture car on va pouvoir √™tre ‚Äòstateless‚Äô. Au lieu de renvoyer un identifiant de session, on envoie un token qui contient une partie en JSON (appel√© claims ou payload). En plus de ces donn√©es le token contient un checksum et les informations n√©cessaires pour v√©rifier ce checksum. Pour garantir la confiance en ce token il faut aussi associer une cl√© secr√®te qui est utilis√©e pour faire une v√©rification avec le checksum. Certains algorithmes utilis√©s pour calculer ce checksum utilisent un m√©canisme de cl√© priv√©e/publique qui permet √† tous de v√©rifier le token, mais de garantir que c‚Äôest bien le serveur qui a la responsablilt√© d‚Äôauthentifier l‚Äôutilisateur qui g√©n√®re le jeton.&lt;/p&gt;&lt;p&gt;Dans une route d‚ÄôAngular on peut associer un ‚Äòguard‚Äô qui permet de bloquer des routes si l‚Äôutilisateur n‚Äôest pas authentifi√©.&lt;/p&gt;&lt;p&gt;Il y avait aussi quelques assertions un peu rapides concernant les aspects s√©curit√©s comme CRSF et XSS que je ne pr√©f√®re pas rapporter, car je ne suis pas expert dans le domaine et je ne suis pas convaincu quelles soient exactes. C‚Äô√©tait une bonne pr√©sentation pour commencer l‚Äôapr√®s-midi.&lt;/p&gt;&lt;h3 id="lazy-loading"&gt;Lazy loading&lt;/h3&gt;&lt;p&gt;Ensuite, je suis all√© voir &lt;a href="https://twitter.com/manfredsteyer"&gt;Manfred Steyer&lt;/a&gt; qui nous parle du lazy loading des modules d‚ÄôAngular.&lt;/p&gt;&lt;p&gt;Sa pr√©sentation √©tait super, j‚Äôai appr√©ci√© l‚Äôalternance entre la th√©orie et les d√©monstrations. Je vous d√©tailerai le sujet plus bas. Vous trouverez ses slides ici: &lt;a href="https://speakerdeck.com/manfredsteyer/angular-lazy-loading-ngvikings-in-copenhagen-feb-2017"&gt;https://speakerdeck.com/manfredsteyer/angular-lazy-loading-ngvikings-in-copenhagen-feb-2017&lt;/a&gt;.&lt;/p&gt;&lt;h3 id="sri---sub-resource-integrity"&gt;SRI - Sub Resource integrity&lt;/h3&gt;&lt;p&gt;J‚Äôavais d√©j√† vu une pr√©sentation de &lt;a href="https://twitter.com/PhilippeDeRyck"&gt;Philippe De Ryck&lt;/a&gt; √† DevoxxBE, c‚Äôest un expert dans la s√©curit√© des applications web.&lt;/p&gt;&lt;p&gt;Dans sa pr√©sentation il se concentre sur la s√©curisation du code externe, c‚Äôest-√†-dire du code qui peut venir des CDN, des scripts externes (type publicit√©, google analytics, ‚Ä¶), ou des utilisateurs de notre application. Voir les slides ici: &lt;a href="https://www.websec.be/blog/ngvikings2017/"&gt;https://www.websec.be/blog/ngvikings2017/&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Pour valider le code venant d‚Äôun CDN on peut ajouter un checksum avec l‚Äôattribut &lt;code class="highlighter-rouge"&gt;integrity&lt;/code&gt; dans la balise &lt;code class="highlighter-rouge"&gt;&amp;lt;script&amp;gt;&lt;/code&gt;. Le navigateur se chargera de v√©rifier ce checksum, et si la v√©rification √©choue, il interdit l‚Äôex√©cution du script. Ce m√©canisme s‚Äôappelle le SRI (Sub Resource Integrity).&lt;/p&gt;&lt;div class="language-html highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="nt"&gt;&amp;lt;script &lt;/span&gt;&lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;‚Äú.../angular.js‚Äù&lt;/span&gt; &lt;span class="na"&gt;integrity=&lt;/span&gt;&lt;span class="s"&gt;‚Äúsha384-Li9v...DqAJ‚Äù&lt;/span&gt; &lt;span class="na"&gt;crossorigin=&lt;/span&gt;&lt;span class="s"&gt;‚Äúanonymous‚Äù&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Attention toutefois, on peut utiliser ce m√©canisme pour d√©tecter la pr√©sence d‚Äôun fichier. Il faut aussi bien configurer les CORS pour √©viter des fuites. Les CDN font des efforts pour simplifier le process, mais on peut aussi le g√©n√©rer nous-m√™me, par exemple avec le plugin webpack suivant : &lt;a href="https://github.com/waysact/webpack-subresource-integrity"&gt;webpack-subresource-integrity&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Le support dans les navigateurs n‚Äôest pas &lt;a href="http://caniuse.com/#feat=subresource-integrity"&gt;parfait&lt;/a&gt;, mais √ßa arrive.&lt;/p&gt;&lt;p&gt;Bien s√ªr, cela ne suffit pas, car le script peut faire mal les choses et ouvrir des portes suppl√©mentaires. Voici un r√©sum√© du talk qu‚Äôil a donn√© sur le sujet &lt;a href="https://www.youtube.com/watch?v=l89acmnGMSc"&gt;Boosting the security of your Angular 2 application - NG-BE 2016&lt;/a&gt;:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;Angular nous prot√®ge d√©j√† du XSS en retirant tout ce qui peut √™tre dangereux, c‚Äôest actif par d√©faut.&lt;/li&gt; &lt;li&gt;Attention ne pas laisser les utilisateurs contr√¥ler les templates, si on fait de l‚ÄôAOT c‚Äôest de toute fa√ßon pas possible.&lt;/li&gt; &lt;li&gt;le CSP (Content Security Policy) peut √©viter l‚Äôex√©cution de scripts inject√©s.&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;Pour ce qui est de la personnalisation venant des utilisateurs : par exemple si l‚Äôapplication rend possible l‚Äôaffichage de contenu HTML cr√©√© par un utilisateur, la solution √† base d‚Äôiframe sandbox√©e permet de contr√¥ler ce qui est possible dans cette iframe.&lt;/p&gt;&lt;div class="language-html highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="nt"&gt;&amp;lt;iframe&lt;/span&gt; &lt;span class="na"&gt;src=&lt;/span&gt;&lt;span class="s"&gt;‚Äú...‚Äù&lt;/span&gt; &lt;span class="na"&gt;sandbox&lt;/span&gt; &lt;span class="nt"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;/iframe&amp;gt;&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Dans l‚Äôattribut &lt;code class="highlighter-rouge"&gt;sandbox&lt;/code&gt; on peut pr√©ciser ce qui est possible de faire pour le contenu de l‚Äôiframe, par exemple &lt;code class="highlighter-rouge"&gt;allow-scripts&lt;/code&gt; ou &lt;code class="highlighter-rouge"&gt;allow-same-origin&lt;/code&gt;. ATTENTION n‚Äôutilisez pas les &lt;code class="highlighter-rouge"&gt;allow-scripts&lt;/code&gt; et &lt;code class="highlighter-rouge"&gt;allow-same-origin&lt;/code&gt; en m√™me temps. Notez que l‚Äôon peut passer directement le code HTML dans l‚Äôattribut &lt;code class="highlighter-rouge"&gt;srcdoc&lt;/code&gt; d‚Äôune iframe. Pour communiquer avec l‚Äôiframe il faut passer par un envoi de message, et cot√© iframe il faut penser √† contr√¥ler l‚Äôorigine des messages.&lt;/p&gt;&lt;div class="language-javascript highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;iframe&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;HTMLIFrameElement&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getElememtById&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'myIFrame'&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="nx"&gt;iframe&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;contentWindow&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;postMessage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'The message'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'*'&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;div class="language-javascript highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;that&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nb"&gt;window&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;addEventListener&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'message'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;event&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;event&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;origin&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="s1"&gt;'http://localhost:4200'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;that&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;event&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="p"&gt;});&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Aujourd‚Äôhui, tous les navigateurs supportent les iframes sandbox√©es.&lt;/p&gt;&lt;p&gt;Pour information, il sera √† DevoxxFR en Avril cette ann√©e, ne manquez pas sa conf√©rence ‚ÄòBuilding Secure Angular Applicatons‚Äô.&lt;/p&gt;&lt;h3 id="coffee-break"&gt;Coffee Break&lt;/h3&gt;&lt;p&gt;Une petite pause d‚Äô1h pour faire le plein d‚Äô√©nergie, et entamer la r√©daction de ce post.&lt;/p&gt;&lt;h3 id="patterns"&gt;Patterns&lt;/h3&gt;&lt;p&gt;Je reprends avec la pr√©sentation de &lt;a href="https://twitter.com/valorkin"&gt;Dmitriy Shekhovtsov&lt;/a&gt; qui nous parle des patterns dans Angular, en particulier sur l‚Äôinjection de d√©pendances. Les sujets abord√©s sont : l‚Äôinjection de d√©pendances, les injecteurs, les ServiceLocators, les modules, ‚Ä¶&lt;/p&gt;&lt;p&gt;D√©sol√©, mais je n‚Äôai ni les slides, ni pris de photos pour vous faire une retranscription sans b√™tises, donc je vais m‚Äôabstenir.&lt;/p&gt;&lt;h3 id="rxjs-everything-is-a-stream"&gt;RxJS everything is a stream&lt;/h3&gt;&lt;p&gt;L‚Äôavant-derni√®re pr√©sentation de la journ√©e concernent RxJS, en effet la programmation r√©active est de plus en plus pr√©sente, et Angular s‚Äôadapte parfaitement √† cette fa√ßon de d√©velopper.&lt;/p&gt;&lt;p&gt;En 1/2 heure &lt;a href="https://twitter.com/chris_noring"&gt;Christoffer Noring&lt;/a&gt; nous explique ce qui est int√©ressant avec RxJS par rapport aux callbacks, aux Promises, et aux api de Array. Ensuite, il parcours certains des op√©rateurs comme &lt;code class="highlighter-rouge"&gt;map&lt;/code&gt;, &lt;code class="highlighter-rouge"&gt;debounce&lt;/code&gt;, &lt;code class="highlighter-rouge"&gt;switchMap&lt;/code&gt;, &lt;code class="highlighter-rouge"&gt;flatMap&lt;/code&gt;, ‚Ä¶ Quelques exemples sur l‚Äôautocompl√©tion ou le retry sont parfaits pour montrer la puissance du concept.&lt;/p&gt;&lt;p&gt;Vous retrouverez ses slides ici: &lt;a href="http://www.slideshare.net/ChristofferNoring/rxjs-ngvikings"&gt;http://www.slideshare.net/ChristofferNoring/rxjs-ngvikings&lt;/a&gt;. La pr√©sentation allait super vite, heureusement que j‚Äô√©tais d√©j√† assez √† l‚Äôaise avec ces concepts. Christoffer est un tr√©s bon speaker.&lt;/p&gt;&lt;h3 id="webpack"&gt;Webpack&lt;/h3&gt;&lt;p&gt;Je finis par la pr√©sentation de &lt;a href="https://twitter.com/TheLarkInn"&gt;Sean Larkinn&lt;/a&gt;, le mainteneur principal de &lt;a href="www.monkeytechdays.com/"&gt;webpack&lt;/a&gt;. Dans cette pr√©sentation, il nous parle nous pr√©sente bien sur Webpack en parcourant les concepts principaux :&lt;/p&gt;&lt;ul&gt; &lt;li&gt;Entry: c‚Äôest le premier fichier JavaScript qui d√©marre l‚Äôapplication (ce qu‚Äôil faut charger). Les &lt;code class="highlighter-rouge"&gt;import&lt;/code&gt; (ES6 ou TypeScript) ou les &lt;code class="highlighter-rouge"&gt;require&lt;/code&gt; permettent de d√©finir le graphe des d√©pendances.&lt;/li&gt; &lt;li&gt;Output: c‚Äôest le r√©sultat du bundeling (ou et comment), il est en relation avec l‚Äôentr√©e.&lt;/li&gt; &lt;li&gt;Loaders: d√©crivent comment Webpack doit traiter les fichiers. √áa correspond √† une fonction qui prend en entr√©e un fichier source et retourne un √©tat modifi√© (charg√©). Le cas typique des transpileurs (TypeScript, Babel). Pour ajouter un loader il faut configurer une expression r√©guli√®re de test (ce qui doit passer dans le loader), son nom (&lt;code class="highlighter-rouge"&gt;ts-loader&lt;/code&gt; -&amp;gt; le nom est ‚Äòts‚Äô) ou une liste de noms (enchainement de loader).&lt;/li&gt; &lt;li&gt;Plugins: tout ce que ne fait pas un loader. En gros on peut faire ce qu‚Äôon veut a une √©tape de compilation. On se branche sur les √©v√©nements du compilateur. En fait ~ 80% de Webpack est en fait des plugins.&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;Pour faire simple, Entry = What, Output = Where, Loaders = How, Plugins = ü¶Ñ.&lt;/p&gt;&lt;p&gt;Aujourd‚Äôhui webpack est devenu indispensable dans les outils de build web, y compris pour autre chose que les applications Angular (angular-cli est bas√© sur webpack). Il en profite pour faire un appel √† la communaut√© pour que l‚Äôavenir de webpack soit radieux.&lt;/p&gt;&lt;p&gt;De mon c√¥t√© il y a quelques ann√©es, j‚Äôavais accueilli avec septisisme l‚Äôarriv√© de webpack dans l‚Äô√©cosyst√®me des outils de build. En fait il ne fallait pas le voir comme √©tant un outil d‚Äôex√©cution de t√¢ches comme le sont par exemple grunt ou gulp, il faut le voir comme √©tant un bundler (qui peut d‚Äôailleurs √™tre lanc√© par gulp).&lt;/p&gt;&lt;p&gt;Aujourd‚Äôhui, je vois beaucoup mieux son int√©r√™t, en particuliers pour r√©soudre les fonctionnalit√©s comme l‚ÄôAOT. Webpack 2 est actuellement la meilleure solution pour le packaging des applications, et je vais devoir m‚Äôy mettre s√©rieusement, cette pr√©sentation arrive √† point nomm√© pour moi.&lt;/p&gt;&lt;p&gt;Sean est un super speaker, la p√™che qu‚Äôil a est communicative, et c‚Äôest agr√©able pour une audience et des micros qui fatiguent apr√®s une longue journ√©e. Sa pr√©sentation montre que Webpack est bas√© sur des concepts simples.&lt;/p&gt;&lt;h3 id="outro--soir√©e"&gt;Outro &amp;amp; soir√©e&lt;/h3&gt;&lt;p&gt;Une petite conclusion est faite par les organisateurs, c‚Äôest le moment de nous expliquer comment se continue la soir√©e: dans les goodies, nous avons deux pi√®ces qui nous permettent de prendre une boisson au bar de l‚Äôuniversit√©, un DJ est l√† pour mettre l‚Äôambiance, et bien s√ªr, un buffet permet de se restaurer.&lt;/p&gt;&lt;p&gt;C‚Äôest aussi l‚Äôoccasion d‚Äô√©changer avec des participants ou des speakers, vous savez d√©j√† que je pense que rien que pour ces √©changes √ßa vaut le coup d‚Äôaller dans des conf√©rences. On en profite aussi pour faire les photos avec les costumes de Vikings (s√©rieux s‚Äôabstenir), mais je pr√©f√®re ne pas trop tarder, car la conf√©rence n‚Äôest pas termin√©e pour moi.&lt;/p&gt;&lt;p&gt;&lt;a href="/public/images/ngVikings17/coin.png"&gt;Coin&lt;/a&gt;&lt;/p&gt;&lt;h2 id="jour-2---workshop-day"&gt;Jour 2 - Workshop day&lt;/h2&gt;&lt;p&gt;Le second jour est d√©di√© aux workshops, il fallait faire un choix en avance, j‚Äôai opt√© pour ‚ÄòAdvanced Angular‚Äô mais il y avait six autres sujets. C‚Äôest &lt;a href="https://twitter.com/manfredsteyer"&gt;Manfred Steyer&lt;/a&gt; qui anime cette session. La premi√®re partie correspond √† des slides sur la th√©orie et du live-coding pour mettre en application, la seconde partie correspond au lab: c‚Äôest nous qui faisons.&lt;/p&gt;&lt;p&gt;Je pense qu‚Äôil n‚Äôy a pas de meilleure fa√ßon d‚Äôapprendre que de pratiquer (c‚Äôest ce qui est d‚Äôailleurs √† l‚Äôorigine des &lt;a href="www.monkeytechdays.com/"&gt;MonkeyTechDay&lt;/a&gt;).&lt;/p&gt;&lt;p&gt;On travaille sur une application qui est bas√©e sur &lt;a href="https://github.com/AngularClass/angular2-webpack-starter"&gt;angular seed&lt;/a&gt;, mais √ßa peut aussi √™tre appliqu√© sur les applications initialis√©es par angular-cli. Vous trouverez une mise en pratique des concepts que l‚Äôon va voir dans le d√©p√¥t suivant : &lt;a href="https://github.com/manfredsteyer/AdvAngular.git"&gt;https://github.com/manfredsteyer/AdvAngular.git&lt;/a&gt;.&lt;/p&gt;&lt;h3 id="part-i---lazy-loading"&gt;Part I - lazy loading&lt;/h3&gt;&lt;p&gt;La premi√®re partie correspond en gros √† la pr√©sentation que Manfred avait fait la veille.&lt;/p&gt;&lt;p&gt;Avant de se lancer dans l‚Äôaspect lazy loading, on fait un rapide point sur la capacit√© d‚Äôavoir des routes auxiliaires. Rien de tr√®s compliqu√© : on peut nommer les outlets, et brancher des composants dedans. C‚Äôest pratique pour des popups, des modals, des zones autonomes dans les applications, ou bien encore si on fait une application du style ‚ÄòNotorn Commander‚Äô.&lt;/p&gt;&lt;p&gt;Une application classique en Angular va √™tre constitu√©e d‚Äôun module principal AppModule, de features modules et d‚Äôun SharedModule.&lt;/p&gt;&lt;p&gt;Il va √™tre int√©ressant de charger les modules de features les moins utilis√©s de fa√ßon paresseuse. Pour cela il faut que l‚Äôoutillage supporte ce m√©canisme, ce qui est le cas des projets g√©n√©r√©s par la cli ou angular-seed. En gros c‚Äôest le plugin &lt;code class="highlighter-rouge"&gt;angular2-router-loader&lt;/code&gt; qui fait le boulot.&lt;/p&gt;&lt;p&gt;Avant d‚Äôaller plus loin, une petite astuce tout simple pour d√©bugger les routes sous Angular, dans notre module de route, on peut activer les logs comme ceci :&lt;/p&gt;&lt;div class="language-typescript highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="nx"&gt;NgModule&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt; &lt;span class="na"&gt;imports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;RouterModule&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;forRoot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;routes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="na"&gt;enableTracing&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;})],&lt;/span&gt; &lt;span class="na"&gt;exports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;RouterModule&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="na"&gt;providers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt; &lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="k"&gt;export&lt;/span&gt; &lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;AppRoutingModule&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Ceci va nous permettre d‚Äôavoir les informations suivantes :&lt;/p&gt;&lt;p&gt;&lt;img src="/public/images/ngVikings17/route-log.png" alt="Route Logging" /&gt;&lt;/p&gt;&lt;p&gt;Comment active-t-on le lazy loading ? C‚Äôest au niveau des routes que l‚Äôon va le plus travailler, mais avant cela, la premi√®re √©tape c‚Äôest de retirer notre module des imports de AppModule, ‚Ä¶ Ensuite, on va associer notre module √† une route particuli√®re et d√©finir le chemin du module correspondant.&lt;/p&gt;&lt;div class="language-javascript highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nl"&gt;path&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'lazy'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;loadChildren&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'./modules/lazy/lazy.module.ts#LazyModule'&lt;/span&gt; &lt;span class="c1"&gt;// trigger lazy-loading&lt;/span&gt; &lt;span class="p"&gt;},&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Puis les sous routes de notre composant seront automatiquement pr√©fix√©e par le chemin de notre module.&lt;/p&gt;&lt;p&gt;Pour v√©rifier que l‚Äôon a bien un chargement paresseux, il suffit de voir les √©l√©ments g√©n√©r√©s par webpack, et regarder leur chargement dans le navigateur.&lt;/p&gt;&lt;p&gt;&lt;img src="/public/images/ngVikings17/lazy-module.png" alt="Lazy Module" /&gt; &lt;img src="/public/images/ngVikings17/lazy-network.png" alt="Lazy Loading" /&gt;&lt;/p&gt;&lt;p&gt;Autre point √©tudi√© dans cette partie : le pr√©-chargement. En effet, c‚Äôest bien d‚Äôacc√©l√©rer le rendu de la premi√®re page, mais ensuite si on peut charger le reste des modules avant que l‚Äôutilisateur en ait besoin, c‚Äôest mieux. Pour cela, on peut utiliser le ‚ÄòpreloadingStrategy‚Äô :&lt;/p&gt;&lt;div class="language-typescript highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="nx"&gt;NgModule&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt; &lt;span class="na"&gt;imports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;RouterModule&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;forRoot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;routes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="na"&gt;preloadingStrategy&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;PreloadAllModules&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="na"&gt;enableTracing&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt; &lt;span class="p"&gt;})],&lt;/span&gt; &lt;span class="na"&gt;exports&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;RouterModule&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="na"&gt;providers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt; &lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="k"&gt;export&lt;/span&gt; &lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;AppRoutingModule&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Ici le &lt;code class="highlighter-rouge"&gt;PreloadAllModules&lt;/code&gt; vient de &lt;code class="highlighter-rouge"&gt;@angular/router&lt;/code&gt;, il va automatiquement charger les lazy-modules apr√®s le d√©marrage de l‚Äôapplication. On peut bien s√ªr √©crire notre propre preloader, par exemple:&lt;/p&gt;&lt;div class="language-typescript highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;PreloadingStrategy&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;Route&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;from&lt;/span&gt; &lt;span class="s2"&gt;"@angular/router"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;import&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;Observable&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;from&lt;/span&gt; &lt;span class="s2"&gt;"rxjs/Observable"&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="k"&gt;export&lt;/span&gt; &lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;CustomPreloadingStrategy&lt;/span&gt; &lt;span class="k"&gt;implements&lt;/span&gt; &lt;span class="nx"&gt;PreloadingStrategy&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;preload&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;route&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;Route&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;fn&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;Observable&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kr"&gt;any&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;Observable&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="kr"&gt;any&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;route&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nx"&gt;route&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'preload'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="c1"&gt;// si le module a un data: {preload:true}&lt;/span&gt; &lt;span class="kd"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;_1s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;Observable&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;of&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;delay&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;_1s&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;flatMap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;fn&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt; &lt;span class="c1"&gt;// on le charge avec un delai de 1s&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;Observable&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;of&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Attention, on peut avoir de mauvaises surprises quand on active le lazy-loading des modules. En effet, les services d√©finis dans le SharedModule seront √† nouveau cr√©√©s pour le module lazy au moment du chargement. Pour cela, on peut utiliser le pattern de &lt;a href="https://angular.io/docs/ts/latest/guide/ngmodule.html#!#core-module"&gt;CoreModule&lt;/a&gt;, ou bien plus simplement exposer le SharedModule soit avec les services, soit sans les services.&lt;/p&gt;&lt;div class="language-typescript highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="nx"&gt;NgModule&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt; &lt;span class="c1"&gt;// ...&lt;/span&gt; &lt;span class="na"&gt;providers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt; &lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="k"&gt;export&lt;/span&gt; &lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;SharedModule&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="nx"&gt;forRoot&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;ModuleWithProviders&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="na"&gt;ngModule&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;SharedModule&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="na"&gt;providers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;XService&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;YService&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...]&lt;/span&gt; &lt;span class="p"&gt;};&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Ces fonctionnalit√©s sont tr√®s puissantes, par contre on peut vite tomber dans le pi√®ge, et il y a beaucoup de boilerplate autour des modules je trouve. Heureusement qu‚Äôangular-cli est l√†. Si vous avez encore du mal avec les modules vous pouvez regarder ceci: &lt;a href="http://blog.angular-university.io/angular2-ngmodule/"&gt;http://blog.angular-university.io/angular2-ngmodule/&lt;/a&gt;&lt;/p&gt;&lt;h3 id="part-ii---performance-aot-onpush"&gt;Part II - Performance: AOT, OnPush&lt;/h3&gt;&lt;p&gt;On fait le point sur la compilation AOT, bonne nouvelle c‚Äôest activ√© par d√©faut dans le &lt;code class="highlighter-rouge"&gt;ng build -prod&lt;/code&gt; avec angular-cli on angular-seed (NgcWebpackPlugin). Pour rappel le principe est de compiler les templates angular en JavaScript, ce qui permet de gagner du temps dans le navigateur, et aussi de retirer la partie compilateur de Angular lors de la construction des packages. Autre point qui est encore jeune : le tree-shaking, ou la capaciter de retirer les branches non utilis√©s dans le code pour al√©ger les packages. On peut attendre beaucoup d‚Äôam√©liorations de ce c√¥t√© dans le futur.&lt;/p&gt;&lt;p&gt;Attention, il est important d‚Äôavoir du code d√©fini avec des modules ES6. C‚Äôest important pour les biblioth√®ques que l‚Äôon va charger. Quelques remarques suppl√©mentaires :&lt;/p&gt;&lt;ul&gt; &lt;li&gt;la compilation AOT est plus stricte, on peut avoir des erreurs de compilation remont√©es √† cette √©tape.&lt;/li&gt; &lt;li&gt;le d√©marrage de l‚Äôapplication est grandement am√©lior√©&lt;/li&gt; &lt;li&gt;les tailles ne sont pas toujours plus petites (on ajoute du JavaScript correspondant aux templates)&lt;/li&gt; &lt;li&gt;√† utiliser uniquement en production&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;Autre point abord√© la strat√©gie de mise √† jour &lt;code class="highlighter-rouge"&gt;onPush&lt;/code&gt;. Dans le mode par d√©faut angular tranverse l‚Äôarbre des composants pour mettre √† jour l‚Äôapplication. Avec la strat√©gie &lt;code class="highlighter-rouge"&gt;onPush&lt;/code&gt;, une comparaison par r√©f√©rence des &lt;code class="highlighter-rouge"&gt;@input&lt;/code&gt; des composants va √™tre faite pour savoir si on traite le composant. Donc dans le cas d‚Äôune modification d‚Äôun seul √©l√©ment de tableau on peut optimiser le rafraichissement.&lt;/p&gt;&lt;p&gt;Pour activer ce comportement :&lt;/p&gt;&lt;div class="language-typescript highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="nx"&gt;Component&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt; &lt;span class="na"&gt;selector&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'my-cmp'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="na"&gt;templateUrl&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'./cmp.component.html'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="na"&gt;changeDetection&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;ChangeDetectionStrategy&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;OnPush&lt;/span&gt; &lt;span class="c1"&gt;// Stat√©gie OnPush&lt;/span&gt; &lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="k"&gt;export&lt;/span&gt; &lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;CmpComponent&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="nx"&gt;Input&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="c1"&gt;// ...&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Pour notifier d‚Äôun changement, il faut donc un nouveau ‚Äòdata‚Äô en entr√©e. On peut utiliser une librairie comme &lt;a href="https://facebook.github.io/immutable-js/"&gt;immutable.js&lt;/a&gt; ou bien faire cela tout simplement en TypeScript.&lt;/p&gt;&lt;p&gt;Note: les op√©rations de d√©constructions sont tr√®s utiles ici : &lt;code class="highlighter-rouge"&gt;const newData = {...oldData, newValue: 'plop'}&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Dans le cas des &lt;code class="highlighter-rouge"&gt;Observable&lt;/code&gt; utilis√©s avec le pipe &lt;code class="highlighter-rouge"&gt;async&lt;/code&gt;, il faudra donc passer par des &lt;code class="highlighter-rouge"&gt;Subject&amp;lt;T&amp;gt;&lt;/code&gt; et faire des &lt;code class="highlighter-rouge"&gt;next(t)&lt;/code&gt; pour d√©clancher les mises √† jour.&lt;/p&gt;&lt;h3 id="part-iii---i18n"&gt;Part III - i18n&lt;/h3&gt;&lt;p&gt;Dans cette partie, on √©tudie les aspects internationalisation, deux solutions sont √©tudi√©es. La premi√®re est bas√©e sur le compilateur qui offre de bonnes performances, mais les fichiers de traductions sont compliqu√©s √† maintenir, et cela oblige de g√©n√©rer une application pour chaque langage support√©.&lt;/p&gt;&lt;p&gt;L‚Äôautre solution que je vais d√©tailler utilise &lt;a href="https://github.com/ocombe/ng2-translate"&gt;ng2-translate&lt;/a&gt;, le portage du module qui √©tait pl√©bicit√© pour traiter ce sujet en AngularJS.&lt;/p&gt;&lt;p&gt;Apr√®s avoir ajout√© la d√©pendance npm &lt;code class="highlighter-rouge"&gt;ng2-translate&lt;/code&gt;, il faut importer un module que l‚Äôon va construire avec un &lt;code class="highlighter-rouge"&gt;TranslateLoader&lt;/code&gt; :&lt;/p&gt;&lt;div class="language-typescript highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="c1"&gt;// Module to import&lt;/span&gt; &lt;span class="nx"&gt;TranslateModule&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;forRoot&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt; &lt;span class="na"&gt;provide&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;TranslateLoader&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="na"&gt;useFactory&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;http&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nx"&gt;TranslateStaticLoader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;http&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'./i18n'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'.json'&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="na"&gt;deps&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;Http&lt;/span&gt;&lt;span class="p"&gt;]}&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Ensuite on configure le &lt;code class="highlighter-rouge"&gt;TranslateService&lt;/code&gt; :&lt;/p&gt;&lt;div class="language-typescript highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="k"&gt;private&lt;/span&gt; &lt;span class="nx"&gt;initNgTranslate&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;translate&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;addLangs&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s1"&gt;'en'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'fr'&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;translate&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;setDefaultLang&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'navigator.language || navigator.userLanguage'&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;// Pour avoir la langue par d√©faut du navigateur&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;translate&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;use&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'fr'&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;On va ensuite cr√©er les fichiers JSON contenant les traductions dans &lt;code class="highlighter-rouge"&gt;i18n/fr.json&lt;/code&gt; et &lt;code class="highlighter-rouge"&gt;i18n/en.json&lt;/code&gt;. Puis il suffit d‚Äôutiliser &lt;code class="highlighter-rouge"&gt;ma.clef | translate&lt;/code&gt; pour avoir la version internationalis√©e.&lt;/p&gt;&lt;p&gt;Enfin pour changer de langue, on pourra faire :&lt;/p&gt;&lt;div class="language-html highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt; &lt;span class="nt"&gt;&amp;lt;button&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;"btn btn-default"&lt;/span&gt; &lt;span class="err"&gt;(&lt;/span&gt;&lt;span class="na"&gt;click&lt;/span&gt;&lt;span class="err"&gt;)="&lt;/span&gt;&lt;span class="na"&gt;setLang&lt;/span&gt;&lt;span class="err"&gt;('&lt;/span&gt;&lt;span class="na"&gt;en&lt;/span&gt;&lt;span class="err"&gt;')"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;üá¨üáß&lt;span class="nt"&gt;&amp;lt;/button&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;button&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;"btn btn-default"&lt;/span&gt; &lt;span class="err"&gt;(&lt;/span&gt;&lt;span class="na"&gt;click&lt;/span&gt;&lt;span class="err"&gt;)="&lt;/span&gt;&lt;span class="na"&gt;setLang&lt;/span&gt;&lt;span class="err"&gt;('&lt;/span&gt;&lt;span class="na"&gt;fr&lt;/span&gt;&lt;span class="err"&gt;')"&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;üá´üá∑&lt;span class="nt"&gt;&amp;lt;/button&amp;gt;&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;div class="language-typescript highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt; &lt;span class="k"&gt;public&lt;/span&gt; &lt;span class="nx"&gt;setLang&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;lang&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt; &lt;span class="kr"&gt;string&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;translateService&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;use&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;lang&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;h3 id="part-iv---authentification"&gt;Part IV - authentification&lt;/h3&gt;&lt;p&gt;La derni√®re partie correspond aux aspects authentification, on parle de JWT de OAuth de &lt;a href="http://openid.net/connect/"&gt;OIDC (OpenId Connect)&lt;/a&gt;. En gros, on voit comment on peut utiliser &lt;a href="https://github.com/manfredsteyer/angular-oauth2-oidc"&gt;angular-oauth2-oidc&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Le sujet de l‚Äôauthentification est vaste, et tr√®s li√© au SI de mes clients, je ne me suis donc pas trop concentr√© sur cette partie.&lt;/p&gt;&lt;h2 id="conclusion"&gt;Conclusion&lt;/h2&gt;&lt;p&gt;Mes attentes ont √©t√© combl√©es lors de ce WE danois. Apr√®s cette conf√©rence, je vois bien que la plateforme est aujourd‚Äôhui mature, et que l‚Äô√©cosyst√®me est aujourd‚Äôhui suffisamment stable pour que l‚Äôon d√©marre des projets Angular y compris dans des soci√©t√©s qui sont plus conservatrices dans leurs choix techniques.&lt;/p&gt;&lt;p&gt;J‚Äôaime beaucoup l‚Äôid√©e d‚Äôun jour sp√©cifique pour faire un workshop, cela m‚Äôa vraiment permis de prendre du recul sur Angular, et de me sentir plus √† l‚Äôaise avec des concepts avanc√©s. C‚Äôest avec beaucoup de confiance que je vais aborder mes prochains projets en Angular.&lt;/p&gt;&lt;p&gt;Bravo pour les organisateurs, les sponsors, les speakers, et tous les gens qui rendent ce genre d‚Äô√©v√®nement possible. Il faut bien s√ªr que je rajoute √† cette liste &lt;a href="https://twitter.com/angulartoulouse"&gt;@angularToulouse&lt;/a&gt; et &lt;a href="http://www.monkeypatch.io/"&gt;MonkeyPatch&lt;/a&gt; sans qui je n‚Äôy serais pas all√©, et aux relecteurs/correcteurs de ce post.&lt;/p&gt;&lt;p&gt;Enfin j‚Äôai eu l‚Äôoccasion de discuter avec plein de d√©veloppeurs (speaker) passionn√©s, il y avait une super ambiance, la communaut√© Angular est vraiment g√©niale. Vivement l‚Äôan prochain !&lt;/p&gt;&lt;p&gt;Vous retrouverez les vid√©os ici: &lt;a href="https://ngvikings.org/schedule/day1"&gt;https://ngvikings.org/schedule/day1&lt;/a&gt;, et d‚Äôautres retours :&lt;/p&gt;&lt;p&gt;&lt;a href="http://jsdiaries.com/2017/02/20/angular-ngvikings-2017/"&gt;http://jsdiaries.com/2017/02/20/angular-ngvikings-2017/&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://home.lundogbendsen.dk/ngvikings-angular-conference-2017/"&gt;https://home.lundogbendsen.dk/ngvikings-angular-conference-2017/&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href="https://blog.jayway.com/2017/02/16/conference-report-ngvikings-2017/"&gt;https://blog.jayway.com/2017/02/16/conference-report-ngvikings-2017/&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Note: vous avez les liens vers les slides qui manquent, ou tout simplement des remarques, utilisez les commentaires pour compl√©ter ce post‚Ä¶&lt;/p&gt;&lt;h2 id="quelques-photos-pour-finir"&gt;Quelques photos pour finir&lt;/h2&gt;&lt;p&gt;L‚Äôuniversit√© IT de Copenhague :&lt;/p&gt;&lt;p&gt;&lt;img src="/public/images/ngVikings17/venue.png" alt="Venue" /&gt;&lt;/p&gt;&lt;p&gt;Apprenti vikings (peu convaincant) :&lt;/p&gt;&lt;p&gt;&lt;img src="/public/images/ngVikings17/Yarrrgh.jpg" alt="Yarrrgh" /&gt;&lt;/p&gt;&lt;p&gt;Salle pour discuter avec les speakers :&lt;/p&gt;&lt;p&gt;&lt;img src="/public/images/ngVikings17/speakers-room.png" alt="Speaker room" /&gt;&lt;/p&gt;&lt;p&gt;On peut manger des tapas √† Copenhague :&lt;/p&gt;&lt;p&gt;&lt;img src="/public/images/ngVikings17/tapas.png" alt="Tapas" /&gt;&lt;/p&gt;&lt;p&gt;Beaucoup de s√©rieux dans l‚Äôorganisation :&lt;/p&gt;&lt;p&gt;&lt;img src="/public/images/ngVikings17/organisateurs.png" alt="Organisateurs" /&gt;&lt;/p&gt;&lt;p&gt;Il fait un peu plus froid qu‚Äôa Toulouse :&lt;/p&gt;&lt;p&gt;&lt;img src="/public/images/ngVikings17/climat.png" alt="Climat" /&gt;&lt;/p&gt;</content> <author> <name>Igor Laborie</name> <email>igor@monkeypatch.io</email> </author> <category term="ngVikings"/> <category term="Angular"/> <category term="WebSecurity"/> <category term="RxJS"/> <summary>Introduction√Ä peine remis du MonkeyTechDay #3: Reactive Streams coach√© par @sdeleuze, je prends l‚Äôavion direction Copenhague pour assister √† la premi√®re √©dition de ngVikings.Pour un retour sur le MKTD, voir le retour de Maxime#Stereotype, Au Danemark il fait plus froid qu‚Äô√† Toulouse, il y a des Lego, des Carlseberg, et une sir√®ne.J‚Äôai plut√¥t l‚Äôhabitude de participer √† des conf√©rences assez g√©n√©ralistes, mais l√†, je vais faire deux jours int√©gralement sur du Angular (comprendre Angular 2+ pour ceux qui ne font pas encore la diff√©rence entre AngularJs et ‚ÄòJust Angular‚Äô).C‚Äôest pour moi l‚Äôoccasion d‚Äôapprofondir le sujet, de voir l‚Äô√©cosyst√®me, et de rencontrer des d√©veloppeurs passionn√©s par ce sujet.Je constate que certains ‚Äògrands comptes‚Äô Toulousains font un premier pas vers Angular sur leurs nouveaux projets, c‚Äôest donc le moment id√©al pour moi d‚Äôaller plus loin sur le sujet.</summary> <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://ngvikings.org/images/backgrounds/2017.jpg"/> </entry> <entry xml:lang="fr"><title>Devoxx Belgium</title><link href="http://www.monkeypatch.io/2016/11/27/Devoxx-Belgium.html" rel="alternate" type="text/html" title="Devoxx Belgium"/> <published>2016-11-27T00:00:00+01:00</published> <updated>2016-11-27T00:00:00+01:00</updated><id>http://www.monkeypatch.io/2016/11/27/Devoxx-Belgium</id> <content type="html" xml:base="http://www.monkeypatch.io/2016/11/27/Devoxx-Belgium.html">&lt;h2 id="welcome-to-antwerp-anvers"&gt;Welcome to Antwerp (Anvers)&lt;/h2&gt;&lt;p&gt;A peine remis du &lt;a href="https://devfesttoulouse.fr/"&gt;DevFest Toulouse&lt;/a&gt;, je pars une semaine en Belgique pour aller √† &lt;a href="https://devoxx.be/"&gt;Devoxx&lt;/a&gt;. Pour ceux qui ne connaissent pas encore Devoxx, c‚Äôest une conf√©rence ind√©pendante : elle n‚Äôest organis√©e ni par Google ni par Oracle. Cela dit ils √©taient pr√©sent en temps que sponsors et speakers. C‚Äôest la plus grosse conf√©rence auquel j‚Äôai assist√© (3500 d√©veloppeurs), c‚Äôest pas tous les jours qu‚Äôon a l‚Äôoccasion de croiser des &lt;a href="http://cfp.devoxx.be/2016/speaker/brian_goetz"&gt;Brian Goetz&lt;/a&gt;, &lt;a href="http://cfp.devoxx.be/2016/speaker/venkat_subramaniam"&gt;Venkat Subramaniam&lt;/a&gt;, ‚Ä¶ en Europe. &lt;!--more--&gt;&lt;/p&gt;&lt;p&gt;Devoxx Belgique c‚Äôest aussi un peu la m√®re de toutes les conf√©rences Devoxx et Voxxed qui se sont cr√©√©es ces derni√®res ann√©es (France, Maroc, US, Pologne, ‚Ä¶). C‚Äôest aussi la bataille des buzzwords, a votre avis qui est le perdant parmis: Docker, MicroServices, JEE, Programation Reactive ?&lt;/p&gt;&lt;p&gt;La conf√©rence a lieu dans un complexe cin√©ma, on a donc des grandes salles, les √©crans qui vont avec, et des fauteuils super confortables. Cot√© boissons les soda, jus d‚Äôorange, ‚Ä¶ sont open-bar; du coup il y a la queue aux toilettes. Les repas ne sont pas terribles (sandwich bof), c‚Äôest sur qu‚Äôen France les conf√©rences sont particuli√®rement attentive aux repas; a not√© tout de m√™me la soir√©e bi√®res-frites, un moment parfais pour d‚Äô√©chang√© sur des th√®mes divers (Merci Pivotal pour les bi√®res). On aura aussi le droit √† une s√©ance de cin√© pour aller voir ‚ÄúSnowden‚Äù, s√©ance que j‚Äôai esquiv√© pour aller manger en ville avec quelques Toulousaing.&lt;/p&gt;&lt;p&gt;Chose g√©nial, les vid√©os sont upload√©s sur Youtube d√®s le lendemain, vous pouvez donc les trouv√©es sur &lt;a href="https://www.youtube.com/playlist?list=PLRsbF2sD7JVq_TvmCyJC3-oT9nBGdwq6s"&gt;Youtube&lt;/a&gt;. Par exemple vous avez une playlist avec les &lt;a href="https://www.youtube.com/playlist?list=PLRsbF2sD7JVrP_MJaOWvaK9-OTNX2oFwB"&gt;pr√©sentations les mieux not√©es&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Ici c‚Äôest impossible de vous faire un compte rendu d√©taill√© de toutes les conf√©rences auxquelles j‚Äôai assist√©, donc je vais juste d√©tailler quelques th√©matiques que j‚Äôai particuli√®rement suivies.&lt;/p&gt;&lt;h2 id="java-maintenant"&gt;Java maintenant&lt;/h2&gt;&lt;p&gt;Lors de plusieurs conf√©rences il y a eu des sondages √† main lever pour savoir quelle version du JDK √©tait utilis√©e, presque tout le monde est sur Java 8, ceux qui sont en dessous sont souvent li√© √† Android, cela dit on peu combler une partie du d√©ficit avec &lt;a href="https://github.com/orfjackal/retrolambda"&gt;RetroLambda&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;La version 8 du langage apporte une touche de programmation fonctionnelle dans Java, ce qui ouvrent de nouvelles portes. J‚Äôencourage fortement les √©quipes de d√©veloppeurs √† se poser la question : ‚ÄòComment ferait-on √ßa proprement √† la mode Java 8 ?‚Äô pendant leurs phases de conceptions, refactoring et dans les revues de codes.&lt;/p&gt;&lt;p&gt;Aujourd‚Äôhui les designs patterns classiques (GoF par ex.) sont g√©n√©ralement obsol√®tes avec l‚Äôarriv√© de cette nouvelle fa√ßon de d√©velopper, on y gagne tellement en terme de lisibilit√©, compacit√©, maintenabilit√©, testabilit√©. Attention toutefois √† faire au maximum des fonctions pures (sans effet de bords).&lt;/p&gt;&lt;p&gt;Cela dit il y a encore une lourdeurs ou certains manques dans les API (e.g. il manque les tuples, &lt;code class="highlighter-rouge"&gt;flatMap&lt;/code&gt; et &lt;code class="highlighter-rouge"&gt;Optional&lt;/code&gt;), et on peut esp√©rer que ces points soit am√©lior√©s dans le futures (voir plus bas).&lt;/p&gt;&lt;p&gt;Voici quelques pr√©sentations int√©ressantes:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;&lt;a href="https://www.youtube.com/watch?v=Rmer37g9AZM"&gt;g‚àòf patterns (Mario Fusco)&lt;/a&gt; : une revisite des patterns du GoF √† l‚Äôaune des lambas et des &lt;code class="highlighter-rouge"&gt;@FunctionalInterface&lt;/code&gt;.&lt;/li&gt; &lt;li&gt;&lt;a href="https://www.youtube.com/watch?v=Ej0sss6cq14"&gt;Optional - The Mother of All Bikesheds (Stuart Marks)&lt;/a&gt;: un point sur cette classe controvers√© du JDK. La bonne nouvelle on va pouvoir faire du &lt;code class="highlighter-rouge"&gt;flatMap&lt;/code&gt; plus facilement avec les &lt;code class="highlighter-rouge"&gt;Optional&lt;/code&gt; dans le JDK 9.&lt;/li&gt; &lt;li&gt;&lt;a href="https://www.youtube.com/watch?v=b8YX45ymAeE"&gt;Java Collections: The Force Awakens (Raoul-Gabriel Urma and Richard Warburton)&lt;/a&gt; : un point sur les collections en Java. C‚Äôest une excellente r√©vision sur cette API indispensable √† maitriser.&lt;/li&gt; &lt;li&gt;&lt;a href="https://www.youtube.com/watch?v=NcetKbGayZY&amp;amp;index=7&amp;amp;list=PLRsbF2sD7JVrP_MJaOWvaK9-OTNX2oFwB"&gt;Refactoring to Java 8 (Trisha Gee)&lt;/a&gt;: beaucoup d‚Äôexemple de refactoring, avec les impacts sur les performances.&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;Vous trouverez bien s√ªr d‚Äôautres pr√©sentations sur le sujet, par exemple il y a eu deux talks parlant de &lt;a href="http://www.javaslang.io/"&gt;JavaSlang&lt;/a&gt; qui porte beaucoup d‚Äô√©l√©ments de &lt;a href="http://www.scala-lang.org/"&gt;Scala&lt;/a&gt; dans Java comme par exemple le PatternMatching.&lt;/p&gt;&lt;p&gt;D‚Äôautres pr√©sentations sont plus dans l‚Äôesprit ‚ÄòBrainFucking‚Äô, je trouve √ßa amusant quand √ßa reste √† petite dose:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;&lt;a href="https://www.youtube.com/watch?v=bhSBpNXwa60"&gt;It‚Äôs Java Jim, But Not As We Know It (Simon Ritter)&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="https://www.youtube.com/watch?v=tSbK3A9QMmI"&gt;Lambda Puzzlers by Peter Lawrey&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt;&lt;h2 id="java-demain"&gt;Java demain&lt;/h2&gt;&lt;p&gt;Je me suis aussi beaucoup tournez vers les pr√©sentations qui parlaient de Java 9, et des √©ventuelles nouveaut√©s que l‚Äôon verra (peut-√™tre) dans les versions post√©rieurs du langage. Les architectes du langage qui avaient fait le d√©placement cette ann√©e, c‚Äôest toujours marrant de les voir se serr√©s sur une petite table au resto, alors qu‚Äôon avait profit√© de la grande (premier arriver, premier servie).&lt;/p&gt;&lt;p&gt;On a d‚Äôabort eu le droit d‚Äôune pr√©sentation de Java 9, ainsi que du projet &lt;a href="http://openjdk.java.net/projects/valhalla/"&gt;Valhalla&lt;/a&gt; et du projet &lt;a href="http://openjdk.java.net/projects/panama/"&gt;Panama&lt;/a&gt; lors de la Keynote d‚ÄôOracle, c‚Äôest un excellent r√©sum√© concernant le future de Java: &lt;a href="https://www.youtube.com/watch?v=e9eSPtpiGkA"&gt;Keynote Session (Mark Reinhold and Brian Goetz)&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;En gros il y a beaucoup de ‚Äòpetites‚Äô modifications internes dans Java 9, mais il y a surtout &lt;a href="http://openjdk.java.net/projects/jigsaw/"&gt;Jigsaw&lt;/a&gt; qui apporte la modularit√©. J‚Äôai √©vit√© ce sujet que j‚Äôavais d√©j√† pas mal suivit auparavant. Je pense que la modularit√© va apporter quelque chose d‚Äôindispensable en Java pour ne pas √™tre trop vite distanc√© par les nouveaux langages syst√®mes comme &lt;a href="http://swift.org/"&gt;Swift&lt;/a&gt; ou &lt;a href="https://www.rust-lang.org/fr/"&gt;Rust&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;J‚Äôai quand m√™me un peu peur que ce JDK prennent plus de temps que Java 8 √† √™tre adopter; l‚Äôavenir nous le dira. Maven est plut√¥t bon dans la compatibilit√© avec Java 9, c‚Äôest plut√¥t rassurant.&lt;/p&gt;&lt;p&gt;Autre nouveaut√© dans Java 9, l‚Äôarriv√©e d‚Äôun REPL: JShell. C‚Äôest assez int√©ressant, mais j‚Äôai tellement pris l‚Äôhabitude de m‚Äôen passer, qu‚Äôil va me falloir du temps pour trouver les usages au quotidien.&lt;/p&gt;&lt;p&gt;Je suis aussi aller voir la pr√©sentation sur le nouveau client HTTP/2 (JEP 110), l√† j‚Äôai √©t√© un peu d√©√ßu car il est possible que ce soit consid√©r√© en ‚Äòincubation‚Äô pour Java 9. J‚Äôesp√®re que nous aurons une bonne surprise. l‚Äôusage du &lt;code class="highlighter-rouge"&gt;CompletableFuture&lt;/code&gt; est bienvenue pour les aspects asynchrone.&lt;/p&gt;&lt;p&gt;Et apr√®s Java 9, que va t‚Äôil se passer ? Les speakers d‚ÄôOracle sont tr√®s prudents sur les nouveaut√©s qui sont pr√©sent√©es, il est tout √† fait possible qu‚Äôelles soient diff√©rentes voir abandonn√©es par la suite. Voici une liste de ceux qui pourraient arriv√© (on parle pour Java &amp;gt; 9):&lt;/p&gt;&lt;ul&gt; &lt;li&gt;Meilleur inf√©rence de type, on pourrait voir des chose comme √ßa: &lt;code class="highlighter-rouge"&gt;var url = new URL("...");&lt;/code&gt;&lt;/li&gt; &lt;li&gt;Data Classes pour faire des trucs comme &lt;code class="highlighter-rouge"&gt;class Point(int x, int y){}&lt;/code&gt;&lt;/li&gt; &lt;li&gt;Un meilleur switch qui se rapprochera a du Pattern Matching, on pourrait voir les choses arriv√©es progressivement, d‚Äôautant plus avec les Data Classes.&lt;/li&gt; &lt;li&gt;&lt;a href="http://openjdk.java.net/projects/valhalla/"&gt;Valhalla&lt;/a&gt; √©tudie la possibilit√© d‚Äôune nouvelle organisation de la m√©moire pour des donn√©es. Disons plus simplement √ßa correspondrait √† la notion de Value Class. Ces objets serait pass√©s par valeur (pas par r√©f√©rence) ce qui donnerait ‚ÄúCodes like a class, works like an int‚Äù. En gros √ßa permettrait aussi de faire des &lt;code class="highlighter-rouge"&gt;List&amp;lt;int&amp;gt;&lt;/code&gt;. Ce serait une √©norme √©volution dans le langage, j‚Äôai beaucoup d‚Äôespoir sur cet √©volution. Maintenant il ne faudrait pas que √ßa arrive trop tard par rapport aux nouveaux langages.&lt;/li&gt; &lt;li&gt;&lt;a href="http://openjdk.java.net/projects/panama/"&gt;Panama&lt;/a&gt; est un reboot pour faire des appels √† du code native. L‚Äôid√©e c‚Äôest de faire plus simple, plus sure, et plus rapide, la d√©mo est fun.&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;On retrouve beaucoup de choses qui sont sont d√©j√† pr√©sentes dans des langages, j‚Äôy vois personnellement une excuse pour √©tudier ces langages, et pouvoir √™tre √† l‚Äôaise lorsqu‚Äôon aura ces features dans Java.&lt;/p&gt;&lt;p&gt;Voici une s√©lection de pr√©sentations, pour celles qui concernent Jigsaw et la modularit√© je vous laisse chercher.&lt;/p&gt;&lt;ul&gt; &lt;li&gt;&lt;a href="https://www.youtube.com/watch?v=e9eSPtpiGkA"&gt;Keynote Session (Mark Reinhold and Brian Goetz)&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="https://www.youtube.com/watch?v=8XmYT89fBKg&amp;amp;list=PLRsbF2sD7JVq_TvmCyJC3-oT9nBGdwq6s&amp;amp;index=43"&gt;Exploring Java 9 (Venkat Subramaniam)&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="https://www.youtube.com/watch?v=oGll155-vuQ&amp;amp;list=PLRsbF2sD7JVrP_MJaOWvaK9-OTNX2oFwB&amp;amp;index=9"&gt;Java Language and Platform Futures: A Sneak Peek (Brian Goetz)&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="https://www.youtube.com/watch?v=53RcDiKb6Ls"&gt;Java9 and the impact on Maven Projects (Robert Scholte)&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="https://www.youtube.com/watch?v=96vce1qd0QY&amp;amp;list=PLRsbF2sD7JVrP_MJaOWvaK9-OTNX2oFwB&amp;amp;index=38"&gt;Anticipating Java 9 - Functionality and Tooling (Trisha Gee)&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt;&lt;h2 id="programation-r√©active"&gt;Programation r√©active&lt;/h2&gt;&lt;p&gt;Derni√®re grand th√©matique que j‚Äôai suivi: la programmation r√©active. C‚Äôest un sujet chaud, il y avait pas mal de pr√©sentations concernant de pr√®s ou de loin ce sujet. Tout d‚Äôabort il faut noter qu‚Äô avec Java 8, les API sont beaucoup plus agr√©able √† utiliser, ensuite les &lt;a href="http://www.reactive-streams.org/"&gt;Reactive Streams&lt;/a&gt; arrive dans Java 9 avec la classe &lt;a href="http://download.java.net/java/jdk9/docs/api/java/util/concurrent/Flow.html"&gt;&lt;code class="highlighter-rouge"&gt;Flow&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Aujour‚Äôhui, &lt;a href="http://akka.io/"&gt;Akka Stream 2&lt;/a&gt;, &lt;a href="https://projectreactor.io/"&gt;Reactor Core 3&lt;/a&gt; et &lt;a href="https://github.com/ReactiveX/RxJava"&gt;RxJava 2&lt;/a&gt; impl√©m√©nent les Reactives Streams sur la JVM.&lt;/p&gt;&lt;p&gt;Pour une excellent introduction sur le sujet je vous recommande l‚Äôuniversit√© &lt;a href="https://www.youtube.com/watch?v=weWSYIUdX6c&amp;amp;list=PLRsbF2sD7JVrP_MJaOWvaK9-OTNX2oFwB&amp;amp;index=4"&gt;Reactive Programming (Venkat Subramaniam)&lt;/a&gt; qui prends le temps pour pr√©senter le concept de la programmation r√©active, puis montre beaucoup de code avec RxJava pour montrer: les observables, l‚Äôasynchronisme, la gestion des erreurs, les op√©rateurs sur les Observables, la notion d‚Äôobservable chaud ou froid, le principe de backpressure. Le backpressure c‚Äôest quand votre √©metteur va plus vite que le consommateur, c‚Äôest quelque chose qui a mis du temps √† √™tre simple et proprement impl√©ment√© dans les API.&lt;/p&gt;&lt;p&gt;J‚Äôai aussi beaucoup appr√©ci√© l‚Äôuniversit√© &lt;a href="https://www.youtube.com/watch?v=Cj4foJzPF80&amp;amp;list=PLRsbF2sD7JVrP_MJaOWvaK9-OTNX2oFwB&amp;amp;index=37&amp;amp;t=3s"&gt;Developing Reactive applications with Reactive Streams and Java 8 (Brian Clozel, S√©bastien Deleuze)&lt;/a&gt; qui pr√©sente &lt;a href="https://github.com/reactor/reactor-core"&gt;Reactore Core 3&lt;/a&gt; dans la premi√®re partie au travers de test unitaires. Je suis tr√®s agr√©ablement surpris par la testabilit√© qu‚Äôapporte le &lt;code class="highlighter-rouge"&gt;StepVerifier&lt;/code&gt;. Dans la seconde partie, une d√©monstration de Spring Boot 2, avec Spring Framework 5 montre comment on peut passer en r√©active cot√© backend. Tr√®s int√©ressant, j‚Äôattends avec impatiance la version ‚Äòproduction-ready‚Äô de ces projets.&lt;/p&gt;&lt;p&gt;Je n‚Äôai pas encore eu le temps de regarder &lt;a href="https://www.youtube.com/watch?v=rdgJ8fOxJhc&amp;amp;list=PLRsbF2sD7JVrP_MJaOWvaK9-OTNX2oFwB&amp;amp;index=29"&gt;Reactive Web Applications with Spring 5 (Rossen Stoyanchev)&lt;/a&gt;, mais j‚Äôai eu de bon retour.&lt;/p&gt;&lt;p&gt;Sinon il y avait aussi des pr√©sentations concernant &lt;a href="http://vertx.io/"&gt;Vert.x&lt;/a&gt;, Akka Streams, ‚Ä¶&lt;/p&gt;&lt;p&gt;Ceux qui me connaissent savent que je suis tr√®s int√©ress√© par ce sujet, on pr√©voit un &lt;a href="https://www.meetup.com/fr-FR/Monkey-Tech-Days/events/232103376/"&gt;MonkeyTechDay&lt;/a&gt; en d√©but d‚Äôann√©e sur le sujet.&lt;/p&gt;&lt;h2 id="autres-sujets"&gt;Autres sujets&lt;/h2&gt;&lt;p&gt;Bien sur le Machine Learning, et les sujet Devops √©taient tr√®s bien repr√©sent√© dans les conf√©rences. Je rattraperais √ßa avec les vid√©os. Je suis aussi aller voir d‚Äôautres sujets, je vous fait une petite listes de ce que j‚Äôai trouv√© sympa.&lt;/p&gt;&lt;ul&gt; &lt;li&gt;&lt;a href="https://www.youtube.com/watch?v=3eOFCn5COvc&amp;amp;list=PLRsbF2sD7JVrP_MJaOWvaK9-OTNX2oFwB&amp;amp;index=16"&gt;Zen &amp;amp; The Art of Angular 2 (Igor Minar)&lt;/a&gt;: j‚Äôaime bien Angular2, je n‚Äôai pas beaucoup appris, mais c‚Äôest sympa d‚Äôavoir un des cr√©ateurs sur sc√®ne.&lt;/li&gt; &lt;li&gt;&lt;a href="https://www.youtube.com/watch?v=1oKlYgsnyfw&amp;amp;list=PLRsbF2sD7JVrP_MJaOWvaK9-OTNX2oFwB&amp;amp;index=3"&gt;Make CSS Fun Again with Flexbox! (Hubert Sablonni√®re)&lt;/a&gt;: un des meilleurs speaker fran√ßais.&lt;/li&gt; &lt;li&gt;&lt;a href="https://www.youtube.com/watch?v=UHN_HcjZa7o&amp;amp;index=21&amp;amp;list=PLRsbF2sD7JVrP_MJaOWvaK9-OTNX2oFwB"&gt;Deep Dive into JUnit 5 (Sam Brannen)&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href="https://www.youtube.com/watch?v=jSY3n_h7JV0"&gt;Swift: the mobile language that‚Äôs coming to the cloud (Ian Partridge)&lt;/a&gt; : la pr√©sentation n‚Äôest pas exceptionnelle, mais je suis assez int√©resser par le langage cot√© Backend.&lt;/li&gt; &lt;li&gt;&lt;a href="https://www.youtube.com/watch?v=03GsLxVdVzU&amp;amp;index=33&amp;amp;list=PLRsbF2sD7JVrP_MJaOWvaK9-OTNX2oFwB"&gt;Designing for Performance by Martin Thompson&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt;&lt;h2 id="conclusion"&gt;Conclusion&lt;/h2&gt;&lt;p&gt;Encore une super semaine, j‚Äôai encore appris plein de choses, eu de super √©changes, plein d‚Äôenvie. Il faut toutefois un peu de temps pour dig√©rer et laisser d√©canter tout cela (et faire mon compte rendu). Donc merci encore √† tous les organisateurs, b√©n√©voles, speaker, et tous les gens sympa avec qui j‚Äôai eu l‚Äôoccasion d‚Äô√©changer ou de partager une bi√®re.&lt;/p&gt;&lt;h2 id="pour-finir-quelques-photos"&gt;Pour finir quelques photos&lt;/h2&gt;&lt;p&gt;Fier d‚Äô√™tre speaker :&lt;/p&gt;&lt;p&gt;&lt;img src="/public/images/DevoxxBE16/Speaker.jpg" alt="Speaker" /&gt;&lt;/p&gt;&lt;p&gt;Igor Minar nous parle d‚ÄôAngular2 :&lt;/p&gt;&lt;p&gt;&lt;img src="/public/images/DevoxxBE16/ng2.jpg" alt="Angular2" /&gt;&lt;/p&gt;&lt;p&gt;Venkat et ces citations :&lt;/p&gt;&lt;p&gt;&lt;img src="/public/images/DevoxxBE16/VenkatQuote.jpg" alt="Venkat" /&gt;&lt;/p&gt;&lt;p&gt;Brian Goetz nous parle de Java &amp;gt; 9 avec un slide de JavaOne 2005&lt;/p&gt;&lt;p&gt;&lt;img src="/public/images/DevoxxBE16/BrianGoetz.jpg" alt="BrianGoetz" /&gt;&lt;/p&gt;&lt;p&gt;CSS is Awesome ! :&lt;/p&gt;&lt;p&gt;&lt;img src="/public/images/DevoxxBE16/css.jpg" alt="CSS" /&gt;&lt;/p&gt;&lt;p&gt;Bonne ambiance lors du Speaker Diner :&lt;/p&gt;&lt;p&gt;&lt;img src="/public/images/DevoxxBE16/SpeakerDiner.jpg" alt="Speaker Diner" /&gt;&lt;/p&gt;&lt;p&gt;Interview tr√®s s√©rieuse avec Ray Tsang :&lt;/p&gt;&lt;p&gt;&lt;img src="/public/images/DevoxxBE16/RayTsang.jpg" alt="RayTsang" /&gt;&lt;/p&gt;&lt;p&gt;Une pythie pour un mauvais Oracle :&lt;/p&gt;&lt;p&gt;&lt;img src="/public/images/DevoxxBE16/Antonio.jpg" alt="Antonio" /&gt;&lt;/p&gt;&lt;p&gt;Swift cot√© backend :&lt;/p&gt;&lt;p&gt;&lt;img src="/public/images/DevoxxBE16/SwiftBackend.jpg" alt="Swift" /&gt;&lt;/p&gt;&lt;p&gt;Enfin lorsqu‚Äôil qu‚Äôil fait froid, et qu‚Äôil pleut, il y a toujours une solution en Belgique pour se r√©confornter:&lt;/p&gt;&lt;p&gt;&lt;img src="/public/images/DevoxxBE16/be.jpg" alt="Reconford" /&gt;&lt;/p&gt;</content> <author> <name>Igor Laborie</name> <email>igor@monkeypatch.io</email> </author> <category term="Devoxx"/> <category term="Java"/> <category term="Reactive"/> <category term="functional"/> <summary>Welcome to Antwerp (Anvers)A peine remis du DevFest Toulouse, je pars une semaine en Belgique pour aller √† Devoxx. Pour ceux qui ne connaissent pas encore Devoxx, c‚Äôest une conf√©rence ind√©pendante : elle n‚Äôest organis√©e ni par Google ni par Oracle. Cela dit ils √©taient pr√©sent en temps que sponsors et speakers. C‚Äôest la plus grosse conf√©rence auquel j‚Äôai assist√© (3500 d√©veloppeurs), c‚Äôest pas tous les jours qu‚Äôon a l‚Äôoccasion de croiser des Brian Goetz, Venkat Subramaniam, ‚Ä¶ en Europe.</summary> <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://devoxx.be/wp-content/uploads/2016/04/devoxx_logo.gif"/> </entry> <entry xml:lang="fr"><title>Devfest Toulouse</title><link href="http://www.monkeypatch.io/2016/11/06/DevFest-Toulouse.html" rel="alternate" type="text/html" title="Devfest Toulouse"/> <published>2016-11-06T00:00:00+01:00</published> <updated>2016-11-06T00:00:00+01:00</updated><id>http://www.monkeypatch.io/2016/11/06/DevFest-Toulouse</id> <content type="html" xml:base="http://www.monkeypatch.io/2016/11/06/DevFest-Toulouse.html">&lt;h2 id="retours-sur-le-devfest-toulouse"&gt;Retours sur le DevFest Toulouse&lt;/h2&gt;&lt;p&gt;Jeudi 03 novembre 2016 a eu lieu le premier DevFest Toulouse (techniquement c‚Äô√©tait √† l‚ÄôIUT Blagnac), une journ√©e de conf√©rence √† prix tr√®s abordable (30‚Ç¨ seulement), le panel de speakers √©tait assez vari√©: des Toulousaing, des Fran√ßais, et quelques internationaux. Toutes les personnes avec qui j‚Äôai eu l‚Äôoccasion de discuter ont trouv√© le niveau des conf√©rences tr√®s bon. C‚Äôest aussi mon point de vue.&lt;!--more--&gt;&lt;/p&gt;&lt;p&gt;Pour moi le DevFest a commenc√© par un super repas mercredi soir avec les speakers et organisateurs. La journ√©e de conf√©rences a d√©but√© le jeudi par un caf√©+chocolatine.&lt;/p&gt;&lt;h3 id="le-matin"&gt;Le matin&lt;/h3&gt;&lt;h4 id="keynote"&gt;Keynote&lt;/h4&gt; &lt;p&gt;Nous avions tous rendez dans le grand amphi pour une keynote d‚Äô&lt;a href="https://twitter.com/danvy?lang=fr"&gt;Alex Danvy&lt;/a&gt; (Microsoft, France). Alex est un tr√®s bon orateur, il nous a parl√© de l‚Äô√©volution de notre m√©tier de d√©veloppeur. C‚Äôest souvent dans ce genre d‚Äôoccasion que l‚Äôon peut prendre du recul sur notre travail. Aujourd‚Äôhui le d√©veloppeur est un devenu tr√®s social, comme le d√©montre la richesse des communaut√©s sur Toulouse. C‚Äôest assez √©loign√© du st√©r√©otype que l‚Äôon voit dans les m√©dias, ceci nuit √† la mixit√© de la profession: un des grands enjeux de demain. Voici les &lt;a href="http://www.slideshare.net/danvy/a-developer-story"&gt;slides&lt;/a&gt;.&lt;/p&gt;&lt;h4 id="clean-code"&gt;Clean Code&lt;/h4&gt; &lt;p&gt;Ensuite j‚Äôai enchain√© par la pr√©sentation d‚Äô&lt;a href="https://twitter.com/avernois?lang=fr"&gt;Antoine Vernois&lt;/a&gt; sur le &lt;a href="http://avernois.github.io/prez-clean_code/#/"&gt;‚ÄòClean Code‚Äô&lt;/a&gt;. J‚Äôaime beaucoup sa vision, j‚Äôy retrouve beaucoup de chose que je souhaite voir appliquer au quotidien. Parmi les choses sympa que j‚Äôai envie de retenir: ‚Äúsi tu ne comprends pas la magie noire derri√®re un Framework, tu ne l‚Äôutilises pas‚Äù. Combien de projets j‚Äôai vu √©chouer √† cause du manque de compr√©hension d‚Äôun Framework‚Ä¶&lt;/p&gt;&lt;h4 id="sharing-code-between-web-and-native-apps"&gt;Sharing Code Between Web and Native Apps&lt;/h4&gt; &lt;p&gt;Puis j‚Äôai assist√© au d√©but de la conf√©rence de &lt;a href="https://twitter.com/sebawita"&gt;Sebastian Witalec&lt;/a&gt; sur le &lt;a href="https://www.nativescript.org/"&gt;NativeScript&lt;/a&gt;. J‚Äôavais d√©j√† assist√© la veille √† sa pr√©sentation dans le cadre d‚ÄôAngular Toulouse. NativeScript est une solution pour d√©velopper en JavaScript, mais en particulier avec Angular2, et produire du code natif qui s‚Äôex√©cute sur les plateformes Android ou iOS. Le concept est s√©duisant, et cette pr√©sentation m‚Äôa donn√©e envie de creuser plus en profondeur le sujet. C‚Äôest aussi l‚Äôoccasion de souligner qu‚ÄôAngular2 est vraiment bien pens√© pour √™tre un framework qui ne s‚Äôex√©cute pas uniquement dans le navigateur.&lt;/p&gt;&lt;p&gt;Je ne suis pas rest√© jusqu‚Äôau bout puisque j‚Äôenchainais avec ma pr√©sentation sur Feign et j‚Äôavais besoin d‚Äôun caf√© avant de faire mon live-coding.&lt;/p&gt;&lt;h4 id="client-rest-en-java-trop-facile-avec-feign-"&gt;Client REST en Java: trop facile avec Feign !&lt;/h4&gt; &lt;p&gt;J‚Äôai profit√© de cette pr√©sentation pour aller beaucoup plus loin que dans mes pr√©c√©dentes d√©mos: j‚Äôai montr√© comment on passait en asynchrone et le m√©canisme de Circuit Breaker avec Hystrix, et puis j‚Äôai montr√© comment on pouvait faire une impl√©mentation d‚Äôun &lt;code class="highlighter-rouge"&gt;feign.Client&lt;/code&gt; avec la nouvelle API HTTP de Java 9. Voici mes &lt;a href="https://ilaborie.github.io/devfest-toulouse-16-slides/"&gt;slides&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Apr√®s les questions et les nombreux √©changes autour de ma pr√©sentation, un repas √©tait bien m√©rit√©. C‚Äôest la premi√®re conf√©rence auquel j‚Äôassiste ou il y avait du vin (bon en plus) pendant le repas de midi: +1.&lt;/p&gt;&lt;h4 id="lapr√®s-midi"&gt;L‚Äôapr√®s midi&lt;/h4&gt;&lt;h4 id="les-acteurs-un-mod√®le-pour-dompter-le-parall√©lisme"&gt;Les Acteurs, un mod√®le pour dompter le parall√©lisme&lt;/h4&gt; &lt;p&gt;Ensuite je suis all√© voir &lt;a href="https://twitter.com/fcabestre?lang=fr"&gt;Fr√©d√©ric Cabestre&lt;/a&gt; qui nous a parl√© du mod√®le des Acteurs comme solution pour le parall√©lisme. Il a amen√© la chose en partant de loin: les aspects hardwares, en parlant ensuite des solutions threaded-pool, et event-loop avant de nous pr√©senter les aspects haut niveau sur les acteurs. Il manquait un peu de temps sur la fin, mais la pr√©sentation √©tait super didactique.&lt;/p&gt;&lt;h4 id="break"&gt;Break&lt;/h4&gt; &lt;p&gt;Ensuite, j‚Äôai eu un coup de barre : fatigue accumul√©e pendant la semaine, et peut √™tre aussi le retour de b√¢ton du vin de midi. J‚Äôai profit√© de cette pause pour √©changer avec Fabien, Mathias, Fr√©d√©ric, Antoine, Didier, ‚Ä¶ C‚Äôest un des points que je trouve le plus int√©ressant quand on va dans des conf√©rences, il y a plein de gens intelligents, passionn√©s avec lesquels on peut confronter ou conforter nos points de vue.&lt;/p&gt;&lt;h4 id="android-et-programmation-r√©active---rxjava"&gt;Android et programmation r√©active - RxJava&lt;/h4&gt; &lt;p&gt;Apr√®s je suis aller voir &lt;a href="https://twitter.com/eli_bean"&gt;Elisabel G√©n√©reux&lt;/a&gt; qui nous a parl√© de l‚Äôutilisation de &lt;a href="reactivex.io"&gt;Rx&lt;/a&gt; dans le contexte Android. Le sujet est particuli√®rement √† la mode et sa pr√©sentation m‚Äôa confirm√© que Rx au sens large est vraiment un sujet qu‚Äôil faut √©tudier. Notez qu‚Äôil y a des d√©clinaisons pour pleins de langages, et que l‚Äôon peut en retrouver cot√© backend (par exemple RxNetty), ou cot√© frontend (RxAndroid, RxSwift, RxJS). On sentait qu‚ÄôElisabel √©tait novice dans l‚Äôexercice des pr√©sentations, j‚Äôen profite pour lui envoyer des encouragements, j‚Äôai mis plusieurs ann√©es avant de me sentir √† l‚Äôaise, et de trouver mon style.&lt;/p&gt;&lt;h4 id="de-java-√†-swift-en-deux-temps-trois-mouvements"&gt;De Java √† Swift en deux temps trois mouvements&lt;/h4&gt; &lt;p&gt;J‚Äôai fini en beaut√© avec la pr√©sentation de &lt;a href="https://twitter.com/dplaindoux"&gt;Didier Plaindoux&lt;/a&gt; qui nous a parl√© de &lt;a href="https://swift.org/"&gt;Swift&lt;/a&gt; pour les d√©veloppeurs Java (pas d‚ÄôiOS). Didier est un d√©veloppeur passionn√© par les langages informatiques, et √ßa se sent dans sa pr√©sentation. En plus il a fait un effort pour rendre la pr√©sentation accessible aux plus grands nombres. Bilan, Swift me plait beaucoup, je retrouve des choses que j‚Äôaime dans Scala ou TypeScript. J‚Äôai h√¢te de trouver une occasion pour tester ce langage. Voici les &lt;a href="http://www.slideshare.net/dplaindoux/de-java-a-swift-en-2-temps-trois-mouvements"&gt;slides&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;La journ√©e s‚Äôest achev√© par un AfterWork en ville, super tapas, de nombreuses discussions int√©ressantes, y compris sur des sujets hors informatique.&lt;/p&gt;&lt;h2 id="conclusion"&gt;Conclusion&lt;/h2&gt;&lt;p&gt;Quelques petits points qui me semblent am√©liorables pour les √©v√©nements futures :&lt;/p&gt;&lt;ul&gt; &lt;li&gt;j‚Äôai trouv√© que l‚Äôespace entre les amphis √©tait un peu petit, il √©tait difficile de circuler,&lt;/li&gt; &lt;li&gt;le temps entre les pr√©sentations √©tait trop court, impossible d‚Äô√©changer dans ces moments, √ßa a √©t√© un peu la course,&lt;/li&gt; &lt;li&gt;d‚Äôailleurs je n‚Äôai pas eu assez de temps pour aller discuter avec les sponsors.&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;Mais globalement, j‚Äôai vraiment √©t√© bluff√© par le professionnalisme de cette conf√©rence, c‚Äôest particuli√®rement notable pour une premi√®re. J‚Äôen profite pour remercier les organisateurs, les b√©n√©voles, les sponsors, les speakers, et toutes personnes qui ont √©t√© impliqu√©es dans la tenue de cet √©v√©nement.&lt;/p&gt;&lt;p&gt;A l‚Äôan prochain, en esp√©rant qu‚Äôil y ait 2 jours d‚Äô√©changes et conf√©rences.&lt;/p&gt;</content> <author> <name>Igor Laborie</name> <email>igor@monkeypatch.io</email> </author> <category term="DevFest"/> <category term="Java"/> <category term="Android"/> <category term="Swift"/> <category term="Rx"/> <category term="Acteur"/> <category term="NativeScript"/> <category term="Angular2"/> <category term="Feign"/> <summary>Retours sur le DevFest ToulouseJeudi 03 novembre 2016 a eu lieu le premier DevFest Toulouse (techniquement c‚Äô√©tait √† l‚ÄôIUT Blagnac), une journ√©e de conf√©rence √† prix tr√®s abordable (30‚Ç¨ seulement), le panel de speakers √©tait assez vari√©: des Toulousaing, des Fran√ßais, et quelques internationaux. Toutes les personnes avec qui j‚Äôai eu l‚Äôoccasion de discuter ont trouv√© le niveau des conf√©rences tr√®s bon. C‚Äôest aussi mon point de vue.</summary> <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://devfesttoulouse.fr/images/logo-white.svg"/> </entry> <entry xml:lang="fr"><title>Mktd#1 Feign Vs Retrofit : 2 Aller Plus Loin</title><link href="http://www.monkeypatch.io/2016/08/10/MKTD-1-feign-vs-retrofit-&-58;-2-aller-plus-loin.html" rel="alternate" type="text/html" title="Mktd#1 Feign Vs Retrofit &amp;#58; 2 Aller Plus Loin"/> <published>2016-08-10T00:00:00+02:00</published> <updated>2016-08-10T00:00:00+02:00</updated><id>http://www.monkeypatch.io/2016/08/10/MKTD#1-feign-vs-retrofit-&amp;#58;-2-aller-plus-loin</id> <content type="html" xml:base="http://www.monkeypatch.io/2016/08/10/MKTD-1-feign-vs-retrofit-&amp;-58;-2-aller-plus-loin.html">&lt;p&gt;Cet article est le deuxi√®me d‚Äôune s√©rie de trois articles sur les clients &lt;abbr title="REpresentational State Transfer"&gt;REST&lt;/abbr&gt; en java que sont Feign et Retrofit.&lt;/p&gt;&lt;p&gt;Article pr√©c√©dent : &lt;a href="/2016/08/09/MKTD-1-feign-vs-retrofit-&amp;amp;-58;-1-prise-en-main.html"&gt;&lt;abbr title="MonkeyTechDays"&gt;MKTD&lt;/abbr&gt;#1 : Prise en main&lt;/a&gt;&lt;/p&gt;&lt;hr /&gt;&lt;h2 id="d√©fi-2-aller-plus-loin"&gt;D√©fi 2: Aller plus loin‚Ä¶&lt;/h2&gt;&lt;p&gt;Le deuxi√®me d√©fi permet d‚Äôadresser des probl√®mes plus avanc√©s comme :&lt;/p&gt;&lt;ul&gt; &lt;li&gt;L‚Äôauthentification&lt;/li&gt; &lt;li&gt;La gestion des erreurs via des &lt;code class="highlighter-rouge"&gt;Exception&lt;/code&gt; Java&lt;/li&gt; &lt;li&gt;L‚Äô&lt;em&gt;upload&lt;/em&gt; et le &lt;em&gt;download&lt;/em&gt; de fichiers&lt;/li&gt; &lt;/ul&gt;&lt;!--more--&gt;&lt;h3 id="authentification-avec-cookie"&gt;Authentification avec Cookie&lt;/h3&gt;&lt;p&gt;Afin de g√©rer le besoin d‚Äôauthentification, le serveur fournit un m√©canisme √† base de &lt;a href="https://jwt.io/"&gt;&lt;abbr title="Json WebToken"&gt;JWT&lt;/abbr&gt;&lt;/a&gt; et de &lt;a href="https://tools.ietf.org/html/rfc6265"&gt;Cookies&lt;/a&gt;. Voici l‚Äôinterface Java d√©crivant cette nouvelle op√©ration:&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;AuthenticationApi&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="nf"&gt;login&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LoginPassword&lt;/span&gt; &lt;span class="n"&gt;loginPassword&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;SecurityException&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Dans l‚Äôen-t√™te de la r√©ponse &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; se trouve un &lt;code class="highlighter-rouge"&gt;Set-Cookie&lt;/code&gt; qu‚Äôil faut d√©coder. Ce &lt;em&gt;cookie&lt;/em&gt; doit ensuite √™tre envoy√© dans les requ√™tes faites aux autres services.&lt;/p&gt;&lt;blockquote&gt; &lt;p&gt;Les solutions √† base de &lt;em&gt;token&lt;/em&gt; sont un peu plus simples √† mettre en oeuvre avec Feign et Retrofit, mais ici, l‚Äôobjectif n‚Äôest pas de faire les choses de la fa√ßon la plus simples. Pour plus d‚Äôinformation sur ce sujet vous pouvez regarder &lt;a href="https://auth0.com/blog/angularjs-authentication-with-cookies-vs-token/"&gt;ce blog&lt;/a&gt;.&lt;/p&gt; &lt;/blockquote&gt;&lt;h3 id="gestion-des-erreurs"&gt;Gestion des erreurs&lt;/h3&gt;&lt;p&gt;Pour la gestion des erreurs, le but de l‚Äôexercice est de renvoyer une erreur sp√©cifique en fonction du code &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; retourn√© par le serveur. Le code qui d√©termine l‚Äôexception √† retourner est le suivant :&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;RuntimeException&lt;/span&gt; &lt;span class="nf"&gt;decodeError&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Supplier&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;RuntimeException&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;defaultCase&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;switch&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="mi"&gt;404&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="c1"&gt;// Not Found&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nf"&gt;NoSuchElementException&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="mi"&gt;400&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="c1"&gt;// Bad Request&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nf"&gt;IllegalArgumentException&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="mi"&gt;401&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="c1"&gt;// Unauthorized&lt;/span&gt; &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="mi"&gt;403&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="c1"&gt;// Forbidden&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nf"&gt;SecurityException&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;defaultCase&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;h2 id="feign"&gt;Feign&lt;/h2&gt;&lt;h3 id="astuce-log-des-requ√™tes-http"&gt;Astuce: log des requ√™tes &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt;&lt;/h3&gt;&lt;p&gt;Pour faciliter le d√©veloppement de ce d√©fi, il est tr√®s pratique de pouvoir afficher des &lt;em&gt;logs&lt;/em&gt; sur les requ√™tes ou les r√©ponses &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt;.&lt;/p&gt;&lt;h4 id="quick--dirty"&gt;Quick &amp;amp; Dirty&lt;/h4&gt;&lt;p&gt;La solution la plus directe consite √† utiliser un &lt;code class="highlighter-rouge"&gt;RequestInterceptor&lt;/code&gt; qui est appel√© par Feign avant que la requ√™te &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; ne soit construite, et &lt;em&gt;logger&lt;/em&gt; via un &lt;code class="highlighter-rouge"&gt;System.out&lt;/code&gt;.&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="n"&gt;Feign&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;builder&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;interceptor&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;println&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;// Quick &amp;amp; Dirty debug&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;decoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;GsonDecoder&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;encoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;GsonEncoder&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;target&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MonkeyRaceApi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Evidement, √ßa ne marche que pour la requ√™te &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt;, pour la r√©ponse il faudrait faire quelque chose d‚Äô√©quivalent dans un d√©codeur.&lt;/p&gt;&lt;h4 id="solution-avec-un-logger-feign"&gt;Solution avec un logger Feign&lt;/h4&gt;&lt;p&gt;Pour √©viter d‚Äôavoir des d√©pendances sur biblioth√®ques tierces, Feign √† d√©finit son propre &lt;code class="highlighter-rouge"&gt;Logger&lt;/code&gt;. C‚Äôest une classe abstraite avec une seule m√©thode √† impl√©menter. Il faut ensuite d√©finir le niveau de &lt;em&gt;log&lt;/em&gt; souhait√©: &lt;code class="highlighter-rouge"&gt;NONE&lt;/code&gt;, &lt;code class="highlighter-rouge"&gt;BASIC&lt;/code&gt;, &lt;code class="highlighter-rouge"&gt;HEADERS&lt;/code&gt;, &lt;code class="highlighter-rouge"&gt;FULL&lt;/code&gt;. Voici ce que √ßa donne:&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="n"&gt;Feign&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;builder&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;logLevel&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Level&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;FULL&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;logger&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Logger&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="c1"&gt;// implements Feign abstract Logger&lt;/span&gt; &lt;span class="nd"&gt;@Override&lt;/span&gt; &lt;span class="kd"&gt;protected&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;log&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;configKey&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;printf&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"[%s] "&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;configKey&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;printf&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;})&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;decoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;GsonDecoder&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;encoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;GsonEncoder&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;target&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MonkeyRaceApi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Dans Feign, le &lt;code class="highlighter-rouge"&gt;feign.Logger.JavaLogger&lt;/code&gt; impl√©mente le m√©canisme au travers du &lt;em&gt;loggeur&lt;/em&gt; du &lt;abbr title="Java Development Kit"&gt;JDK&lt;/abbr&gt; (&lt;code class="highlighter-rouge"&gt;java.util.logging.Logger&lt;/code&gt;), et il existe bien s√ªr une extension pour utiliser &lt;a href="https://github.com/OpenFeign/feign/tree/master/slf4j"&gt;SLF4J&lt;/a&gt;.&lt;/p&gt;&lt;h3 id="authentification-avec-cookie-1"&gt;Authentification avec Cookie&lt;/h3&gt;&lt;p&gt;La premi√®re √©tape consiste √† r√©cup√©rer le &lt;em&gt;cookie&lt;/em&gt; g√©n√©r√© par la requ√™te d‚Äôauthentification. Pour cela on utilise un d√©codeur sp√©cifique qui va traiter les en-t√™tes de la r√©ponse pour stocker les &lt;em&gt;cookies&lt;/em&gt;.&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="nf"&gt;getAuthToken&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;AuthenticationApi&lt;/span&gt; &lt;span class="n"&gt;authenticationApi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;builder&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;encoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;GsonEncoder&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;decoder&lt;/span&gt;&lt;span class="o"&gt;((&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;handleCookies&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;()))&lt;/span&gt; &lt;span class="c1"&gt;// decode cookies&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;target&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AuthenticationApi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;authenticationApi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;login&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;LoginPassword&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Le stockage du &lt;em&gt;cookie&lt;/em&gt; est assur√© par le &lt;a href="https://docs.oracle.com/javase/8/docs/api/index.html?overview-summary.html"&gt;CookieManager&lt;/a&gt; disponible depuis Java 6.&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;CookieManager&lt;/span&gt; &lt;span class="n"&gt;COOKIE_MANAGER&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;CookieManager&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;L‚Äôutilisation de ce &lt;code class="highlighter-rouge"&gt;CookieManager&lt;/code&gt; est trait√© dans la m√©thode &lt;code class="highlighter-rouge"&gt;handleCookies&lt;/code&gt; ci dessous:&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="nf"&gt;handleCookies&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Collection&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="c1"&gt;// From Map&amp;lt;String, Collection&amp;lt;String&amp;gt;&amp;gt; to Map&amp;lt;String, List&amp;lt;String&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;h&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;entrySet&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;collect&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt; &lt;span class="n"&gt;toMap&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt; &lt;span class="n"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Entry&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;getKey&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;entry&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;entry&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getValue&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;collect&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;toList&lt;/span&gt;&lt;span class="o"&gt;()))&lt;/span&gt; &lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;URI&lt;/span&gt; &lt;span class="n"&gt;uri&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;URI&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;create&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BASE_URL&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="n"&gt;image&lt;/span&gt; &lt;span class="n"&gt;COOKIE_MANAGER&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;put&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;uri&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;COOKIE_MANAGER&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getCookieStore&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;uri&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="c1"&gt;// Stream&amp;lt;HttpCookie&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;filter&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cookie&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="s"&gt;"token"&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;equals&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cookie&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getName&lt;/span&gt;&lt;span class="o"&gt;()))&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;findFirst&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="c1"&gt;// Optional&amp;lt;HttpCookie&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;map&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nl"&gt;HttpCookie:&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;getValue&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;orElseThrow&lt;/span&gt;&lt;span class="o"&gt;(()&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;IllegalStateException&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Authentication cookie not found"&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;catch&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;IOException&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;throw&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nf"&gt;RuntimeException&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Une fois stock√©, ce &lt;em&gt;cookie&lt;/em&gt; sera envoy√© dans les futures requ√™tes. Pour cela on utilise une nouvelle fois le m√©canisme de &lt;code class="highlighter-rouge"&gt;RequestInterceptor&lt;/code&gt; qui permet de modifier le &lt;code class="highlighter-rouge"&gt;RequestTemplate&lt;/code&gt;, Feign utilise cet objet pour construire la requ√™te &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt;.&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;MonkeyRaceApi&lt;/span&gt; &lt;span class="nf"&gt;buildRaceApi&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;getAuthToken&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;builder&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;requestInterceptor&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nl"&gt;ApiFactory:&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;addCookies&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;// Inject Cookies&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;decoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;GsonDecoder&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;encoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;GsonEncoder&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;target&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MonkeyRaceApi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;L‚Äôintercepteur se comporte comme un consommateur de &lt;code class="highlighter-rouge"&gt;RequestTemplate&lt;/code&gt; :&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;addCookies&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RequestTemplate&lt;/span&gt; &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;URI&lt;/span&gt; &lt;span class="n"&gt;uri&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;URI&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;create&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BASE_URL&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="n"&gt;COOKIE_MANAGER&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getCookieStore&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;uri&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;map&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nl"&gt;HttpCookie:&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;forEach&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cookie&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;header&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Cookie"&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cookie&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Dans Feign, le m√©canisme d‚Äôauthentification par &lt;em&gt;cookie&lt;/em&gt; est proche du m√©canisme d‚Äôen-t√™te &lt;code class="highlighter-rouge"&gt;Authorization&lt;/code&gt; souvent associ√© au &lt;abbr title="Json WebToken"&gt;JWT&lt;/abbr&gt;. Il se base sur des en-t√™tes &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt;. Pour impl√©menter l‚Äôauthentification √† base de &lt;em&gt;token&lt;/em&gt;, on utiliserait donc la m√™me technique du &lt;code class="highlighter-rouge"&gt;RequestInterceptor&lt;/code&gt;. On constate quand m√™me que l‚Äôutilisation des &lt;em&gt;cookies&lt;/em&gt; alourdi fortement le code.&lt;/p&gt;&lt;blockquote&gt; &lt;p&gt;On peut aussi utiliser une &lt;code class="highlighter-rouge"&gt;feign.Target&lt;/code&gt; pour traiter les aspects d‚Äôauthentification, voir la &lt;a href="https://github.com/OpenFeign/feign#setting-headers-per-target"&gt;documentation de Feign&lt;/a&gt;.&lt;/p&gt; &lt;/blockquote&gt;&lt;h3 id="gestion-des-erreurs-1"&gt;Gestion des erreurs&lt;/h3&gt;&lt;p&gt;Dans Feign, il existe un m√©canisme sp√©cifique pour traiter les cas en erreurs, c‚Äôest √† dire si la r√©ponse &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; √† un code ‚â• 400. Ce m√©canisme utilise un &lt;code class="highlighter-rouge"&gt;ErrorDecoder&lt;/code&gt; :&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;MonkeyRaceApi&lt;/span&gt; &lt;span class="nf"&gt;buildRaceApi&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;getAuthToken&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;builder&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;errorDecoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nl"&gt;ApiFactory:&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;decodeError&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;// Decode errors&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;requestInterceptor&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nl"&gt;ApiFactory:&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;addCookies&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;// Inject Cookies&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;decoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;GsonDecoder&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;encoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;GsonEncoder&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;target&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MonkeyRaceApi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;Exception&lt;/span&gt; &lt;span class="nf"&gt;decodeError&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;methodKey&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Response&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nf"&gt;decodeError&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;status&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;methodKey&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;FeignException&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;errorStatus&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;methodKey&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;blockquote&gt; &lt;p&gt;Parfois on souhaite traiter le cas particulier d‚Äôune erreur &lt;code class="highlighter-rouge"&gt;404&lt;/code&gt; dans le &lt;code class="highlighter-rouge"&gt;Decoder&lt;/code&gt; utilis√© dans le cas nominal, pour cel√† il suffit d‚Äôutiliser la m√©thode &lt;code class="highlighter-rouge"&gt;feign.Feign.Builder#decode404&lt;/code&gt; sur le &lt;em&gt;builder&lt;/em&gt;.&lt;/p&gt; &lt;/blockquote&gt;&lt;h3 id="upload"&gt;Upload&lt;/h3&gt;&lt;p&gt;Concernant l‚Äô&lt;em&gt;upload&lt;/em&gt; de fichier, le serveur &lt;abbr title="REpresentational State Transfer"&gt;REST&lt;/abbr&gt; propose deux solutions:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;un &lt;em&gt;upload&lt;/em&gt; via un &lt;a href="https://www.ietf.org/rfc/rfc2388.txt"&gt;formulaire multipart&lt;/a&gt; avec l‚Äôen-t√™te &lt;code class="highlighter-rouge"&gt;Content-type&lt;/code&gt; √† &lt;code class="highlighter-rouge"&gt;multipart/form-data&lt;/code&gt;&lt;/li&gt; &lt;li&gt;un &lt;em&gt;upload&lt;/em&gt; direct avec les donn√©es du fichier directement dans le corps de la requ√™te, l‚Äôen-t√™te &lt;code class="highlighter-rouge"&gt;Content-type&lt;/code&gt; √† &lt;code class="highlighter-rouge"&gt;application/octet-stream&lt;/code&gt;.&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;Les deux solutions sont impl√©metables en utilisant le m√™me principe: un &lt;code class="highlighter-rouge"&gt;Decoder&lt;/code&gt; sp√©cifique. La seconde solution est beaucoup plus simple √† impl√©menter car g√©rer le corps d‚Äôune requ√™te &lt;em&gt;multipart&lt;/em&gt; n√©cessite l‚Äôutilisation d‚Äôune &lt;abbr title="Application Programming Interface"&gt;API&lt;/abbr&gt; externe (par exemple &lt;a href="https://commons.apache.org/proper/commons-fileupload/"&gt;Commons FileUpload d‚ÄôApache&lt;/a&gt;). On peut regarder du cot√© de &lt;a href="https://github.com/xxlabaza/feign-form"&gt;https://github.com/xxlabaza/feign-form&lt;/a&gt; ou &lt;a href="https://github.com/pcan/feign-client-test"&gt;https://github.com/pcan/feign-client-test&lt;/a&gt; pour voir des solutions ou des id√©es pour ces aspects &lt;em&gt;multipart&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;La seconde solution est donc beaucoup plus simple, le principe est de traiter le cas particulier des objets du type &lt;code class="highlighter-rouge"&gt;java.io.InputStream&lt;/code&gt; et de d√©l√©guer les autres cas √† un autre encodeur &lt;abbr title="JavaScript Object Notation"&gt;JSON&lt;/abbr&gt; classique. Pour d√©finir le corps de de la requ√™te &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; il faut appeler la m√©thode &lt;code class="highlighter-rouge"&gt;feign.RequestTemplate#body(byte[], java.nio.charset.Charset)&lt;/code&gt;. Il est possible d‚Äô√©crire le code d‚Äôun encodeur dans une &lt;em&gt;lambda&lt;/em&gt; Java 8, mais ici il est pr√©f√©rable d‚Äôextraire le code de ce d√©codeur dans une nouvelle classe :&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;UploadEncoder&lt;/span&gt; &lt;span class="kd"&gt;implements&lt;/span&gt; &lt;span class="n"&gt;Encoder&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Encoder&lt;/span&gt; &lt;span class="n"&gt;delegate&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="nf"&gt;UploadEncoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Encoder&lt;/span&gt; &lt;span class="n"&gt;encoder&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="kd"&gt;super&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="n"&gt;delegate&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;encoder&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;encode&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt; &lt;span class="n"&gt;object&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Type&lt;/span&gt; &lt;span class="n"&gt;bodyType&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;RequestTemplate&lt;/span&gt; &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;EncodeException&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;InputStream&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;equals&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodyType&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;header&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Content-type"&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"application/octet-stream"&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="n"&gt;InputStream&lt;/span&gt; &lt;span class="n"&gt;inputStream&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;InputStream&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;cast&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;object&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;// InputStream to byte[]&lt;/span&gt; &lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BufferedInputStream&lt;/span&gt; &lt;span class="n"&gt;bin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;BufferedInputStream&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;inputStream&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="n"&gt;ByteArrayOutputStream&lt;/span&gt; &lt;span class="n"&gt;bos&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;ByteArrayOutputStream&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="kt"&gt;byte&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;buffer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="kt"&gt;byte&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="o"&gt;];&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;bytesRead&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt;&lt;span class="n"&gt;bytesRead&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;read&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;bos&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;write&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bytesRead&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="n"&gt;bos&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;flush&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;body&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bos&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;toByteArray&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;StandardCharsets&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;UTF_8&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;catch&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;IOException&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;throw&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nf"&gt;EncodeException&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Cannot upload file"&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;delegate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;encode&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;object&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodyType&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;blockquote&gt; &lt;p&gt;On peut bien s√ªr simplifier le code en utilisant une biblioth√®que qui permet facilement de faire la conversion &lt;code class="highlighter-rouge"&gt;InputStream&lt;/code&gt; vers &lt;code class="highlighter-rouge"&gt;byte[]&lt;/code&gt;, mais √ßa ne fait pas de mal d‚Äô√©crire des &lt;code class="highlighter-rouge"&gt;try with resources&lt;/code&gt; de temps en temps.&lt;/p&gt; &lt;/blockquote&gt;&lt;blockquote&gt; &lt;p&gt;On peut l√©gitimement argumenter que ce code risque de poser des probl√®mes si le fichier est particuli√®rement gros. Mais si on doit g√©rer ce genre de cas, il faut aussi se poser la question suivante: une &lt;abbr title="Application Programming Interface"&gt;API&lt;/abbr&gt; &lt;abbr title="REpresentational State Transfer"&gt;REST&lt;/abbr&gt; est elle la bonne solution pour faire des &lt;em&gt;upload&lt;/em&gt; de gros fichier ?&lt;/p&gt; &lt;/blockquote&gt;&lt;h3 id="download"&gt;Download&lt;/h3&gt;&lt;p&gt;On utilise un &lt;code class="highlighter-rouge"&gt;feign.Decoder&lt;/code&gt; pour le &lt;em&gt;download&lt;/em&gt;, le principe est similaire √† celui utiliser pour l‚Äô&lt;em&gt;upload&lt;/em&gt;. Ce qui va donner:&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DownloadDecoder&lt;/span&gt; &lt;span class="kd"&gt;implements&lt;/span&gt; &lt;span class="n"&gt;Decoder&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Decoder&lt;/span&gt; &lt;span class="n"&gt;delegate&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="n"&gt;DownloadDecoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Decoder&lt;/span&gt; &lt;span class="n"&gt;decoder&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="kd"&gt;super&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="n"&gt;delegate&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;decoder&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Object&lt;/span&gt; &lt;span class="nf"&gt;decode&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Response&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Type&lt;/span&gt; &lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;IOException&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;DecodeException&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;FeignException&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;InputStream&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;equals&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;body&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;asInputStream&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;delegate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;decode&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Une nouvelle fois, Feign rend l‚Äôop√©ration tr√®s simple d√®s qu‚Äôon a compris le principe des encodeurs/d√©codeurs.&lt;/p&gt;&lt;h3 id="bilan"&gt;Bilan&lt;/h3&gt;&lt;p&gt;Feign rend la manipulation des en-t√™tes &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; tr√®s simple, cela permet d‚Äôutiliser les divers m√©canismes d‚Äôautentifications par &lt;em&gt;Cookie&lt;/em&gt; ou &lt;em&gt;Token&lt;/em&gt; facilement.&lt;/p&gt;&lt;p&gt;La gestion des erreurs dans Feign est aussi triviale, c‚Äôest un des points fort de Feign par rapport √† Retrofit.&lt;/p&gt;&lt;p&gt;Le m√©canisme d‚Äôencodeur permet facilement de traiter le cas d‚Äô&lt;em&gt;upload&lt;/em&gt; du fichier, et de fa√ßon plus g√©n√©rale de traiter tous les cas de &lt;em&gt;serialization&lt;/em&gt; des requ√™tes &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt;. Le m√©canisme de d√©codeur va permettre de r√©cup√©rer le contenu d‚Äôun fichier que l‚Äôon &lt;em&gt;download&lt;/em&gt;, ou plus g√©n√©ralement les divers m√©canismes de &lt;em&gt;deserialization&lt;/em&gt; des r√©ponses &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt;.&lt;/p&gt;&lt;p&gt;Feign offre une grande souplesse grace aux &lt;code class="highlighter-rouge"&gt;Encoder&lt;/code&gt;, &lt;code class="highlighter-rouge"&gt;Decoder&lt;/code&gt;, &lt;code class="highlighter-rouge"&gt;RequestInterceptor&lt;/code&gt;, ‚Ä¶ on arrive assez facilement √† r√©soudre les divers probl√®mes pos√©s autours des &lt;abbr title="Application Programming Interface"&gt;API&lt;/abbr&gt; &lt;abbr title="REpresentational State Transfer"&gt;REST&lt;/abbr&gt;.&lt;/p&gt;&lt;h2 id="retrofit"&gt;Retrofit&lt;/h2&gt;&lt;h3 id="authentification-avec-cookie-2"&gt;Authentification avec Cookie&lt;/h3&gt;&lt;p&gt;La fa√ßon la plus simple de g√©rer l‚Äôauthentification avec Retrofit consiste √† utiliser les m√©canismes du client &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; (&lt;code class="highlighter-rouge"&gt;okHttp3&lt;/code&gt;). Comme pour feign, on fait une premi√®re requ√™te qui r√©cup√®re le cookie et ensuite on utilise le m√™me client pour les autres requ√™tes. Une autre solution consiste a utiliser un client par requ√™te mais une seule instance de &lt;code class="highlighter-rouge"&gt;cookieJar&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Voici une premi√®re impl√©mentation assez basique qui permet de comprendre le m√©canisme du &lt;code class="highlighter-rouge"&gt;cookieJar&lt;/code&gt;.&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="n"&gt;client&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;OkHttpClient&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Builder&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;cookieJar&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nf"&gt;CookieJar&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;HashMap&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Cookie&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;cookieStore&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;HashMap&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;();&lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;saveFromResponse&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HttpUrl&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Cookie&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;cookies&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;cookieStore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;put&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;uri&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;getAuthority&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;cookies&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Cookie&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;loadForRequest&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HttpUrl&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Cookie&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;cookies&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cookieStore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;uri&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;getAuthority&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;cookies&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt; &lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="n"&gt;cookies&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;ArrayList&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Cookie&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;();&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;});&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Une impl√©mentation plus √©l√©gante et plus simple consiste √† ajouter la d√©pendance &lt;code class="highlighter-rouge"&gt;okhttp-urlconnection&lt;/code&gt; de &lt;code class="highlighter-rouge"&gt;OkHttp&lt;/code&gt;.&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="n"&gt;CookieHandler&lt;/span&gt; &lt;span class="n"&gt;cookieHandler&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;CookieManager&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nf"&gt;PersistentCookieStore&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="o"&gt;),&lt;/span&gt; &lt;span class="n"&gt;CookiePolicy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;ACCEPT_ALL&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="n"&gt;OkHttpClient&lt;/span&gt; &lt;span class="n"&gt;httpClient&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;OkHttpClient&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Builder&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;cookieJar&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;JavaNetCookieJar&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cookieHandler&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;h3 id="gestion-des-erreurs-2"&gt;Gestion des erreurs&lt;/h3&gt;&lt;p&gt;Il n‚Äôexiste pas, de mon point de vue de solution id√©ale dans Retrofit pour g√©rer les erreurs comment il en existe dans Feign. Pour cet exercice, nous utilisons donc la fonctionnalit√© d‚Äôinterceptor de &lt;code class="highlighter-rouge"&gt;OkHttp&lt;/code&gt;. Une limitation existe cependant; il faut que les exceptions √† retourner soient de type &lt;code class="highlighter-rouge"&gt;RuntimeException&lt;/code&gt;.&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="n"&gt;OkHttpClient&lt;/span&gt; &lt;span class="n"&gt;client&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;OkHttpClient&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Builder&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addInterceptor&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;authInterceptor&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="n"&gt;Response&lt;/span&gt; &lt;span class="nf"&gt;authInterceptor&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Interceptor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Chain&lt;/span&gt; &lt;span class="n"&gt;chain&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;IOException&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;Request&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;chain&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;request&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="n"&gt;Response&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;chain&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;proceed&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(!&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;isSuccessful&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;RuntimeException&lt;/span&gt; &lt;span class="n"&gt;ex&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ApiFactory&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;decodeError&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;code&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;message&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ex&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;throw&lt;/span&gt; &lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;h3 id="upload-1"&gt;Upload&lt;/h3&gt;&lt;p&gt;Pour l‚Äô&lt;em&gt;upload&lt;/em&gt; , nous avons choisi d‚Äôutiliser la m√©thode du &lt;a href="https://www.ietf.org/rfc/rfc2388.txt"&gt;formulaire multipart&lt;/a&gt; avec l‚Äôen-t√™te &lt;code class="highlighter-rouge"&gt;Content-type&lt;/code&gt; √† &lt;code class="highlighter-rouge"&gt;multipart/form-data&lt;/code&gt;&lt;/p&gt;&lt;p&gt;Et voici comment faire :&lt;/p&gt;&lt;p&gt;On ajoute la m√©thode au service.&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;MonkeyService&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nd"&gt;@Multipart&lt;/span&gt; &lt;span class="nd"&gt;@POST&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"monkeys/{id}/photo"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;Call&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Photo&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;sendPhoto&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nd"&gt;@Path&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"id"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nd"&gt;@Part&lt;/span&gt; &lt;span class="n"&gt;MultipartBody&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Part&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;On cr√©e un fichier temporaire contenant la photo, puis on appelle la m√©thode &lt;code class="highlighter-rouge"&gt;sendPhoto&lt;/code&gt; en lui fournissant un &lt;code class="highlighter-rouge"&gt;RequestBody&lt;/code&gt; sp√©cifique contenant ce fichier temporaire et ensuite nous cr√©ons le &lt;code class="highlighter-rouge"&gt;MultipartBody&lt;/code&gt; qui est pass√© au service.&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Photo&lt;/span&gt; &lt;span class="nf"&gt;savePhoto&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;InputStream&lt;/span&gt; &lt;span class="n"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;SecurityException&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;IllegalArgumentException&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nf"&gt;executeCall&lt;/span&gt;&lt;span class="o"&gt;(()&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;Path&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Files&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;createTempFile&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"exo2"&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"upload"&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Files&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;REPLACE_EXISTING&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="n"&gt;RequestBody&lt;/span&gt; &lt;span class="n"&gt;requestFile&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;RequestBody&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;create&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MediaType&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;parse&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"multipart/form-data"&lt;/span&gt;&lt;span class="o"&gt;),&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;toFile&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt; &lt;span class="n"&gt;MultipartBody&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Part&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MultipartBody&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Part&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;createFormData&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"photo"&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;toFile&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;getName&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;requestFile&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;monkeyService&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;sendPhoto&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;catch&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;IOException&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;printStackTrace&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;});&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;h3 id="download-1"&gt;Download&lt;/h3&gt;&lt;p&gt;Pour le &lt;em&gt;download&lt;/em&gt; il nous suffit de faire un appel √† notre service en r√©cup√©rant le corps de la r√©ponse. Pour cela Retrofit dispose d‚Äôun type &lt;em&gt;g√©n√©rique&lt;/em&gt;: &lt;code class="highlighter-rouge"&gt;ResponseBody&lt;/code&gt; qui permet de r√©cup√©rer la r√©ponse &lt;code class="highlighter-rouge"&gt;brute&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;On commence par ajouter la m√©thode √† notre service :&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;MonkeyService&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="nd"&gt;@GET&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"monkeys/{id}/photo"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;Call&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;ResponseBody&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;downloadPhoto&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nd"&gt;@Path&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"id"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;SecurityException&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;IllegalArgumentException&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;puis voici le code qui permet de r√©cup√©rer notre photo :&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;InputStream&lt;/span&gt; &lt;span class="nf"&gt;downloadPhoto&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;SecurityException&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;IllegalArgumentException&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;Response&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;ResponseBody&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;monkeyService&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;downloadPhoto&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;execute&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;body&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;byteStream&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;catch&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;IOException&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;h3 id="bilan-1"&gt;Bilan&lt;/h3&gt;&lt;p&gt;Il est tr√®s simple dans Retrofit de g√©rer l‚Äôauthentification via &lt;em&gt;Cookie&lt;/em&gt;, &lt;em&gt;Token&lt;/em&gt;. L‚Äô&lt;em&gt;upload&lt;/em&gt; et le &lt;em&gt;download&lt;/em&gt; sont aussi assez simple √† g√©rer.&lt;/p&gt;&lt;p&gt;En revanche la gestion des erreurs est un peu moins intuitive. Peut √™tre existe t‚Äôil une autre solution auquelle nous n‚Äôavons pas pens√©.&lt;/p&gt;&lt;h2 id="bilan-global"&gt;Bilan Global&lt;/h2&gt;&lt;p&gt;Que ce soit avec Feign ou Retrofit, il est ais√© de g√©rer les &lt;em&gt;cookies&lt;/em&gt;, et les &lt;em&gt;upload&lt;/em&gt;/&lt;em&gt;download&lt;/em&gt; de fichiers.&lt;/p&gt;&lt;p&gt;Nous avons √©galement trouv√© que la gestion des erreurs en mode synchrone √©tait mieux g√©r√© avec Feign.&lt;/p&gt;&lt;p&gt;Les solutions utilisant &lt;a href="http://square.github.io/okhttp/"&gt;OkHttp&lt;/a&gt; sont communes √† Retrofit et √† Feign quand on utilise le client &lt;a href="https://github.com/OpenFeign/feign/tree/master/okhttp"&gt;okhttp-client&lt;/a&gt; dans Feign.&lt;/p&gt;</content> <author> <name>Emmanuel Vinas</name> <email>emmanuel@monkeypatch.io</email> </author> <author> <name>Igor Laborie</name> <email>igor@monkeypatch.io</email> </author> <category term="MKTD"/> <category term="Java"/> <category term="REST"/> <category term="Feign"/> <category term="Retrofit"/> <category term="Cookie"/> <summary>Cet article est le deuxi√®me d‚Äôune s√©rie de trois articles sur les clients REST en java que sont Feign et Retrofit.Article pr√©c√©dent : MKTD#1 : Prise en mainD√©fi 2: Aller plus loin‚Ä¶Le deuxi√®me d√©fi permet d‚Äôadresser des probl√®mes plus avanc√©s comme :L‚Äôauthentification La gestion des erreurs via des Exception Java L‚Äôupload et le download de fichiers</summary> <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://www.monkeypatch.io/public/images/logos/logo-FeignVsRetrofit.png"/> </entry> <entry xml:lang="en"><title>Mktd#1 Feign Vs Retrofit : 2 Going Further</title><link href="http://www.monkeypatch.io/2016/08/10/MKTD-1-feign-vs-retrofit-&-58;-2-going-further.html" rel="alternate" type="text/html" title="Mktd#1 Feign Vs Retrofit &amp;#58; 2 Going Further"/> <published>2016-08-10T00:00:00+02:00</published> <updated>2016-08-10T00:00:00+02:00</updated><id>http://www.monkeypatch.io/2016/08/10/MKTD#1-feign-vs-retrofit-&amp;#58;-2-going-further</id> <content type="html" xml:base="http://www.monkeypatch.io/2016/08/10/MKTD-1-feign-vs-retrofit-&amp;-58;-2-going-further.html">&lt;p&gt;This article is the second of the serie &lt;abbr title="REpresentational State Transfer"&gt;REST&lt;/abbr&gt; clients in Java.&lt;/p&gt;&lt;p&gt;Previous article: &lt;a href="/2016/08/09/MKTD-1-feign-vs-retrofit-&amp;amp;-58;-1-getting-started.html"&gt;&lt;abbr title="MonkeyTechDays"&gt;MKTD&lt;/abbr&gt;#1 : Getting started&lt;/a&gt;&lt;/p&gt;&lt;hr /&gt;&lt;h2 id="challenge-2-going-further"&gt;Challenge #2: Going further‚Ä¶&lt;/h2&gt;&lt;p&gt;The second challenge aims at solving advanced problems such as:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;Authentication and session management&lt;/li&gt; &lt;li&gt;Errors management via Java &lt;code class="highlighter-rouge"&gt;Exception&lt;/code&gt;&lt;/li&gt; &lt;li&gt;Files &lt;em&gt;upload&lt;/em&gt; and &lt;em&gt;download&lt;/em&gt; &lt;!--more--&gt;&lt;/li&gt; &lt;/ul&gt;&lt;h3 id="session-management-using-cookies"&gt;Session management using Cookies&lt;/h3&gt;&lt;p&gt;Out of the box, the server provides authentication and session management mechanisms using &lt;a href="https://jwt.io/"&gt;&lt;abbr title="Json WebToken"&gt;JWT&lt;/abbr&gt;&lt;/a&gt; and &lt;a href="https://tools.ietf.org/html/rfc6265"&gt;Cookies&lt;/a&gt;. A new Java interface describes this operation:&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;AuthenticationApi&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="nf"&gt;login&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LoginPassword&lt;/span&gt; &lt;span class="n"&gt;loginPassword&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;SecurityException&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;The response &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; may return a &lt;code class="highlighter-rouge"&gt;Set-Cookie&lt;/code&gt; header to be decoded. This &lt;em&gt;cookie&lt;/em&gt; value will then be added to subsequent requests headers sent to other services.&lt;/p&gt;&lt;blockquote&gt; &lt;p&gt;&lt;em&gt;Token&lt;/em&gt; based solutions are simpler to put in place using Feign and Retrofit, but in our scenario we are not trying to follow the simplest approach. You can find more information on this topic on &lt;a href="https://auth0.com/blog/angularjs-authentication-with-cookies-vs-token/"&gt;this blog&lt;/a&gt;.&lt;/p&gt; &lt;/blockquote&gt;&lt;h3 id="errors-management"&gt;Errors management&lt;/h3&gt;&lt;p&gt;Regarding errors management, we need to return specific errors based on the &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; code returned by the server. The following piece of code handles the &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; error to Java exception mapping:&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;RuntimeException&lt;/span&gt; &lt;span class="nf"&gt;decodeError&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Supplier&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;RuntimeException&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;defaultCase&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;switch&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="mi"&gt;404&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="c1"&gt;// Not Found&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nf"&gt;NoSuchElementException&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="mi"&gt;400&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="c1"&gt;// Bad Request&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nf"&gt;IllegalArgumentException&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="mi"&gt;401&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="c1"&gt;// Unauthorized&lt;/span&gt; &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="mi"&gt;403&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="c1"&gt;// Forbidden&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nf"&gt;SecurityException&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;defaultCase&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;h2 id="feign"&gt;Feign&lt;/h2&gt;&lt;h3 id="pro-tip-http-requests-logging"&gt;Pro tip: &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; requests logging&lt;/h3&gt;&lt;p&gt;To ease this challenge implementation, it appears to be very handy to log the &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; requests and responses.&lt;/p&gt;&lt;h4 id="quick--dirty-way"&gt;Quick &amp;amp; Dirty way&lt;/h4&gt;&lt;p&gt;The quickest way to achieve this is to use a &lt;code class="highlighter-rouge"&gt;RequestInterceptor&lt;/code&gt; called by Feign before an &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; request gets built and log it via &lt;code class="highlighter-rouge"&gt;System.out&lt;/code&gt;.&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="n"&gt;Feign&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;builder&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;interceptor&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;println&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;// Quick &amp;amp; Dirty debug&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;decoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;GsonDecoder&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;encoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;GsonEncoder&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;target&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MonkeyRaceApi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;This obviously works only for &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; requests, to achieve the same for the responses, similar thing has to be added to the decoder.&lt;/p&gt;&lt;h4 id="using-feign-logger"&gt;Using Feign logger&lt;/h4&gt;&lt;p&gt;To avoid third-parties libraries dependencies, Feign defines its own &lt;code class="highlighter-rouge"&gt;Logger&lt;/code&gt;. It consists of an abstract class with a single method to implement. The log level needs to be defined to allow log filtering later on (&lt;code class="highlighter-rouge"&gt;NONE&lt;/code&gt;, &lt;code class="highlighter-rouge"&gt;BASIC&lt;/code&gt;, &lt;code class="highlighter-rouge"&gt;HEADERS&lt;/code&gt;, &lt;code class="highlighter-rouge"&gt;FULL&lt;/code&gt;). Here is an example:&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="n"&gt;Feign&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;builder&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;logLevel&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Level&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;FULL&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;logger&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Logger&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="nd"&gt;@Override&lt;/span&gt; &lt;span class="kd"&gt;protected&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;log&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;configKey&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;printf&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"[%s] "&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;configKey&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;printf&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="n"&gt;System&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;out&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;println&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;})&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;decoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;GsonDecoder&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;encoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;GsonEncoder&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;target&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MonkeyRaceApi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;By default, Feign logger class &lt;code class="highlighter-rouge"&gt;feign.Logger.JavaLogger&lt;/code&gt; relies on the &lt;abbr title="Java Development Kit"&gt;JDK&lt;/abbr&gt; logger &lt;code class="highlighter-rouge"&gt;java.util.logging.Logger&lt;/code&gt; but an extension exists to use other loggers such as &lt;a href="https://github.com/OpenFeign/feign/tree/master/slf4j"&gt;SLF4J&lt;/a&gt;.&lt;/p&gt;&lt;h3 id="cookie-based-authentication"&gt;Cookie based Authentication&lt;/h3&gt;&lt;p&gt;The first step consists in retrieving the &lt;em&gt;cookie&lt;/em&gt; generated by the authentication request. To do so, a specific decoder to handle the response headers and store them as &lt;em&gt;cookes&lt;/em&gt; is used.&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="nf"&gt;getAuthToken&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;AuthenticationApi&lt;/span&gt; &lt;span class="n"&gt;authenticationApi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;builder&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;encoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;GsonEncoder&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;decoder&lt;/span&gt;&lt;span class="o"&gt;((&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;handleCookies&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;()))&lt;/span&gt; &lt;span class="c1"&gt;// decode cookies&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;target&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AuthenticationApi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;authenticationApi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;login&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;LoginPassword&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;The &lt;em&gt;cookie&lt;/em&gt; storage is managed by the &lt;a href="https://docs.oracle.com/javase/8/docs/api/index.html?overview-summary.html"&gt;CookieManager&lt;/a&gt; available since Java6.&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;CookieManager&lt;/span&gt; &lt;span class="n"&gt;COOKIE_MANAGER&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;CookieManager&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;The usage of this &lt;code class="highlighter-rouge"&gt;CookieManager&lt;/code&gt; is handled from the method &lt;code class="highlighter-rouge"&gt;handleCookies&lt;/code&gt; as follows:&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="nf"&gt;handleCookies&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Collection&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="c1"&gt;// From Map&amp;lt;String, Collection&amp;lt;String&amp;gt;&amp;gt; to Map&amp;lt;String, List&amp;lt;String&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;h&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;entrySet&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;collect&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt; &lt;span class="n"&gt;toMap&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt; &lt;span class="n"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Entry&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;getKey&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;entry&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;entry&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getValue&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;collect&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;toList&lt;/span&gt;&lt;span class="o"&gt;()))&lt;/span&gt; &lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;URI&lt;/span&gt; &lt;span class="n"&gt;uri&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;URI&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;create&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BASE_URL&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="n"&gt;image&lt;/span&gt; &lt;span class="n"&gt;COOKIE_MANAGER&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;put&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;uri&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;COOKIE_MANAGER&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getCookieStore&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;uri&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="c1"&gt;// Stream&amp;lt;HttpCookie&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;filter&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cookie&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="s"&gt;"token"&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;equals&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cookie&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getName&lt;/span&gt;&lt;span class="o"&gt;()))&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;findFirst&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="c1"&gt;// Optional&amp;lt;HttpCookie&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;map&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nl"&gt;HttpCookie:&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;getValue&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;orElseThrow&lt;/span&gt;&lt;span class="o"&gt;(()&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;IllegalStateException&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Authentication cookie not found"&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;catch&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;IOException&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;throw&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nf"&gt;RuntimeException&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt; &lt;p&gt;After being stored, this &lt;em&gt;cookie&lt;/em&gt; is automatically sent back in subsequent requests. This is achieved by using the &lt;code class="highlighter-rouge"&gt;RequestInterceptor&lt;/code&gt; mechanism that modifies the &lt;code class="highlighter-rouge"&gt;RequestTemplate&lt;/code&gt;. Feign uses this object to construct the &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; request.&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;MonkeyRaceApi&lt;/span&gt; &lt;span class="nf"&gt;buildRaceApi&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;getAuthToken&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;builder&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;requestInterceptor&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nl"&gt;ApiFactory:&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;addCookies&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;// Inject Cookies&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;decoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;GsonDecoder&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;encoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;GsonEncoder&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;target&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MonkeyRaceApi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;The interceptor behaves as a &lt;code class="highlighter-rouge"&gt;RequestTemplate&lt;/code&gt; consumer:&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;addCookies&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RequestTemplate&lt;/span&gt; &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;URI&lt;/span&gt; &lt;span class="n"&gt;uri&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;URI&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;create&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BASE_URL&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="n"&gt;COOKIE_MANAGER&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getCookieStore&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;uri&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;map&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nl"&gt;HttpCookie:&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;toString&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;forEach&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cookie&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;header&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Cookie"&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cookie&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;With Feign, the &lt;em&gt;cookie&lt;/em&gt; based authentication is closed to the &lt;code class="highlighter-rouge"&gt;Authorization&lt;/code&gt; header mechanism often associated to &lt;abbr title="Json WebToken"&gt;JWT&lt;/abbr&gt;. As it is based on &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; headers, the same implementation approach using a &lt;code class="highlighter-rouge"&gt;RequestInterceptor&lt;/code&gt; can be used to handle authentication via &lt;em&gt;token&lt;/em&gt;. On the other hand, using &lt;em&gt;cookies&lt;/em&gt; makes the code more complex and impacts its readability.&lt;/p&gt;&lt;blockquote&gt; &lt;p&gt;We cam also use &lt;code class="highlighter-rouge"&gt;feign.Target&lt;/code&gt; to manage the authentication, see &lt;a href="https://github.com/OpenFeign/feign#setting-headers-per-target"&gt;Feign documentation&lt;/a&gt;.&lt;/p&gt; &lt;/blockquote&gt;&lt;h3 id="errors-management-1"&gt;Errors management&lt;/h3&gt;&lt;p&gt;Feign proposes a specific errors management mechanism out of the box - if an &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; reposnse code &amp;gt;= 400. This is done using the &lt;code class="highlighter-rouge"&gt;ErrorDecoder&lt;/code&gt;:&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;MonkeyRaceApi&lt;/span&gt; &lt;span class="nf"&gt;buildRaceApi&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;getAuthToken&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;builder&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;errorDecoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nl"&gt;ApiFactory:&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;decodeError&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;// Decode errors&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;requestInterceptor&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nl"&gt;ApiFactory:&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;addCookies&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;// Inject Cookies&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;decoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;GsonDecoder&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;encoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;GsonEncoder&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;target&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MonkeyRaceApi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;Exception&lt;/span&gt; &lt;span class="nf"&gt;decodeError&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;methodKey&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Response&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nf"&gt;decodeError&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;status&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;methodKey&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;FeignException&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;errorStatus&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;methodKey&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;blockquote&gt; &lt;p&gt;Sometimes it can be useful to have a custom management of 404 errors. The &lt;code class="highlighter-rouge"&gt;Decoder&lt;/code&gt; method &lt;code class="highlighter-rouge"&gt;feign.Feign.Builder#decode404&lt;/code&gt; can be used to define the default baheviour.&lt;/p&gt; &lt;/blockquote&gt;&lt;h3 id="upload"&gt;Upload&lt;/h3&gt;&lt;p&gt;File &lt;em&gt;upload&lt;/em&gt; can be achieved in two different ways on the &lt;abbr title="REpresentational State Transfer"&gt;REST&lt;/abbr&gt; server:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;Upload using a &lt;a href="https://www.ietf.org/rfc/rfc2388.txt"&gt;formulaire multipart&lt;/a&gt; and a request header &lt;code class="highlighter-rouge"&gt;Content-type&lt;/code&gt; set to &lt;code class="highlighter-rouge"&gt;multipart/form-data&lt;/code&gt;.&lt;/li&gt; &lt;li&gt;Direct upload with the file content inside the request body and the request header &lt;code class="highlighter-rouge"&gt;Content-type&lt;/code&gt; set to &lt;code class="highlighter-rouge"&gt;application/octet-stream&lt;/code&gt;.&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;The two approaches can be implemented using the same principle: a specific &lt;code class="highlighter-rouge"&gt;Decoder&lt;/code&gt;. The second option is easier to set up as managing the &lt;em&gt;multipart&lt;/em&gt; request body requires the usage of an external &lt;abbr title="Application Programming Interface"&gt;API&lt;/abbr&gt; such as &lt;a href="https://commons.apache.org/proper/commons-fileupload/"&gt;Apache Commons FileUpload&lt;/a&gt; Other options are also available &lt;a href="https://github.com/xxlabaza/feign-form"&gt;https://github.com/xxlabaza/feign-form&lt;/a&gt; or &lt;a href="https://github.com/pcan/feign-client-test"&gt;https://github.com/pcan/feign-client-test&lt;/a&gt; to find implementation examples of the &lt;em&gt;multipart&lt;/em&gt; approach.&lt;/p&gt;&lt;p&gt;So the second solution is much simpler, the main idea is to handle the specific case of objects of type &lt;code class="highlighter-rouge"&gt;java.io.InputStream&lt;/code&gt; and to delegate other cases to a traditional &lt;abbr title="JavaScript Object Notation"&gt;JSON&lt;/abbr&gt; encoder. To define the &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; request body, the method &lt;code class="highlighter-rouge"&gt;feign.RequestTemplate#body(byte[], java.nio.charset.Charset)&lt;/code&gt; needs to be called. It is possible to write the encoder body inside a &lt;em&gt;lambda&lt;/em&gt; with Java 8, but it would be preferable to extract this implementation in a new class:&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;UploadEncoder&lt;/span&gt; &lt;span class="kd"&gt;implements&lt;/span&gt; &lt;span class="n"&gt;Encoder&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Encoder&lt;/span&gt; &lt;span class="n"&gt;delegate&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="nf"&gt;UploadEncoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Encoder&lt;/span&gt; &lt;span class="n"&gt;encoder&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="kd"&gt;super&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="n"&gt;delegate&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;encoder&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;encode&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt; &lt;span class="n"&gt;object&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Type&lt;/span&gt; &lt;span class="n"&gt;bodyType&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;RequestTemplate&lt;/span&gt; &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;EncodeException&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;InputStream&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;equals&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bodyType&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;header&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Content-type"&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"application/octet-stream"&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="n"&gt;InputStream&lt;/span&gt; &lt;span class="n"&gt;inputStream&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;InputStream&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;cast&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;object&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;// InputStream to byte[]&lt;/span&gt; &lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BufferedInputStream&lt;/span&gt; &lt;span class="n"&gt;bin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;BufferedInputStream&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;inputStream&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="n"&gt;ByteArrayOutputStream&lt;/span&gt; &lt;span class="n"&gt;bos&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;ByteArrayOutputStream&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="kt"&gt;byte&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;buffer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="kt"&gt;byte&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="o"&gt;];&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;bytesRead&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt;&lt;span class="n"&gt;bytesRead&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;bin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;read&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;bos&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;write&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;buffer&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bytesRead&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="n"&gt;bos&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;flush&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;body&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bos&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;toByteArray&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;StandardCharsets&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;UTF_8&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;catch&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;IOException&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;throw&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nf"&gt;EncodeException&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Cannot upload file"&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;delegate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;encode&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;object&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bodyType&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;blockquote&gt; &lt;p&gt;It is obviously possible to simplify this code by using a library to handle to conversion of &lt;code class="highlighter-rouge"&gt;InputStream&lt;/code&gt; into &lt;code class="highlighter-rouge"&gt;byte[]&lt;/code&gt;, but it does not hurt to write &lt;code class="highlighter-rouge"&gt;try with resources&lt;/code&gt; from time to time.&lt;/p&gt; &lt;/blockquote&gt;&lt;blockquote&gt; &lt;p&gt;It would be fair to say that this code may cause issues when working with large files. But in this scenario, we also need to ask the question: is a &lt;abbr title="REpresentational State Transfer"&gt;REST&lt;/abbr&gt; &lt;abbr title="Application Programming Interface"&gt;API&lt;/abbr&gt; the right solution to &lt;em&gt;upload&lt;/em&gt; large files?&lt;/p&gt; &lt;/blockquote&gt;&lt;h3 id="download"&gt;Download&lt;/h3&gt;&lt;p&gt;We use &lt;code class="highlighter-rouge"&gt;feign.Decoder&lt;/code&gt; to &lt;em&gt;download&lt;/em&gt; files the same way we did for the &lt;em&gt;upload&lt;/em&gt;:&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DownloadDecoder&lt;/span&gt; &lt;span class="kd"&gt;implements&lt;/span&gt; &lt;span class="n"&gt;Decoder&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Decoder&lt;/span&gt; &lt;span class="n"&gt;delegate&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="n"&gt;DownloadDecoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Decoder&lt;/span&gt; &lt;span class="n"&gt;decoder&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="kd"&gt;super&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="n"&gt;delegate&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;decoder&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Object&lt;/span&gt; &lt;span class="nf"&gt;decode&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Response&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Type&lt;/span&gt; &lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;IOException&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;DecodeException&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;FeignException&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;InputStream&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;equals&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;body&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;asInputStream&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;delegate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;decode&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Once again, Feign makes this operation quite simple as soon as the encoders/decoders are correctly used.&lt;/p&gt;&lt;h3 id="summary"&gt;Summary&lt;/h3&gt;&lt;p&gt;Feign makes the handle of &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; headers really simple, thus simplifying the authentication mechanisms using &lt;em&gt;cookies&lt;/em&gt; or &lt;em&gt;tokens&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;Errors management with Feign is also trivial which is one of the key benefits over the usage of Retrofit.&lt;/p&gt;&lt;p&gt;Encoding mechanism provides an easy way to handle file &lt;em&gt;upload&lt;/em&gt; and more generally to manage all the scenarios of requests serialising. The decoding mechanism allows retrieving the content of a file that is &lt;em&gt;downloaded&lt;/em&gt; and more generally deserialising &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; responses.&lt;/p&gt;&lt;p&gt;Feign comes with a lot of flexibility using the &lt;code class="highlighter-rouge"&gt;Encoder&lt;/code&gt;, &lt;code class="highlighter-rouge"&gt;Decoder&lt;/code&gt;, &lt;code class="highlighter-rouge"&gt;RequestInterceptor&lt;/code&gt;, ‚Ä¶ and we can easily solve common issues we face with &lt;abbr title="REpresentational State Transfer"&gt;REST&lt;/abbr&gt; APIs.&lt;/p&gt;&lt;h2 id="retrofit"&gt;Retrofit&lt;/h2&gt;&lt;h3 id="cookie-based-authentication-1"&gt;Cookie based Authentication&lt;/h3&gt;&lt;p&gt;The easiest way to manage authentication with Retrofit is to use the internal of the &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; client (&lt;code class="highlighter-rouge"&gt;okHttp3&lt;/code&gt;). Similarly to Feign we send an initial request to fetch the &lt;em&gt;cookie&lt;/em&gt; and then reuse the same client for all subsequent requests. Another option consists in using different clients for each requests but reusing the same &lt;code class="highlighter-rouge"&gt;cookieJar&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Here is a first basic implementation to understand the principle of a &lt;code class="highlighter-rouge"&gt;cookieJar&lt;/code&gt;:&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="n"&gt;client&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;OkHttpClient&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Builder&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;cookieJar&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nf"&gt;CookieJar&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;HashMap&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Cookie&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;cookieStore&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;HashMap&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;gt;();&lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;saveFromResponse&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HttpUrl&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Cookie&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;cookies&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;cookieStore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;put&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;uri&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;getAuthority&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;cookies&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Cookie&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;loadForRequest&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HttpUrl&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Cookie&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;cookies&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cookieStore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;uri&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;getAuthority&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;cookies&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt; &lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="n"&gt;cookies&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;ArrayList&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Cookie&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;();&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;});&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;A more elegant implementation consists in adding the dependency &lt;code class="highlighter-rouge"&gt;okhttp-urlconnection&lt;/code&gt; from &lt;code class="highlighter-rouge"&gt;OkHttp&lt;/code&gt;.&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="n"&gt;CookieHandler&lt;/span&gt; &lt;span class="n"&gt;cookieHandler&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;CookieManager&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nf"&gt;PersistentCookieStore&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="o"&gt;),&lt;/span&gt; &lt;span class="n"&gt;CookiePolicy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;ACCEPT_ALL&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="n"&gt;OkHttpClient&lt;/span&gt; &lt;span class="n"&gt;httpClient&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;OkHttpClient&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Builder&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;cookieJar&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;JavaNetCookieJar&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cookieHandler&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;h3 id="errors-management-2"&gt;Errors management&lt;/h3&gt;&lt;p&gt;There is no, from my point of view, any ideal solution with Retrofit to manage errors the way it is done with Feign. In this example, we use the functionality of the &lt;code class="highlighter-rouge"&gt;OkHttp&lt;/code&gt; interceptor. There is still a limitation, the exceptions returned must be of type &lt;code class="highlighter-rouge"&gt;RuntimeException&lt;/code&gt;.&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="n"&gt;OkHttpClient&lt;/span&gt; &lt;span class="n"&gt;client&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;OkHttpClient&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Builder&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addInterceptor&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;authInterceptor&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="n"&gt;Response&lt;/span&gt; &lt;span class="nf"&gt;authInterceptor&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Interceptor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Chain&lt;/span&gt; &lt;span class="n"&gt;chain&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;IOException&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;Request&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;chain&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;request&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="n"&gt;Response&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;chain&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;proceed&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(!&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;isSuccessful&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;RuntimeException&lt;/span&gt; &lt;span class="n"&gt;ex&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ApiFactory&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;decodeError&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;code&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;message&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ex&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;throw&lt;/span&gt; &lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;h3 id="upload-1"&gt;Upload&lt;/h3&gt;&lt;p&gt;To implement the &lt;em&gt;upload&lt;/em&gt;, we have decided to use the method &lt;a href="https://www.ietf.org/rfc/rfc2388.txt"&gt;multipart form&lt;/a&gt; with the header &lt;code class="highlighter-rouge"&gt;Content-type&lt;/code&gt; set to &lt;code class="highlighter-rouge"&gt;multipart/form-data&lt;/code&gt; Here is the implementation detail:&lt;/p&gt;&lt;p&gt;The method is added to the service&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;MonkeyService&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nd"&gt;@Multipart&lt;/span&gt; &lt;span class="nd"&gt;@POST&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"monkeys/{id}/photo"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;Call&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Photo&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;sendPhoto&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nd"&gt;@Path&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"id"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nd"&gt;@Part&lt;/span&gt; &lt;span class="n"&gt;MultipartBody&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Part&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;We create a temporary file containing the picture content, then we call the method &lt;code class="highlighter-rouge"&gt;sendPhoto&lt;/code&gt; giving it a &lt;code class="highlighter-rouge"&gt;RequestBody&lt;/code&gt; containing the temporary file to then create the &lt;code class="highlighter-rouge"&gt;MultipartBody&lt;/code&gt; passed down to the service.&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Photo&lt;/span&gt; &lt;span class="nf"&gt;savePhoto&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;InputStream&lt;/span&gt; &lt;span class="n"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;SecurityException&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;IllegalArgumentException&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nf"&gt;executeCall&lt;/span&gt;&lt;span class="o"&gt;(()&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;Path&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Files&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;createTempFile&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"exo2"&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"upload"&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Files&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;stream&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;REPLACE_EXISTING&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="n"&gt;RequestBody&lt;/span&gt; &lt;span class="n"&gt;requestFile&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;RequestBody&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;create&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MediaType&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;parse&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"multipart/form-data"&lt;/span&gt;&lt;span class="o"&gt;),&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;toFile&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt; &lt;span class="n"&gt;MultipartBody&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Part&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MultipartBody&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Part&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;createFormData&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"photo"&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;toFile&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;getName&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;requestFile&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;monkeyService&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;sendPhoto&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;catch&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;IOException&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;printStackTrace&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;});&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;h3 id="download-1"&gt;Download&lt;/h3&gt;&lt;p&gt;Regarding the &lt;em&gt;download&lt;/em&gt;, we only need to call our service by retrieving the reponse body. To do so, Retrofit proposes a &lt;em&gt;generic&lt;/em&gt; type &lt;code class="highlighter-rouge"&gt;ResponseBody&lt;/code&gt; to access the raw response.&lt;/p&gt;&lt;p&gt;We start by adding this method to our service:&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;MonkeyService&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="nd"&gt;@GET&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"monkeys/{id}/photo"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;Call&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;ResponseBody&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;downloadPhoto&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nd"&gt;@Path&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"id"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;SecurityException&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;IllegalArgumentException&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;then here is the code to fetch the picture:&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;InputStream&lt;/span&gt; &lt;span class="nf"&gt;downloadPhoto&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;throws&lt;/span&gt; &lt;span class="n"&gt;SecurityException&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;IllegalArgumentException&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;Response&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;ResponseBody&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;monkeyService&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;downloadPhoto&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;).&lt;/span&gt;&lt;span class="na"&gt;execute&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;body&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;byteStream&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;catch&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;IOException&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;h3 id="summary-1"&gt;Summary&lt;/h3&gt;&lt;p&gt;It is really simple with Retrofit to manage authentication via &lt;em&gt;cookies&lt;/em&gt; and &lt;em&gt;tokens&lt;/em&gt; as well as the files &lt;em&gt;upload&lt;/em&gt; and &lt;em&gt;download&lt;/em&gt;.&lt;/p&gt;&lt;p&gt;On the other side, errors management is far less intuitive. Maybe a better approach exists but we haven‚Äôt found it yet.&lt;/p&gt;&lt;h2 id="overall-summary"&gt;Overall Summary&lt;/h2&gt;&lt;p&gt;Whether we used Feign or Retrofit, the management of &lt;em&gt;cookies&lt;/em&gt; and files &lt;em&gt;upload&lt;/em&gt;/&lt;em&gt;download&lt;/em&gt; is easily implemented.&lt;/p&gt;&lt;p&gt;We also found that synchronous errors management is better managed with Feign than Retrofit.&lt;/p&gt;&lt;p&gt;Implementations using &lt;a href="http://square.github.io/okhttp/"&gt;OkHttp&lt;/a&gt; are common to Retrofit and Feign when the client &lt;a href="https://github.com/OpenFeign/feign/tree/master/okhttp"&gt;okhttp-client&lt;/a&gt; is used in Feign.&lt;/p&gt;</content> <author> <name>Emmanuel Vinas</name> <email>emmanuel@monkeypatch.io</email> </author> <author> <name>Igor Laborie</name> <email>igor@monkeypatch.io</email> </author> <author> <name>Bruno Chauvet</name> <email>bruno@monkeypatch.io</email> </author> <category term="MKTD"/> <category term="Java"/> <category term="REST"/> <category term="Feign"/> <category term="Retrofit"/> <category term="Cookie"/> <summary>This article is the second of the serie REST clients in Java.Previous article: MKTD#1 : Getting startedChallenge #2: Going further‚Ä¶The second challenge aims at solving advanced problems such as:Authentication and session management Errors management via Java Exception Files upload and download</summary> <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://www.monkeypatch.io/public/images/logos/logo-FeignVsRetrofit.png"/> </entry> <entry xml:lang="fr"><title>Mktd#1 Feign Vs Retrofit : 1 Prise En Main</title><link href="http://www.monkeypatch.io/2016/08/09/MKTD-1-feign-vs-retrofit-&-58;-1-prise-en-main.html" rel="alternate" type="text/html" title="Mktd#1 Feign Vs Retrofit &amp;#58; 1 Prise En Main"/> <published>2016-08-09T00:00:00+02:00</published> <updated>2016-08-09T00:00:00+02:00</updated><id>http://www.monkeypatch.io/2016/08/09/MKTD#1-feign-vs-retrofit-&amp;#58;-1-prise-en-main</id> <content type="html" xml:base="http://www.monkeypatch.io/2016/08/09/MKTD-1-feign-vs-retrofit-&amp;-58;-1-prise-en-main.html">&lt;h2 id="introduction"&gt;Introduction&lt;/h2&gt;&lt;p&gt;Nous avons organis√© √† Toulouse d√©but juillet, le premier &lt;a href="http://www.monkeytechdays.com/"&gt;MonkeyTechDays&lt;/a&gt; chez &lt;a href="http://www.harrycow.com/"&gt;HarryCow&lt;/a&gt; sur la th√©matique &lt;a href="http://www.monkeytechdays.com/events/mktd-1"&gt;Feign vs Retrofit&lt;/a&gt;. Un &lt;abbr title="MonkeyTechDays"&gt;MKTD&lt;/abbr&gt; consiste √† comparer, apprendre, sous forme de d√©fis, une ou plusieurs technologies sur une journ√©e.&lt;/p&gt;&lt;p&gt;Ce premier √©v√©nement √©tait l‚Äôoccasion d‚Äôapprofondir les technologies de clients &lt;abbr title="REpresentational State Transfer"&gt;REST&lt;/abbr&gt; en Java. Nous avons donc √©tudi√© &lt;a href="https://github.com/OpenFeign/feign"&gt;Feign&lt;/a&gt;, une librairie initi√©e par &lt;a href="https://netflix.github.io/"&gt;Netflix&lt;/a&gt; et &lt;a href="http://square.github.io/retrofit/"&gt;Retrofit&lt;/a&gt; qui est √©crite par &lt;a href="https://github.com/square"&gt;Square&lt;/a&gt;. Ces deux &lt;abbr title="Application Programming Interface"&gt;API&lt;/abbr&gt; permettent d‚Äô√©crire des clients &lt;abbr title="REpresentational State Transfer"&gt;REST&lt;/abbr&gt; en Java de fa√ßon plus √©l√©gante qu‚Äôavec les solutions plus classiques comme JAX-RS client, Spring Rest Template, ‚Ä¶ &lt;!--more--&gt;&lt;/p&gt;&lt;p&gt;Pour aider les √©quipes √† tester les technologies, nous avions au pr√©alable d√©ploy√© plusieurs services &lt;abbr title="REpresentational State Transfer"&gt;REST&lt;/abbr&gt; sur le th√®me des singes. Le code source de cette journ√©e est disponible √† l‚Äôadresse : &lt;a href="https://github.com/monkeytechdays"&gt;https://github.com/monkeytechdays&lt;/a&gt;&lt;/p&gt;&lt;h2 id="d√©fi-0--constitution-des-√©quipes"&gt;D√©fi 0 : Constitution des √©quipes&lt;/h2&gt;&lt;p&gt;Ce d√©fi n‚Äôavait rien de technique, mais nous permet de constituer des √©quipes √©quitables pour chaque technologie, en finissant nos caf√©s, croissants, ‚Ä¶ L‚Äô√©quipe Feign √©tant dirig√©e par &lt;a href="https://twitter.com/ilaborie"&gt;Igor&lt;/a&gt; et l‚Äô√©quipe Retrofit par &lt;a href="https://twitter.com/EmmanuelVinas"&gt;Emmanuel&lt;/a&gt;.&lt;/p&gt;&lt;h2 id="d√©fi-1-prise-en-main"&gt;D√©fi 1: Prise en main&lt;/h2&gt;&lt;p&gt;Ce premier d√©fi consiste √† une mise en bouche pour d√©couvrir ces technologies.&lt;/p&gt;&lt;p&gt;Le principe d‚Äôutilisation de &lt;a href="https://github.com/OpenFeign/feign"&gt;Feign&lt;/a&gt; et &lt;a href="http://square.github.io/retrofit/"&gt;Retrofit&lt;/a&gt; consiste √† cr√©er une interface d√©crivant le service &lt;abbr title="REpresentational State Transfer"&gt;REST&lt;/abbr&gt;, puis l‚Äô&lt;abbr title="Application Programming Interface"&gt;API&lt;/abbr&gt; se charge de cr√©er une instance de cette interface. Dans ce premier d√©fi, il suffisait de compl√©ter les interfaces correpondant aux services &lt;abbr title="REpresentational State Transfer"&gt;REST&lt;/abbr&gt; pour faire passer des tests unitaires.&lt;/p&gt;&lt;p&gt;Voici les deux interfaces retournant du &lt;abbr title="JavaScript Object Notation"&gt;JSON&lt;/abbr&gt; :&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;MonkeyApi&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;Page&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Monkey&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;getMonkeys&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Monkey&lt;/span&gt; &lt;span class="nf"&gt;getMonkeyByName&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="n"&gt;Monkey&lt;/span&gt; &lt;span class="nf"&gt;createMonkey&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Monkey&lt;/span&gt; &lt;span class="n"&gt;monkey&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;deleteMonkey&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;MonkeyRaceApi&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;MonkeyRace&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;getMonkeyRaces&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;et celle dont le service retourne du &lt;abbr title="eXtensible Markup Language"&gt;XML&lt;/abbr&gt; :&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;MonkeyStatsApi&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;MonkeyStatistics&lt;/span&gt; &lt;span class="nf"&gt;getMonkeyStats&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Voir le code sous &lt;a href="https://github.com/monkeytechdays/mktd1-defi1"&gt;GitHub&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Pour r√©ussir ce d√©fi, il faut donc faire:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;un GET et d√©coder le &lt;abbr title="JavaScript Object Notation"&gt;JSON&lt;/abbr&gt; de la r√©ponse,&lt;/li&gt; &lt;li&gt;un GET avec un param√®tre de requ√™te,&lt;/li&gt; &lt;li&gt;un GET avec un param√®tre dans le &lt;em&gt;path&lt;/em&gt; de la requ√™te,&lt;/li&gt; &lt;li&gt;un POST avec un encodage en &lt;abbr title="JavaScript Object Notation"&gt;JSON&lt;/abbr&gt; du corps de la requ√™te,&lt;/li&gt; &lt;li&gt;un DELETE,&lt;/li&gt; &lt;li&gt;un GET et d√©coder le &lt;abbr title="eXtensible Markup Language"&gt;XML&lt;/abbr&gt; de la r√©ponse.&lt;/li&gt; &lt;/ul&gt;&lt;h2 id="feign"&gt;Feign&lt;/h2&gt;&lt;p&gt;La documentation de Feign se trouve dans le &lt;a href="https://github.com/OpenFeign/feign"&gt;README.md&lt;/a&gt; sous GitHub. La documentation des extensions se trouve aussi dans des fichiers README.md de ces extensions.&lt;/p&gt;&lt;blockquote&gt; &lt;p&gt;Bien que Feign supporte Java 6 par d√©faut, nous avons cod√© avec Java 8.&lt;/p&gt; &lt;/blockquote&gt;&lt;h3 id="d√©pendances"&gt;D√©pendances&lt;/h3&gt;&lt;p&gt;Pour commencer √† utiliser Feign, il faut bien s√ªr ajouter les d√©pendances n√©cessaires pour ce d√©fi:&lt;/p&gt;&lt;div class="language-xml highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="c"&gt;&amp;lt;!-- Feign --&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;com.netflix.feign&lt;span class="nt"&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;feign-core&lt;span class="nt"&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;version&amp;gt;&lt;/span&gt;8.17.0&lt;span class="nt"&gt;&amp;lt;/version&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt; &lt;span class="c"&gt;&amp;lt;!-- Feign: encode/decode JSON with GSON --&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;com.netflix.feign&lt;span class="nt"&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;feign-gson&lt;span class="nt"&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;version&amp;gt;&lt;/span&gt;8.17.0&lt;span class="nt"&gt;&amp;lt;/version&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt; &lt;span class="c"&gt;&amp;lt;!-- Feign: encode/decode XML with JAXB --&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;com.netflix.feign&lt;span class="nt"&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;feign-jaxb&lt;span class="nt"&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;version&amp;gt;&lt;/span&gt;8.17.0&lt;span class="nt"&gt;&amp;lt;/version&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;blockquote&gt; &lt;p&gt;Nous recommandons bien s√ªr l‚Äôutilisation d‚Äôune propri√©t√© maven pour d√©finir la version de Feign utilis√©e.&lt;/p&gt; &lt;/blockquote&gt;&lt;h3 id="configuration-des-interfaces"&gt;Configuration des interfaces&lt;/h3&gt;&lt;p&gt;Ensuite il faut annoter les interfaces pour que Feign fasse les requ√™tes &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; correspondantes aux m√©thodes de ces interfaces. Feign apporte ses propres annotations pour d√©crire les requ√™tes &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt;:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;&lt;code class="highlighter-rouge"&gt;@RequestLine&lt;/code&gt;: permet de d√©finir la premi√®re ligne de la requ√™te &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt;: le verbe &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; (GET, POST, PUT, DELETE, ‚Ä¶) et le chemin, on y pr√©cise aussi les param√®tres de la requ√™te. On peut utiliser la notation &lt;code class="highlighter-rouge"&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="err"&gt;name&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;/code&gt; pour d√©finir une partie variable de la requ√™te (param√®tre ou chemin)&lt;/li&gt; &lt;li&gt;&lt;code class="highlighter-rouge"&gt;@Param&lt;/code&gt;: cette annotation permet de faire le lien entre une variable d√©finie dans les autres annotations (&lt;code class="highlighter-rouge"&gt;@RequestLine&lt;/code&gt;, &lt;code class="highlighter-rouge"&gt;@Headers&lt;/code&gt;, ‚Ä¶) et le param√®tre de la m√©thode. Il faut pr√©ciser le nom de la variable dans l‚Äôannotation.&lt;/li&gt; &lt;li&gt;&lt;code class="highlighter-rouge"&gt;@Headers&lt;/code&gt;: permet d‚Äôajouter une en-t√™te &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt;, comme pour &lt;code class="highlighter-rouge"&gt;@RequestLine&lt;/code&gt; on peut utiliser la notation &lt;code class="highlighter-rouge"&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="err"&gt;name&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;/code&gt; pour d√©finir une valeur variable dans l‚Äôen-t√™te &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt;. Cette annotation, peut √™tre mise sur l‚Äôinterface, ou sur une m√©thode de cette interface. Pas d‚Äôannotation pour le corps d‚Äôune requ√™te POST ou PUT, le param√®tre sans annotation sera converti dans le corps de la requ√™te.&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;Ce qui nous donne ceci :&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;MonkeyRaceApi&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="nd"&gt;@RequestLine&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"GET /races"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;MonkeyRace&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;getMonkeyRaces&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="nd"&gt;@Headers&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Content-Type: application/json"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;MonkeyApi&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="nd"&gt;@RequestLine&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"GET ?page={page}"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;Page&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Monkey&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;getMonkeys&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nd"&gt;@Param&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"page"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="nd"&gt;@RequestLine&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"GET /{name}"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;Monkey&lt;/span&gt; &lt;span class="nf"&gt;getMonkeyByName&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nd"&gt;@Param&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"name"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="nd"&gt;@RequestLine&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"POST "&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;Monkey&lt;/span&gt; &lt;span class="nf"&gt;createMonkey&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Monkey&lt;/span&gt; &lt;span class="n"&gt;monkey&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="nd"&gt;@RequestLine&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"DELETE /{id}"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;deleteMonkey&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nd"&gt;@Param&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"id"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;MonkeyStatsApi&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="nd"&gt;@RequestLine&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"GET /stats"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;MonkeyStatistics&lt;/span&gt; &lt;span class="nf"&gt;getMonkeyStats&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;h3 id="construction-des-instances"&gt;Construction des instances&lt;/h3&gt;&lt;p&gt;Pour la derni√®re √©tape, on utilise l‚Äô&lt;abbr title="Application Programming Interface"&gt;API&lt;/abbr&gt; &lt;em&gt;fluent builder&lt;/em&gt; de Feign pour cr√©er l‚Äôinstance de ces interfaces. C‚Äôest ici que l‚Äôon va faire intervenir les encodeurs/d√©codeurs ajout√©s dans nos d√©pendances Maven plus t√¥t :&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;MonkeyRaceApi&lt;/span&gt; &lt;span class="nf"&gt;buildRaceApi&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Feign&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;builder&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="c1"&gt;// Decode JSON from respone body&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;decoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;GsonDecoder&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;target&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MonkeyRaceApi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;MonkeyApi&lt;/span&gt; &lt;span class="nf"&gt;buildMonkeyApi&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Feign&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;builder&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="c1"&gt;// Decode JSON from respone body&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;decoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;GsonDecoder&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="c1"&gt;// Encode JSON for request body&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;encoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;GsonEncoder&lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;target&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MonkeyApi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s"&gt;"/monkeys"&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="n"&gt;MonkeyStatsApi&lt;/span&gt; &lt;span class="nf"&gt;buildStatsApi&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="c1"&gt;// Create JAXB context factory&lt;/span&gt; &lt;span class="n"&gt;JAXBContextFactory&lt;/span&gt; &lt;span class="n"&gt;jaxbFactory&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;JAXBContextFactory&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Builder&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;withMarshallerJAXBEncoding&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"UTF-8"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;build&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Feign&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;builder&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="c1"&gt;// Decode XML from response body&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;decoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;JAXBDecoder&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jaxbFactory&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;target&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MonkeyStatsApi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;blockquote&gt; &lt;p&gt;Feign va concat√©ner l‚Äô&lt;abbr title="Uniform Resource Locator"&gt;URL&lt;/abbr&gt; avec le chemin d√©fini, dans le chemin de l‚Äôannotation &lt;code class="highlighter-rouge"&gt;@RequestLine&lt;/code&gt;, ceci permet facilement de rajouter un pr√©fixe pour les services si on le souhaite.&lt;/p&gt; &lt;/blockquote&gt;&lt;h3 id="bilan"&gt;Bilan&lt;/h3&gt;&lt;p&gt;Peu de points n√©gatifs pour Feign dans cet exercice:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;pour faire fonctionner le d√©codage &lt;abbr title="eXtensible Markup Language"&gt;XML&lt;/abbr&gt; il a fallu triturer un peu l‚Äôobjet pour que &lt;a href="https://docs.oracle.com/javase/tutorial/jaxb/intro/"&gt;JAXB&lt;/a&gt; &lt;em&gt;deserialize&lt;/em&gt; correctement le &lt;abbr title="eXtensible Markup Language"&gt;XML&lt;/abbr&gt;. Mais c‚Äôest plus un probl√®me li√© √† JAXB et au &lt;abbr title="eXtensible Markup Language"&gt;XML&lt;/abbr&gt; de fa√ßon plus g√©n√©rale,&lt;/li&gt; &lt;li&gt;les messages d‚Äôerreurs ne sont parfois pas simples √† d√©crypter, mais avec un peu de pratique et une connaissance basique du protocole &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt;, √ßa n‚Äôest pas vraiment un probl√®me. Un probl√®me classique est le fait d‚Äôoublier le verbe &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt; dans l‚Äôannotation &lt;code class="highlighter-rouge"&gt;@RequestLine&lt;/code&gt;.&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;Beaucoup de c√¥t√©s positifs ici:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;simple et proche du &lt;abbr title="HyperText Transfer Protocol"&gt;HTTP&lt;/abbr&gt;,&lt;/li&gt; &lt;li&gt;tr√®s l√©ger, il n‚Äôy a pas de d√©pendances transitives pour le &lt;code class="highlighter-rouge"&gt;feign-core&lt;/code&gt;,&lt;/li&gt; &lt;li&gt;facilement extensible: par exemple, il est facile de changer d‚Äôencodeur/d√©codeur &lt;a href="https://github.com/OpenFeign/feign/tree/master/gson"&gt;GSON&lt;/a&gt;, &lt;a href="https://github.com/OpenFeign/feign/tree/master/jackson"&gt;Jackson&lt;/a&gt;, &lt;a href="https://github.com/OpenFeign/feign/tree/master/jaxb"&gt;JAXB&lt;/a&gt;, ‚Ä¶,&lt;/li&gt; &lt;li&gt;il y a un bon support de Java 8, par exemple, les m√©thodes &lt;code class="highlighter-rouge"&gt;static&lt;/code&gt; et &lt;code class="highlighter-rouge"&gt;default&lt;/code&gt; des interfaces de Java 8 sont support√©es.&lt;/li&gt; &lt;/ul&gt;&lt;p&gt;Quelques remarques:&lt;/p&gt;&lt;ul&gt; &lt;li&gt;il y a d‚Äôautres annotations &lt;code class="highlighter-rouge"&gt;@Body&lt;/code&gt;, &lt;code class="highlighter-rouge"&gt;@HeaderMap&lt;/code&gt;, &lt;code class="highlighter-rouge"&gt;@QueryMap&lt;/code&gt; qui existent,&lt;/li&gt; &lt;li&gt;on peut configurer la fa√ßon dont les variables (&lt;code class="highlighter-rouge"&gt;@Param&lt;/code&gt;) sont converties en String via les &lt;code class="highlighter-rouge"&gt;Expander&lt;/code&gt;.&lt;/li&gt; &lt;li&gt;pour d√©finir un chemin racine √† toutes nos m√©thodes dans l‚Äôinterface, on peut l‚Äôajouter dans l‚Äô&lt;abbr title="Uniform Resource Locator"&gt;URL&lt;/abbr&gt; utilis√©e par le &lt;em&gt;builder&lt;/em&gt;.&lt;/li&gt; &lt;/ul&gt;&lt;blockquote&gt; &lt;p&gt;Il n‚Äôy a pas de magie dans Feign : il n‚Äôutilise que ce qui existe d√©j√† dans le &lt;abbr title="Java Developement Kit"&gt;JDK&lt;/abbr&gt; : &lt;code class="highlighter-rouge"&gt;java.net.HttpURLConnection&lt;/code&gt;, &lt;code class="highlighter-rouge"&gt;java.lang.reflect.Proxy&lt;/code&gt;, &lt;code class="highlighter-rouge"&gt;java.lang.reflect.InvocationHandler&lt;/code&gt;, ‚Ä¶&lt;/p&gt; &lt;/blockquote&gt;&lt;h2 id="retrofit"&gt;Retrofit&lt;/h2&gt;&lt;p&gt;La premi√®re √©tape consiste √† rajouter les d√©pendances de R√©trofit&lt;/p&gt;&lt;div class="language-xml highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="cp"&gt;&amp;lt;! -- D√©pendance de r√©trofit --&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;com.squareup.retrofit2&lt;span class="nt"&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;retrofit&lt;span class="nt"&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${retrofit.version}&lt;span class="nt"&gt;&amp;lt;/version&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt; &lt;span class="cp"&gt;&amp;lt;! -- Converter Jackson pour g√©rer le Json --&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;com.squareup.retrofit2&lt;span class="nt"&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;converter-jackson&lt;span class="nt"&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${retrofit.version}&lt;span class="nt"&gt;&amp;lt;/version&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt; &lt;span class="c"&gt;&amp;lt;!-- Converter Simple Xml pour g√©rer le xml --&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;com.squareup.retrofit2&lt;span class="nt"&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;converter-simplexml&lt;span class="nt"&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${retrofit.version}&lt;span class="nt"&gt;&amp;lt;/version&amp;gt;&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Ensuite, il nous faut rajouter les annotations sp√©cifiques √† Retrofit sur l‚Äôinterface. Les r√®gles du jeu √©tant de ne pas changer la signature de l‚Äôinterface, nous avons d√ª ajouter une autre interface utilis√©e par la &lt;code class="highlighter-rouge"&gt;CallFactory&lt;/code&gt; par d√©faut de Retrofit.&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;MonkeyRaceService&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="nd"&gt;@GET&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"races"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;Call&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;MonkeyRace&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;getMonkeyRaces&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;MonkeyService&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="nd"&gt;@GET&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"monkeys"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;Call&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Page&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Monkey&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;getMonkeys&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt;&lt;span class="nd"&gt;@GET&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"monkeys/{name}"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;Call&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Monkey&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;getMonkeyByName&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nd"&gt;@Path&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"name"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="nd"&gt;@POST&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"monkeys"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;Call&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Monkey&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;create&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nd"&gt;@Body&lt;/span&gt; &lt;span class="n"&gt;Monkey&lt;/span&gt; &lt;span class="n"&gt;monkey&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;&lt;span class="nd"&gt;@DELETE&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"monkeys/{id}"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;Call&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;ResponseBody&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;delete&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nd"&gt;@Path&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"id"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;monkeyId&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;MonkeyStatsService&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="nd"&gt;@GET&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"/stats"&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="n"&gt;Call&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;MonkeyStatistics&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;getMonkeyStats&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Ensuite, nous impl√©mentons les interfaces &lt;code class="highlighter-rouge"&gt;MonkeyApi&lt;/code&gt;, &lt;code class="highlighter-rouge"&gt;MonkeyRaceApi&lt;/code&gt;, &lt;code class="highlighter-rouge"&gt;MonkeyStatsApi&lt;/code&gt; en utilisant les interfaces sp√©cifiques pour Retrofit.&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;RetrofitMonkeyApi&lt;/span&gt; &lt;span class="kd"&gt;implements&lt;/span&gt; &lt;span class="n"&gt;MonkeyApi&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;RetrofitApi&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="n"&gt;MonkeyService&lt;/span&gt; &lt;span class="n"&gt;monkeyService&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;setBaseUrl&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;baseUrl&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;monkeyService&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;createRetrofit&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;baseUrl&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;create&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MonkeyService&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Page&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Monkey&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;getMonkeys&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nf"&gt;executeCall&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nl"&gt;monkeyService:&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;getMonkeys&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Monkey&lt;/span&gt; &lt;span class="nf"&gt;getMonkeyByName&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nf"&gt;executeCall&lt;/span&gt;&lt;span class="o"&gt;(()&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;monkeyService&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getMonkeyByName&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Monkey&lt;/span&gt; &lt;span class="nf"&gt;createMonkey&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Monkey&lt;/span&gt; &lt;span class="n"&gt;monkey&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nf"&gt;executeCall&lt;/span&gt;&lt;span class="o"&gt;(()&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;monkeyService&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;create&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;monkey&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;deleteMonkey&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;executeCall&lt;/span&gt;&lt;span class="o"&gt;(()&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;monkeyService&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;delete&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;interface&lt;/span&gt; &lt;span class="nc"&gt;RetrofitApi&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="n"&gt;Retrofit&lt;/span&gt; &lt;span class="nf"&gt;createRetrofit&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;baseUrl&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;boolean&lt;/span&gt; &lt;span class="n"&gt;useXml&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;Retrofit&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Builder&lt;/span&gt; &lt;span class="n"&gt;builder&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;Retrofit&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Builder&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;baseUrl&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;baseUrl&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;useXml&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;builder&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addConverterFactory&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SimpleXmlConverterFactory&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;create&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="n"&gt;builder&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;addConverterFactory&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;JacksonConverterFactory&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;create&lt;/span&gt;&lt;span class="o"&gt;());&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;builder&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;build&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt; &lt;span class="nf"&gt;executeCall&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Supplier&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Call&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;supplier&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;Call&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;call&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;supplier&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;call&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;execute&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;body&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;catch&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;IOException&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;h3 id="bilan-1"&gt;Bilan&lt;/h3&gt;&lt;h4 id="points-n√©gatifs"&gt;Points n√©gatifs&lt;/h4&gt;&lt;p&gt;Nous trouvons dommage qu‚Äôil n‚Äôy ait pas nativement une &lt;code class="highlighter-rouge"&gt;CallFactory&lt;/code&gt; permettant de faire de fa√ßon synchrone un appel retournant notre objet m√©tier sans avoir besoin de passer par l‚Äôobjet &lt;code class="highlighter-rouge"&gt;Call&lt;/code&gt; √† la mani√®re dont cela est g√©r√© avec Feign.&lt;/p&gt;&lt;p&gt;Il est aussi possible de faire notre propre &lt;code class="highlighter-rouge"&gt;CallAdapterFactory&lt;/code&gt;. Voici un exemple tir√© du code source des tests de Retrofit :&lt;/p&gt;&lt;div class="language-java highlighter-rouge"&gt;&lt;div class="highlight"&gt;&lt;table style="border-spacing: 0"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class="gutter gl" style="text-align: right"&gt;&lt;pre class="lineno"&gt;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DirectCallIOException&lt;/span&gt; &lt;span class="kd"&gt;extends&lt;/span&gt; &lt;span class="n"&gt;RuntimeException&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="n"&gt;DirectCallIOException&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;IOException&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="kd"&gt;super&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="kd"&gt;static&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DirectCallAdapterFactory&lt;/span&gt; &lt;span class="kd"&gt;extends&lt;/span&gt; &lt;span class="n"&gt;CallAdapter&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Factory&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="nd"&gt;@Override&lt;/span&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;CallAdapter&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;final&lt;/span&gt; &lt;span class="n"&gt;Type&lt;/span&gt; &lt;span class="n"&gt;returnType&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Annotation&lt;/span&gt;&lt;span class="o"&gt;[]&lt;/span&gt; &lt;span class="n"&gt;annotations&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Retrofit&lt;/span&gt; &lt;span class="n"&gt;retrofit&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;CallAdapter&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Object&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="nd"&gt;@Override&lt;/span&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Type&lt;/span&gt; &lt;span class="nf"&gt;responseType&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;returnType&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="nd"&gt;@Override&lt;/span&gt; &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Object&lt;/span&gt; &lt;span class="nf"&gt;adapt&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Call&lt;/span&gt; &lt;span class="n"&gt;call&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;call&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;execute&lt;/span&gt;&lt;span class="o"&gt;().&lt;/span&gt;&lt;span class="na"&gt;body&lt;/span&gt;&lt;span class="o"&gt;();&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="k"&gt;catch&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;IOException&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt; &lt;span class="k"&gt;throw&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nf"&gt;DirectCallIOException&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;getMessage&lt;/span&gt;&lt;span class="o"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;};&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;span class="o"&gt;}&lt;/span&gt; &lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt; &lt;/div&gt; &lt;/div&gt;&lt;p&gt;Cela nous obligerait quand m√™me √† traiter les exceptions de type &lt;code class="highlighter-rouge"&gt;DirectCallIOException&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Autre point que nous trouvons dommage lors de cet exercice est le fait que nous devons catcher les &lt;code class="highlighter-rouge"&gt;IOException&lt;/code&gt; qui peuvent se produire lors de l‚Äôappel. Peut √™tre manque-t-il a Retrofit une gestion des exceptions comme Feign peut l‚Äôavoir. Nous verrons cela plus en d√©tail dans l‚Äôexercice suivant.&lt;/p&gt;&lt;p&gt;Dernier point ‚Äòn√©gatif‚Äô, Retrofit ayant besoin de plusieurs d√©pendances pour fonctionner : &lt;a href="http://square.github.io/okhttp/"&gt;OkHttp&lt;/a&gt; et d‚Äôau moins 1 &lt;em&gt;converter&lt;/em&gt;, la taille de l‚Äôex√©cutable g√©n√©r√© est sensiblement plus grosse que celle de l‚Äôex√©cutable de Feign (1.5Mo contre 0.5Mo).&lt;/p&gt;&lt;h4 id="points-positifs"&gt;Points Positifs&lt;/h4&gt;&lt;p&gt;Retrofit reste simple √† utiliser. Le fait que les principaux &lt;em&gt;converters&lt;/em&gt; soient disponibles est une tr√®s bonne chose.&lt;/p&gt;&lt;p&gt;Retrofit a ses propres annotations, √©vitant ainsi les erreurs de &lt;em&gt;typo&lt;/em&gt;, ce qui est une tr√®s bonne chose. Bien que Feign se soit am√©lior√©e sur les messages d‚Äôerreurs, nous trouvons pr√©f√©rable le choix fait par l‚Äô√©quipe de Retrofit sur cette partie.&lt;/p&gt;</content> <author> <name>Emmanuel Vinas</name> <email>emmanuel@monkeypatch.io</email> </author> <author> <name>Igor Laborie</name> <email>igor@monkeypatch.io</email> </author> <category term="MKTD"/> <category term="Java"/> <category term="REST"/> <category term="Feign"/> <category term="Retrofit"/> <summary>IntroductionNous avons organis√© √† Toulouse d√©but juillet, le premier MonkeyTechDays chez HarryCow sur la th√©matique Feign vs Retrofit. Un MKTD consiste √† comparer, apprendre, sous forme de d√©fis, une ou plusieurs technologies sur une journ√©e.Ce premier √©v√©nement √©tait l‚Äôoccasion d‚Äôapprofondir les technologies de clients REST en Java. Nous avons donc √©tudi√© Feign, une librairie initi√©e par Netflix et Retrofit qui est √©crite par Square. Ces deux API permettent d‚Äô√©crire des clients REST en Java de fa√ßon plus √©l√©gante qu‚Äôavec les solutions plus classiques comme JAX-RS client, Spring Rest Template, ‚Ä¶</summary> <media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://www.monkeypatch.io/public/images/logos/logo-FeignVsRetrofit.png"/> </entry> </feed>